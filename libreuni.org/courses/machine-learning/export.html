<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Machine Learning - Full Course Export</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"><link rel="stylesheet" href="../../assets/_courseId_.Fs3g2vL1.css">
<link rel="stylesheet" href="../../assets/katex_min.CThiMMFw.css">
<link rel="stylesheet" href="../../assets/export.De4IRHfa.css"><script type="module">const t=document.getElementById("print-btn");t&&t.addEventListener("click",()=>{const e=document.createElement("div");e.innerHTML='<div class="fixed inset-0 z-[200] flex items-center justify-center bg-black/50 backdrop-blur-sm no-print"><div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md text-center"><h3 class="text-xl font-bold mb-4">Print optimization</h3><p class="mb-6 text-slate-600">For a clean PDF, please ensure <b>"Headers and Footers"</b> is UNCHECKED in your browser print settings.</p><button id="close-note" class="bg-primary text-white font-bold px-6 py-2 rounded-lg">OK, SAVE AS PDF</button></div></div>',document.body.appendChild(e),document.getElementById("close-note")?.addEventListener("click",()=>{e.remove(),window.focus(),window.print()})});
</script></head> <body> <!-- Floating UI Controls --> <div id="controls" class="fixed top-6 right-6 z-[100] flex gap-4 no-print"> <div class="bg-white/90 backdrop-blur-xl p-2 rounded-2xl shadow-2xl border border-slate-200 flex gap-2"> <a href="../../courses/machine-learning.html" class="px-5 py-3 text-sm font-black text-slate-600 hover:text-slate-900 transition-all flex items-center gap-2 hover:bg-slate-50 rounded-xl"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
BACK
</a> <button id="print-btn" class="bg-primary hover:bg-primary-dark text-white font-black px-10 py-3 rounded-xl shadow-lg shadow-primary/20 hover:scale-105 active:scale-95 transition-all text-sm uppercase tracking-widest flex items-center gap-2"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-4"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
SAVE AS PDF
</button> </div> </div> <!-- The Export Content --> <div class="max-w-[210mm] mx-auto my-12 shadow-2xl transition-all" id="export-root"> <div id="pdf-content" class="bg-white p-[25mm]"> <!-- Cover Page --> <div class="h-[247mm] flex flex-col justify-center items-center text-center page-break-after"> <div class="w-32 h-32 bg-primary/5 text-primary rounded-[3rem] flex items-center justify-center mb-16 shadow-inner"> <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open "><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg> </div> <h1 class="text-7xl font-black uppercase tracking-tighter mb-8 text-slate-900 leading-[0.9]">Machine Learning</h1> <p class="text-2xl text-slate-400 max-w-2xl mx-auto mb-20 font-medium leading-relaxed tracking-tight italic">A mathematical and algorithmic journey through the systems that learn from data, from linear models to deep neural architectures.</p> <div class="h-3 w-40 bg-primary rounded-full mb-20 shadow-lg shadow-primary/20"></div> <div class="mt-auto pt-20"> <div class="inline-block px-6 py-2 bg-slate-100 rounded-full font-black text-slate-400 uppercase tracking-[0.3em] text-[10px] mb-4">Official Documentation</div> <p class="text-slate-900 font-extrabold text-lg">February 2026</p> </div> </div> <!-- Table of Contents --> <div class="min-h-[247mm] page-break-after py-12"> <h2 class="text-5xl font-black uppercase mb-16 tracking-tighter text-slate-900 border-b-8 border-slate-900 pb-6">Contents</h2> <div class="space-y-12"> <div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Basics</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Foundations of Machine Learning</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Linear Regression: The Foundation of Continuous Prediction</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Logistic Regression: Binary Classification and Probability</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Regularization Theory: Combating Overfitting</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Algorithms</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Support Vector Machines: Maximum Margin Classifiers</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Decision Trees: Recursive Partitioning of Feature Space</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Ensemble Learning: Theory and Implementation</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Gradient Boosting Machines: XGBoost and Advanced Systems</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Unsupervised</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Principal Component Analysis: Dimensionality Reduction</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Clustering: Discovering Latent Groups</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Deep Learning</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Neural Networks: The Perceptron and Beyond</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Convolutional Neural Networks: Vision and Pattern Recognition</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Applications</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Numerical Optimization: Navigating the Loss Landscape</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Model Evaluation: Statistical Reliability</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Feature Engineering: The Art of Representation</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Algorithms</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Naive Bayes: Probabilistic Inference</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div><div> <h3 class="font-black text-primary uppercase tracking-[0.25em] text-xs mb-6 bg-blue-50 inline-block px-4 py-1 rounded-md">Applications</h3> <ul class="space-y-6"> <li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Recommender Systems: Latent Factor Models</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Reinforcement Learning: Optimal Decision Making</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">NLP: Foundations and Vector Representations</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li><li class="flex items-baseline gap-4 group"> <span class="font-bold text-slate-800 text-xl tracking-tight">Ethics in Machine Learning: Bias and Fairness</span> <div class="flex-1 border-b-2 border-dotted border-slate-100"></div> </li> </ul> </div> </div> </div> <!-- Content --> <div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Basics</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Foundations of Machine Learning</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="foundations-of-machine-learning">Foundations of Machine Learning</h1>
<p>Machine learning represents a fundamental shift in how we approach computational problem-solving. In traditional programming, a developer encodes explicit rules to transform inputs into outputs. In contrast, machine learning is the field of study that gives computers the ability to learn without being explicitly programmed. It is the process of approximating a target function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span></span> using a historical dataset <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span></span></span></span>.</p>
<h2 id="the-formal-definition-of-learning">The Formal Definition of Learning</h2>
<p>Tom Mitchell’s classic definition provides a rigorous framework: “A computer program is said to learn from experience <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span> with respect to some class of tasks <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span> and performance measure <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span>, if its performance at tasks in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span>, as measured by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span>, improves with experience <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span>.”</p>
<p>Consider a spam filter:</p>
<ul>
<li><strong>Task (T)</strong>: Classifying emails as spam or ham.</li>
<li><strong>Experience (E)</strong>: Watching you label emails as spam or ham.</li>
<li><strong>Performance (P)</strong>: The fraction of emails correctly classified.</li>
</ul>
<h2 id="why-machine-learning">Why Machine Learning?</h2>
<p>In the era of Big Data, human-designed rules often fail. A human cannot write enough <code>if-else</code> statements to recognize a face in a pixel-grid or to translate language with all its nuances. Machine learning allows us to:</p>
<ol>
<li><strong>Handle complexity</strong>: High-dimensional data where patterns are not obvious.</li>
<li><strong>Adaptivity</strong>: Systems that update as new data arrives.</li>
<li><strong>Personalization</strong>: Recommender systems that learn individual preferences.</li>
</ol>
<h2 id="taxonomy-of-machine-learning">Taxonomy of Machine Learning</h2>
<p>Machine learning algorithms are generally categorized based on the nature of the “experience” or feedback they receive during training.</p>
<div class="my-12 flex flex-col items-center bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-[2.5rem] overflow-hidden shadow-xl p-8 transition-colors"> <div class="w-full flex justify-center overflow-x-auto dark:invert dark:hue-rotate-180 dark:brightness-110"> <?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="MINDMAP" height="584px" preserveAspectRatio="none" style="width:647px;height:584px;background:#FFFFFF;" version="1.1" viewBox="0 0 647 584" width="647px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="144.3252" x="10" y="273.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.3252" x="20" y="296.3311">Machine Learning</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="163.7051" x="204.3252" y="48.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143.7051" x="214.3252" y="71.1436">Supervised Learning</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="191.958" x="418.0303" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171.958" x="428.0303" y="42.9951">Regression (Continuous)</text><path d="M368.0303,66.2969 L378.0303,66.2969 C393.0303,66.2969 393.0303,38.1484 408.0303,38.1484 L418.0303,38.1484" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="186.1406" x="418.0303" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166.1406" x="428.0303" y="99.292">Classification (Discrete)</text><path d="M368.0303,66.2969 L378.0303,66.2969 C393.0303,66.2969 393.0303,94.4453 408.0303,94.4453 L418.0303,94.4453" fill="none" style="stroke:#181818;stroke-width:1;"/><path d="M154.3252,291.4844 L164.3252,291.4844 C179.3252,291.4844 179.3252,66.2969 194.3252,66.2969 L204.3252,66.2969" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="181.2324" x="204.3252" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161.2324" x="214.3252" y="211.8857">Unsupervised Learning</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="91.3398" x="435.5576" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.3398" x="445.5576" y="155.5889">Clustering</text><path d="M385.5576,207.0391 L395.5576,207.0391 C410.5576,207.0391 410.5576,150.7422 425.5576,150.7422 L435.5576,150.7422" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="199.6143" x="435.5576" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="179.6143" x="445.5576" y="211.8857">Dimensionality Reduction</text><path d="M385.5576,207.0391 L395.5576,207.0391 C410.5576,207.0391 410.5576,207.0391 425.5576,207.0391 L435.5576,207.0391" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="142.5615" x="435.5576" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.5615" x="445.5576" y="268.1826">Association Rules</text><path d="M385.5576,207.0391 L395.5576,207.0391 C410.5576,207.0391 410.5576,263.3359 425.5576,263.3359 L435.5576,263.3359" fill="none" style="stroke:#181818;stroke-width:1;"/><path d="M154.3252,291.4844 L164.3252,291.4844 C179.3252,291.4844 179.3252,207.0391 194.3252,207.0391 L204.3252,207.0391" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="188.998" x="204.3252" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168.998" x="214.3252" y="380.7764">Reinforcement Learning</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="154.7773" x="443.3232" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.7773" x="453.3232" y="324.4795">Policy Optimization</text><path d="M393.3232,375.9297 L403.3232,375.9297 C418.3232,375.9297 418.3232,319.6328 433.3232,319.6328 L443.3232,319.6328" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="138.5352" x="443.3232" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.5352" x="453.3232" y="380.7764">Value Estimation</text><path d="M393.3232,375.9297 L403.3232,375.9297 C418.3232,375.9297 418.3232,375.9297 433.3232,375.9297 L443.3232,375.9297" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="175.0664" x="443.3232" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.0664" x="453.3232" y="437.0732">Model-based Learning</text><path d="M393.3232,375.9297 L403.3232,375.9297 C418.3232,375.9297 418.3232,432.2266 433.3232,432.2266 L443.3232,432.2266" fill="none" style="stroke:#181818;stroke-width:1;"/><path d="M154.3252,291.4844 L164.3252,291.4844 C179.3252,291.4844 179.3252,375.9297 194.3252,375.9297 L204.3252,375.9297" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="203.7842" x="204.3252" y="498.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183.7842" x="214.3252" y="521.5186">Semi-Supervised Learning</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="146.7314" x="458.1094" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.7314" x="468.1094" y="493.3701">Label Propagation</text><path d="M408.1094,516.6719 L418.1094,516.6719 C433.1094,516.6719 433.1094,488.5234 448.1094,488.5234 L458.1094,488.5234" fill="none" style="stroke:#181818;stroke-width:1;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="108.6689" x="458.1094" y="526.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.6689" x="468.1094" y="549.667">Self-Training</text><path d="M408.1094,516.6719 L418.1094,516.6719 C433.1094,516.6719 433.1094,544.8203 448.1094,544.8203 L458.1094,544.8203" fill="none" style="stroke:#181818;stroke-width:1;"/><path d="M154.3252,291.4844 L164.3252,291.4844 C179.3252,291.4844 179.3252,516.6719 194.3252,516.6719 L204.3252,516.6719" fill="none" style="stroke:#181818;stroke-width:1;"/><?plantuml-src TP1DJyCm38Rl_HK-GgLEK2JEGnstJKmhS7TJjxEKE5MS88rVJni-1aWxvdsSnzQxreWXEfRUuLIKi4DpP27O4WPX6OkoX3PD5DvOgVyTbt2WCP0gUu6hnajaIJxfTMQDnPaCR31clc4rWI8j55v4BoWRcpHI-7vks94i2z1oFCqB-sGMNuOFgjxmf_-GB6cHRs8PV30qVun_tNjlsPpWQOhi-1r_FAze4y6Zpl4vtFcURDNXlmkX9SVLfKAss965VV0JZcTLItQedWDodblJNFLNtSNjghwfxrTrHn7lFW00?></g></svg> </div> </div>
<h3 id="1-supervised-learning">1. Supervised Learning</h3>
<p>The model is provided with a “teacher” in the form of labeled data. Each training instance <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> consists of an input vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> and a corresponding output <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>.</p>
<ul>
<li><strong>Regression</strong>: The target <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> is a continuous numerical value (e.g., predicting house prices, stock values).</li>
<li><strong>Classification</strong>: The target <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> is a discrete category or class (e.g., identifying whether an image is a cat or a dog).</li>
</ul>
<h3 id="2-unsupervised-learning">2. Unsupervised Learning</h3>
<p>The data has no labels. The model must discover hidden structures or patterns on its own.</p>
<ul>
<li><strong>Clustering</strong>: Grouping similar data points together (e.g., customer segmentation).</li>
<li><strong>Dimensionality Reduction</strong>: Compressing data while preserving essential information (e.g., PCA for visualization).</li>
<li><strong>Anomaly Detection</strong>: Identifying data points that deviate significantly from the norm.</li>
</ul>
<h3 id="3-reinforcement-learning-rl">3. Reinforcement Learning (RL)</h3>
<p>RL is about sequential decision-making. An <strong>agent</strong> interacts with an <strong>environment</strong>, performing <strong>actions</strong> and receiving <strong>rewards</strong> or penalties. The goal is to learn a <strong>policy</strong>—a mapping from states to actions—that maximizes long-term cumulative reward.</p>
<h3 id="4-semi-supervised-learning">4. Semi-Supervised Learning</h3>
<p>Semi-supervised learning sits between supervised and unsupervised learning. It uses a small amount of labeled data combined with a large amount of unlabeled data.</p>
<ul>
<li><strong>The Concept</strong>: Manually labeling data is expensive and time-consuming. Semi-supervised learning leverages the structure found in unlabeled data to improve the model’s accuracy on the small labeled set.</li>
<li><strong>Example</strong>: A photo app that knows a few people you’ve tagged (labeled) and can then cluster millions of other photos (unlabeled) to suggest tags for those same people across his entire library.</li>
</ul>
<h2 id="the-mathematical-framework-erm">The Mathematical Framework: ERM</h2>
<p>Mathematically, learning is an optimization problem. We define a <strong>Hypothesis Space</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.00965em">H</span></span></span></span>, consisting of all possible functions our model can take. We search for a function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.00965em">H</span></span></span></span> that minimizes a <strong>Loss Function</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>.</p>
<p>The <strong>Empirical Risk Minimization (ERM)</strong> principle suggests that the best hypothesis is the one that minimizes the average loss over the training data:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9579em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">h</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.00965em">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></p>
<h2 id="practical-implementation-with-python">Practical Implementation with Python</h2>
<p>Let’s use Python to visualize how data looks and how we can split it for training and testing. We’ll use the popular <code>scikit-learn</code> and <code>matplotlib</code> libraries (conceptual representation).</p>
<style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="1EaCFb" prefix="r1" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\n\n# Generate synthetic data\nnp.random.seed(42)\nX = 2 * np.random.rand(100, 1)\ny = 4 + 3 * X + np.random.randn(100, 1)\n\n# Split data: 80% for training, 20% for testing\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\nprint(f\&quot;Training set size: {len(X_train)}\&quot;)\nprint(f\&quot;Test set size: {len(X_test)}\&quot;)\n\n# Visualization\nplt.scatter(X, y, color=&#39;blue&#39;, alpha=0.5)\nplt.title(\&quot;Synthetic Linear Data\&quot;)\nplt.xlabel(\&quot;X (Feature)\&quot;)\nplt.ylabel(\&quot;y (Target)\&quot;)\nprint(\&quot;Data visualization complete.\&quot;)&quot;],&quot;output&quot;:[0,&quot;Training set size: 80\nTest set size: 20\nData visualization complete.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split

# Generate synthetic data
np.random.seed(42)
X = 2 * np.random.rand(100, 1)
y = 4 + 3 * X + np.random.randn(100, 1)

# Split data: 80% for training, 20% for testing
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

print(f&quot;Training set size: {len(X_train)}&quot;)
print(f&quot;Test set size: {len(X_test)}&quot;)

# Visualization
plt.scatter(X, y, color=&#x27;blue&#x27;, alpha=0.5)
plt.title(&quot;Synthetic Linear Data&quot;)
plt.xlabel(&quot;X (Feature)&quot;)
plt.ylabel(&quot;y (Target)&quot;)
print(&quot;Data visualization complete.&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.model_selection <span class="hl-keyword">import</span> train_test_split</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Generate synthetic data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X <span class="hl-operator">=</span> <span class="hl-number">2</span> <span class="hl-operator">*</span> np.random.rand<span class="hl-bracket">(</span><span class="hl-number">100</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">y <span class="hl-operator">=</span> <span class="hl-number">4</span> <span class="hl-operator">+</span> <span class="hl-number">3</span> <span class="hl-operator">*</span> X <span class="hl-operator">+</span> np.random.randn<span class="hl-bracket">(</span><span class="hl-number">100</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-comment"># Split data: 80% for training, 20% for testing</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">X_train, X_test, y_train, y_test <span class="hl-operator">=</span> train_test_split<span class="hl-bracket">(</span>X, y, test_size<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">2</span>, random_state<span class="hl-operator">=</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Training set size: {len(X_train)}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Test set size: {len(X_test)}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-comment"># Visualization</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">plt.scatter<span class="hl-bracket">(</span>X, y, color<span class="hl-operator">=</span><span class="hl-string">&#039;blue&#039;</span>, alpha<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Synthetic Linear Data&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">plt.xlabel<span class="hl-bracket">(</span><span class="hl-string">&quot;X (Feature)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">plt.ylabel<span class="hl-bracket">(</span><span class="hl-string">&quot;y (Target)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Data visualization complete.&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="the-crucial-trade-off-bias-vs-variance">The Crucial Trade-off: Bias vs. Variance</h2>
<p>The biggest challenge in ML is <strong>Generalization</strong>. We don’t want a model that just “memorizes” training data; we want one that predicts well on new data. This brings us to the Bias-Variance decomposition:</p>
<ol>
<li><strong>Bias (Underfitting)</strong>: Errors due to overly simplistic assumptions. If your data is a curve but you use a straight line, you have high bias.</li>
<li><strong>Variance (Overfitting)</strong>: Errors due to excessive sensitivity to small fluctuations in the training set. If your model follows every tiny wiggle of the noise, you have high variance.</li>
</ol>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Total Error</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9707em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord text"><span class="mord">Bias</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em"><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord">Variance</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Irreducible Noise</span></span></span></span></span></p>
<astro-island uid="Z25MikH" prefix="r2" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;If a model has 99% accuracy on the training set but only 60% accuracy on the test set, what is likely happening?&quot;],&quot;options&quot;:[1,[[0,&quot;The model is underfitting (High Bias).&quot;],[0,&quot;The model is overfitting (High Variance).&quot;],[0,&quot;The data is too simple.&quot;],[0,&quot;The learning rate is too low.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;High performance on training data but poor performance on unseen data is the classic signature of overfitting. The model has learned the patterns specific to the training set including its noise.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">If a model has 99% accuracy on the training set but only 60% accuracy on the test set, what is likely happening?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model is underfitting (High Bias).</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model is overfitting (High Variance).</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The data is too simple.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The learning rate is too low.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="feature-engineering-and-data-preparation">Feature Engineering and Data Preparation</h2>
<p>Before feeding data into an algorithm, we must prepare it. This includes:</p>
<ul>
<li><strong>Cleaning</strong>: Handling missing values and outliers.</li>
<li><strong>Scaling</strong>: Normalizing or standardizing features so they are on the same scale (crucial for algorithms like SVM or KNN).</li>
<li><strong>Encoding</strong>: Converting categorical data (like “Color”) into numerical format (like One-Hot Encoding).</li>
</ul>
<astro-island uid="Z1yDtAp" prefix="r3" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.preprocessing import StandardScaler\n\ndata = np.array([[1.0, 200], [2.0, 300], [3.0, 150]])\nscaler = StandardScaler()\nscaled_data = scaler.fit_transform(data)\n\nprint(\&quot;Original data:\&quot;)\nprint(data)\nprint(\&quot;\&quot;)\nprint(\&quot;Scaled data (Mean=0, Std=1):\&quot;)\nprint(scaled_data)&quot;],&quot;output&quot;:[0,&quot;Original data:\n[[  1. 200.]\n[  2. 300.]\n[  3. 150.]] Scaled data (Mean=0, Std=1):\n[[-1.22474487 -0.26726124]\n[ 0.          1.33630621]\n[ 1.22474487 -1.06904497]]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.preprocessing import StandardScaler

data = np.array([[1.0, 200], [2.0, 300], [3.0, 150]])
scaler = StandardScaler()
scaled_data = scaler.fit_transform(data)

print(&quot;Original data:&quot;)
print(data)
print(&quot;&quot;)
print(&quot;Scaled data (Mean=0, Std=1):&quot;)
print(scaled_data)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.preprocessing <span class="hl-keyword">import</span> StandardScaler</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">data <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">1</span>.<span class="hl-number">0</span>, <span class="hl-number">200</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">2</span>.<span class="hl-number">0</span>, <span class="hl-number">300</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">3</span>.<span class="hl-number">0</span>, <span class="hl-number">150</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">scaler <span class="hl-operator">=</span> StandardScaler<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">scaled_data <span class="hl-operator">=</span> scaler.fit_transform<span class="hl-bracket">(</span>data<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Original data:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>data<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Scaled data (Mean=0, Std=1):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>scaled_data<span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="evaluation-metrics">Evaluation Metrics</h2>
<p>How do we know if our model is good? It depends on the task:</p>
<ul>
<li><strong>Regression</strong>: Mean Squared Error (MSE), R-squared.</li>
<li><strong>Classification</strong>: Accuracy, Precision, Recall, F1-Score, AUC-ROC.</li>
</ul>
<p>Precision answers: “Of all items predicted positive, how many were actually positive?”
Recall answers: “Of all actually positive items, how many did we find?”</p>
<h2 id="the-lifecycle-of-a-machine-learning-project">The Lifecycle of a Machine Learning Project</h2>
<ol>
<li><strong>Data Collection</strong>: Gathering raw data from databases, APIs, or sensors.</li>
<li><strong>Exploratory Data Analysis (EDA)</strong>: Visualizing distributions and correlations.</li>
<li><strong>Data Preprocessing</strong>: Cleaning, scaling, and feature selection.</li>
<li><strong>Model Selection</strong>: Choosing an appropriate algorithm for the task.</li>
<li><strong>Training</strong>: Let the model learn from the data.</li>
<li><strong>Hyperparameter Tuning</strong>: Optimizing settings (like learning rate) that aren’t learned during training.</li>
<li><strong>Evaluation</strong>: Testing the model on a hold-out dataset.</li>
<li><strong>Deployment</strong>: Monitoring the model in production and retraining as necessary.</li>
</ol>
<astro-island uid="ZvlINB" prefix="r4" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is it important to use a separate test set that the model never sees during training?&quot;],&quot;options&quot;:[1,[[0,&quot;To make training faster.&quot;],[0,&quot;To avoid using too much memory.&quot;],[0,&quot;To get an unbiased estimate of the model&#39;s performance on new, unseen data.&quot;],[0,&quot;Because the model might crash if it sees the same data twice.&quot;]]],&quot;answerIndex&quot;:[0,2],&quot;explanation&quot;:[0,&quot;Evaluation on the training data is deceptive because of overfitting. A separate test set is the only way to measure how well the model generalizes to the real world.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is it important to use a separate test set that the model never sees during training?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To make training faster.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To avoid using too much memory.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To get an unbiased estimate of the model&#x27;s performance on new, unseen data.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because the model might crash if it sees the same data twice.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="conclusion">Conclusion</h2>
<p>Machine learning is not magic; it is a blend of statistics, optimization, and software engineering. By understanding the core concepts of hypothesis spaces, loss functions, and the bias-variance trade-off, you lay the groundwork for mastering complex architectures like Deep Neural Networks.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Linear Regression: The Foundation of Continuous Prediction</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="linear-regression">Linear Regression</h1>
<p>Linear regression is a supervised learning algorithm used to model the relationship between a dependent variable <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> and one or more independent variables <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>. At its core, the model assumes that the relationship is approximately linear. Despite its simplicity, it remains one of the most powerful and widely used tools in a data scientist’s arsenal.</p>
<h2 id="the-model-representation">The Model Representation</h2>
<p>The hypothesis function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> is defined as:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></p>
<p>Here:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> is the predicted output.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is the <strong>intercept</strong> (or bias term).</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> are the <strong>weights</strong> (parameters) for each feature.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> are the input features.</li>
</ul>
<h3 id="vectorization-the-power-of-linear-algebra">Vectorization: The Power of Linear Algebra</h3>
<p>In practice, we don’t handle these variables individually. Using vector notation, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span></span></span></span>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span></p>
<p>Vectorization isn’t just a notation convenience; it’s computationally essential. Modern hardware (CPUs/GPUs) can perform matrix-vector multiplication much faster than iterative loops (FOR loops) thanks to Parallel Processing and SIMD (Single Instruction, Multiple Data).</p>
<astro-island uid="2uO57k" prefix="r5" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport time\n\n# Vectorized vs Non-Vectorized Comparison\nn = 1000000\na = np.random.rand(n)\nb = np.random.rand(n)\n\n# Non-vectorized\nstart = time.time()\nc_loop = 0\nfor i in range(n):\n  c_loop += a[i] * b[i]\nend = time.time()\nprint(f\&quot;Loop time: {1000 * (end - start):.2f}ms\&quot;)\n\n# Vectorized\nstart = time.time()\nc_vec = np.dot(a, b)\nend = time.time()\nprint(f\&quot;Vectorized time: {1000 * (end - start):.2f}ms\&quot;)&quot;],&quot;output&quot;:[0,&quot;Loop time: ~100-200ms\nVectorized time: ~1ms&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import time

# Vectorized vs Non-Vectorized Comparison
n = 1000000
a = np.random.rand(n)
b = np.random.rand(n)

# Non-vectorized
start = time.time()
c_loop = 0
for i in range(n):
  c_loop += a[i] * b[i]
end = time.time()
print(f&quot;Loop time: {1000 * (end - start):.2f}ms&quot;)

# Vectorized
start = time.time()
c_vec = np.dot(a, b)
end = time.time()
print(f&quot;Vectorized time: {1000 * (end - start):.2f}ms&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> time</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># Vectorized vs Non-Vectorized Comparison</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">n <span class="hl-operator">=</span> <span class="hl-number">1000000</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">a <span class="hl-operator">=</span> np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">b <span class="hl-operator">=</span> np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># Non-vectorized</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">start <span class="hl-operator">=</span> time.time<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">c_loop <span class="hl-operator">=</span> <span class="hl-number">0</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-keyword">for</span> i <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>n<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">  c_loop <span class="hl-operator">+</span><span class="hl-operator">=</span> a<span class="hl-bracket">[</span>i<span class="hl-bracket">]</span> <span class="hl-operator">*</span> b<span class="hl-bracket">[</span>i<span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">end <span class="hl-operator">=</span> time.time<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Loop time: {1000 * (end - start):.2f}ms&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre"><span class="hl-comment"># Vectorized</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">start <span class="hl-operator">=</span> time.time<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">c_vec <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>a, b<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">end <span class="hl-operator">=</span> time.time<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Vectorized time: {1000 * (end - start):.2f}ms&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="the-cost-function-ordinary-least-squares-ols">The Cost Function: Ordinary Least Squares (OLS)</h2>
<p>To find the optimal parameters <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span>, we need to measure how well our model fits the data. The most common metric is the <strong>Mean Squared Error (MSE)</strong>, also known as the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mord">2</span></span></span></span> loss. The cost function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> is defined as:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="why-squared-error">Why “Squared” Error?</h3>
<ol>
<li><strong>Differentiability</strong>: The squared function is smooth and differentiable everywhere, making it ideal for gradient-based optimization.</li>
<li><strong>Sensitivity</strong>: Squaring the error penalizes larger deviations more heavily than absolute error (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mord">∣</span></span></span></span>).</li>
<li><strong>Statistical Foundation</strong>: Under the assumption that errors are normally distributed, OLS is the Maximum Likelihood Estimator.</li>
</ol>
<h2 id="optimization-gradient-descent">Optimization: Gradient Descent</h2>
<p>Gradient descent is an iterative optimization algorithm used to minimize <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span>. Imagine standing on a hill in a thick fog; you can find the bottom by feeling the slope of the ground and walking in the direction that goes down.</p>
<p>The update rule for each parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4224em;vertical-align:-0.5423em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span></p>
<p>Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span> is the <strong>Learning Rate</strong>. Calculating the partial derivative gives:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span></span></span></p>
<h3 id="the-learning-rate-α">The Learning Rate (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>)</h3>
<ul>
<li><strong>Too Small</strong>: Convergence will be extremely slow.</li>
<li><strong>Too Large</strong>: The algorithm can overshoot the minimum, potentially diverging or oscillating.</li>
</ul>
<astro-island uid="ZyqQm8" prefix="r6" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;What happens if the cost function J(theta) is at a local minimum?&quot;],&quot;options&quot;:[1,[[0,&quot;Gradient descent will stop because the gradient is zero.&quot;],[0,&quot;The parameters will increase exponentially.&quot;],[0,&quot;The learning rate will automatically double.&quot;],[0,&quot;It will jump to a global minimum.&quot;]]],&quot;answerIndex&quot;:[0,0],&quot;explanation&quot;:[0,&quot;At a minimum (local or global), the slope (derivative) is zero. Since the update rule subtracts &#39;alpha * gradient&#39;, and the gradient is 0, the parameters stop changing.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">What happens if the cost function J(theta) is at a local minimum?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Gradient descent will stop because the gradient is zero.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The parameters will increase exponentially.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The learning rate will automatically double.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It will jump to a global minimum.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="implementation-from-scratch-with-numpy">Implementation from Scratch with NumPy</h2>
<p>Let’s implement a simple Linear Regression class that uses Gradient Descent.</p>
<astro-island uid="2k3VlW" prefix="r7" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\nclass SimpleLinearRegression:\n  def __init__(self, lr=0.01, n_iters=1000):\n      self.lr = lr\n      self.n_iters = n_iters\n      self.weights = None\n      self.bias = None\n\n  def fit(self, X, y):\n      n_samples, n_features = X.shape\n      self.weights = np.zeros(n_features)\n      self.bias = 0\n\n      for _ in range(self.n_iters):\n          model_prediction = np.dot(X, self.weights) + self.bias\n          # Compute gradients\n          dw = (1 / n_samples) * np.dot(X.T, (model_prediction - y))\n          db = (1 / n_samples) * np.sum(model_prediction - y)\n\n          # Update parameters\n          self.weights -= self.lr * dw\n          self.bias -= self.lr * db\n\n  def predict(self, X):\n      return np.dot(X, self.weights) + self.bias\n\n# Test the implementation\nX = np.array([[1], [2], [3], [4]])\ny = np.array([2, 4, 6, 8])\n\nmodel = SimpleLinearRegression()\nmodel.fit(X, y)\nprint(f\&quot;Predicted weight: {model.weights[0]:.2f}\&quot;)\nprint(f\&quot;Predicted bias: {model.bias:.2f}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Predicted weight: 2.00\nPredicted bias: 0.00&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

class SimpleLinearRegression:
  def __init__(self, lr=0.01, n_iters=1000):
      self.lr = lr
      self.n_iters = n_iters
      self.weights = None
      self.bias = None

  def fit(self, X, y):
      n_samples, n_features = X.shape
      self.weights = np.zeros(n_features)
      self.bias = 0

      for _ in range(self.n_iters):
          model_prediction = np.dot(X, self.weights) + self.bias
          # Compute gradients
          dw = (1 / n_samples) * np.dot(X.T, (model_prediction - y))
          db = (1 / n_samples) * np.sum(model_prediction - y)

          # Update parameters
          self.weights -= self.lr * dw
          self.bias -= self.lr * db

  def predict(self, X):
      return np.dot(X, self.weights) + self.bias

# Test the implementation
X = np.array([[1], [2], [3], [4]])
y = np.array([2, 4, 6, 8])

model = SimpleLinearRegression()
model.fit(X, y)
print(f&quot;Predicted weight: {model.weights[0]:.2f}&quot;)
print(f&quot;Predicted bias: {model.bias:.2f}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">class</span> SimpleLinearRegression:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> __init__<span class="hl-bracket">(</span>self, lr<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">01</span>, n_iters<span class="hl-operator">=</span><span class="hl-number">1000</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">      self.lr <span class="hl-operator">=</span> lr</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">      self.n_iters <span class="hl-operator">=</span> n_iters</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">      self.weights <span class="hl-operator">=</span> <span class="hl-keyword">None</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">      self.bias <span class="hl-operator">=</span> <span class="hl-keyword">None</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> fit<span class="hl-bracket">(</span>self, X, y<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">      n_samples, n_features <span class="hl-operator">=</span> X.shape</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">      self.weights <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span>n_features<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">      self.bias <span class="hl-operator">=</span> <span class="hl-number">0</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> _ <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>self.n_iters<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">          model_prediction <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>X, self.weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> self.bias</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">          <span class="hl-comment"># Compute gradients</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">          dw <span class="hl-operator">=</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">/</span> n_samples<span class="hl-bracket">)</span> <span class="hl-operator">*</span> np.dot<span class="hl-bracket">(</span>X.T, <span class="hl-bracket">(</span>model_prediction <span class="hl-flag">-</span> y<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">          db <span class="hl-operator">=</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">/</span> n_samples<span class="hl-bracket">)</span> <span class="hl-operator">*</span> np.<span class="hl-function">sum</span><span class="hl-bracket">(</span>model_prediction <span class="hl-flag">-</span> y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">          <span class="hl-comment"># Update parameters</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">          self.weights <span class="hl-flag">-</span><span class="hl-operator">=</span> self.lr <span class="hl-operator">*</span> dw</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">          self.bias <span class="hl-flag">-</span><span class="hl-operator">=</span> self.lr <span class="hl-operator">*</span> db</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> predict<span class="hl-bracket">(</span>self, X<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">      <span class="hl-keyword">return</span> np.dot<span class="hl-bracket">(</span>X, self.weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> self.bias</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre"><span class="hl-comment"># Test the implementation</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">2</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">3</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">4</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">2</span>, <span class="hl-number">4</span>, <span class="hl-number">6</span>, <span class="hl-number">8</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">model <span class="hl-operator">=</span> SimpleLinearRegression<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre">model.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Predicted weight: {model.weights[0]:.2f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Predicted bias: {model.bias:.2f}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="advanced-case-the-normal-equation">Advanced Case: The Normal Equation</h2>
<p>For some linear regression problems, we can solve for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> analytically. This is done by setting the derivative of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> with respect to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> equal to zero. The resulting formula is the <strong>Normal Equation</strong>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></p>






























<table><thead><tr><th style="text-align:left">Method</th><th style="text-align:left">Gradient Descent</th><th style="text-align:left">Normal Equation</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Learning Rate</strong></td><td style="text-align:left">Need to choose <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></td><td style="text-align:left">No need</td></tr><tr><td style="text-align:left"><strong>Iterations</strong></td><td style="text-align:left">Many iterations</td><td style="text-align:left">One-step solution</td></tr><tr><td style="text-align:left"><strong>Complexity</strong></td><td style="text-align:left"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:left"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> (matrix inversion)</td></tr><tr><td style="text-align:left"><strong>Scalability</strong></td><td style="text-align:left">Works well for large <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></td><td style="text-align:left">Slow if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> is large</td></tr></tbody></table>
<h2 id="evaluating-regression-models">Evaluating Regression Models</h2>
<p>Accuracy isn’t the right metric for regression because our predictions are continuous values. Instead, we use:</p>
<ol>
<li><strong>Mean Squared Error (MSE)</strong>: Average of squared residuals. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</li>
<li><strong>Root Mean Squared Error (RMSE)</strong>: Square root of MSE. It brings the error unit back to the scale of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span>.</li>
<li><strong>Mean Absolute Error (MAE)</strong>: Average of absolute residuals. More robust to outliers than MSE.</li>
<li><strong>R-Squared (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)</strong>: The “Coefficient of Determination”. It measures the proportion of variance in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> explained by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>. Values range from 0 to 1.</li>
</ol>
<astro-island uid="1PhYRN" prefix="r8" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.metrics import mean_squared_error, r2_score\n\ny_true = np.array([3, -0.5, 2, 7])\ny_pred = np.array([2.5, 0.0, 2, 8])\n\nmse = mean_squared_error(y_true, y_pred)\nr2 = r2_score(y_true, y_pred)\n\nprint(f\&quot;MSE: {mse:.4f}\&quot;)\nprint(f\&quot;R-squared: {r2:.4f}\&quot;)&quot;],&quot;output&quot;:[0,&quot;MSE: 0.3750\nR-squared: 0.9486&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.metrics import mean_squared_error, r2_score

y_true = np.array([3, -0.5, 2, 7])
y_pred = np.array([2.5, 0.0, 2, 8])

mse = mean_squared_error(y_true, y_pred)
r2 = r2_score(y_true, y_pred)

print(f&quot;MSE: {mse:.4f}&quot;)
print(f&quot;R-squared: {r2:.4f}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.metrics <span class="hl-keyword">import</span> mean_squared_error, r2_score</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">y_true <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">3</span>, <span class="hl-flag">-0</span>.<span class="hl-number">5</span>, <span class="hl-number">2</span>, <span class="hl-number">7</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">y_pred <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">2</span>.<span class="hl-number">5</span>, <span class="hl-number">0</span>.<span class="hl-number">0</span>, <span class="hl-number">2</span>, <span class="hl-number">8</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">mse <span class="hl-operator">=</span> mean_squared_error<span class="hl-bracket">(</span>y_true, y_pred<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">r2 <span class="hl-operator">=</span> r2_score<span class="hl-bracket">(</span>y_true, y_pred<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;MSE: {mse:.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;R-squared: {r2:.4f}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="assumptions-of-linear-regression">Assumptions of Linear Regression</h2>
<p>Linear regression is a parametric model, meaning it makes assumptions about the data:</p>
<ol>
<li><strong>Linearity</strong>: The relationship between <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> must be linear.</li>
<li><strong>Independence</strong>: Observations should be independent of each other (no autocorrelation in time-series data).</li>
<li><strong>Homoscedasticity</strong>: The variance of the error terms (residuals) should be constant across all levels of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span>.</li>
<li><strong>Normality of Residuals</strong>: For hypothesis testing (p-values), the errors should be normally distributed.</li>
</ol>
<p>If these assumptions are violated, your model’s predictions and interpretability might suffer. In such cases, one might look toward <strong>Polynomial Regression</strong> or <strong>Generalized Linear Models (GLM)</strong>.</p>
<astro-island uid="ZxtNwm" prefix="r9" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Which metric is MOST sensitive to outliers?&quot;],&quot;options&quot;:[1,[[0,&quot;Mean Absolute Error (MAE)&quot;],[0,&quot;Mean Squared Error (MSE)&quot;],[0,&quot;R-squared&quot;],[0,&quot;They are all equally sensitive.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;Because MSE squares the difference between the actual and predicted values, large errors (outliers) contribute disproportionately to the final value compared to MAE.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Which metric is MOST sensitive to outliers?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Mean Absolute Error (MAE)</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Mean Squared Error (MSE)</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">R-squared</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">They are all equally sensitive.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="conclusion">Conclusion</h2>
<p>Linear regression is more than just drawing a line through points. It’s an introduction to the core themes of machine learning: loss optimization, parameter estimation, and evaluation metrics. Mastering it prepares you for more complex models like Logistic Regression and Neural Networks.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Logistic Regression: Binary Classification and Probability</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="logistic-regression">Logistic Regression</h1>
<p>Despite its name, <strong>Logistic Regression</strong> is a classification algorithm. It is arguably the most important foundational algorithm in classification, used to predict the probability that a given input <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> belongs to a specific category (e.g., “Yes” or “No”, “Spam” or “Not Spam”). Instead of predicting a continuous value, it predicts a probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>.</p>
<h2 id="why-not-linear-regression-for-classification">Why not Linear Regression for Classification?</h2>
<p>If we try to use linear regression for classification by fitting a straight line to binary targets (0 and 1), we encounter two major problems:</p>
<ol>
<li><strong>Outliers</strong>: A single outlier far from the decision boundary can drastically shift the line, leading to incorrect classifications.</li>
<li><strong>Probability Bounds</strong>: Linear models can output values greater than 1 or less than 0, which have no meaning in the context of probability.</li>
</ol>
<p>Logistic regression solves this by passing the linear output through a <strong>Sigmoid Activation</strong>.</p>
<h2 id="the-sigmoid-function">The Sigmoid Function</h2>
<p>To map any real-valued number to the interval <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>, we use the <strong>Logistic Function</strong>, often called the <strong>Sigmoid Function</strong>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>Properties of the Sigmoid:</p>
<ul>
<li>It maps <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∞</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</li>
<li>At <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span>.</li>
<li>As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord">∞</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>.</li>
<li>As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord">∞</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>.</li>
</ul>
<p>The hypothesis function for logistic regression is then:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4023em;vertical-align:-0.5572em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.5011em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9841em"><span style="top:-2.9841em;margin-right:0.0714em"><span class="pstrut" style="height:2.6981em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9773em"><span style="top:-2.9773em;margin-right:0.1em"><span class="pstrut" style="height:2.6833em"></span><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5572em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h2 id="decision-boundaries">Decision Boundaries</h2>
<p>When we use the model for prediction, we typically set a threshold (usually 0.5):</p>
<ul>
<li>Predict <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span> (which implies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9773em;vertical-align:-0.136em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>)</li>
<li>Predict <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span> (which implies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8804em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>)</li>
</ul>
<p>The boundary where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> is the <strong>Decision Boundary</strong>. It can be linear OR non-linear (if we include polynomial features).</p>
<astro-island uid="Z1kFdGY" prefix="r10" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\n\ndef sigmoid(z):\n  return 1 / (1 + np.exp(-z))\n\nz = np.linspace(-10, 10, 100)\np = sigmoid(z)\n\nplt.plot(z, p)\nplt.axhline(y=0.5, color=&#39;r&#39;, linestyle=&#39;--&#39;)\nplt.title(\&quot;Sigmoid Function\&quot;)\nplt.xlabel(\&quot;z (Linear Output)\&quot;)\nplt.ylabel(\&quot;g(z) (Probability)\&quot;)\nplt.grid(True)\nprint(\&quot;Sigmoid visualization rendered.\&quot;)&quot;],&quot;output&quot;:[0,&quot;Sigmoid visualization rendered.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt

def sigmoid(z):
  return 1 / (1 + np.exp(-z))

z = np.linspace(-10, 10, 100)
p = sigmoid(z)

plt.plot(z, p)
plt.axhline(y=0.5, color=&#x27;r&#x27;, linestyle=&#x27;--&#x27;)
plt.title(&quot;Sigmoid Function&quot;)
plt.xlabel(&quot;z (Linear Output)&quot;)
plt.ylabel(&quot;g(z) (Probability)&quot;)
plt.grid(True)
print(&quot;Sigmoid visualization rendered.&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">def</span> sigmoid<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-z</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">z <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-flag">-10</span>, <span class="hl-number">10</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">p <span class="hl-operator">=</span> sigmoid<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>z, p<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">plt.axhline<span class="hl-bracket">(</span>y<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">5</span>, color<span class="hl-operator">=</span><span class="hl-string">&#039;r&#039;</span>, linestyle<span class="hl-operator">=</span><span class="hl-string">&#039;--&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Sigmoid Function&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">plt.xlabel<span class="hl-bracket">(</span><span class="hl-string">&quot;z (Linear Output)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">plt.ylabel<span class="hl-bracket">(</span><span class="hl-string">&quot;g(z) (Probability)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">plt.grid<span class="hl-bracket">(</span>True<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Sigmoid visualization rendered.&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="the-cost-function-log-loss-binary-cross-entropy">The Cost Function: Log Loss (Binary Cross-Entropy)</h2>
<p>In linear regression, we used Mean Squared Error (MSE). However, if we use MSE with the Sigmoid function, the cost function becomes non-convex, meaning gradient descent could get stuck in local minima.</p>
<p>Instead, we use <strong>Log Loss</strong>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">))]</span></span></span></span></p>
<p><strong>Why this works:</strong></p>
<ul>
<li>If the true label <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>, the second term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span> disappears. We are left with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span>. As our prediction <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> stays closer to 1, the cost is near 0. As it drops toward 0, the cost penalizes the model exponentially.</li>
<li>If the true label <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, the first term disappears. We are left with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<h2 id="optimization-gradient-descent">Optimization: Gradient Descent</h2>
<p>Even though the cost function is different, the gradient of the Log Loss function with respect to the parameters <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> results in the same update rule as linear regression!</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span></span></span></p>
<p><em>Note: The mathematical derivation involves the chain rule on the sigmoid and the log functions.</em></p>
<h2 id="implementation-from-scratch-with-python">Implementation from Scratch with Python</h2>
<p>Here is how you would implement the training loop for Logistic Regression using only NumPy.</p>
<astro-island uid="201uka" prefix="r11" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\nclass LogisticRegression:\n  def __init__(self, lr=0.1, n_iters=1000):\n      self.lr = lr\n      self.n_iters = n_iters\n      self.weights = None\n      self.bias = None\n\n  def _sigmoid(self, z):\n      return 1 / (1 + np.exp(-z))\n\n  def fit(self, X, y):\n      n_samples, n_features = X.shape\n      self.weights = np.zeros(n_features)\n      self.bias = 0\n\n      for _ in range(self.n_iters):\n          linear_model = np.dot(X, self.weights) + self.bias\n          y_predicted = self._sigmoid(linear_model)\n\n          # Gradient calculation\n          dw = (1 / n_samples) * np.dot(X.T, (y_predicted - y))\n          db = (1 / n_samples) * np.sum(y_predicted - y)\n\n          # Update weights\n          self.weights -= self.lr * dw\n          self.bias -= self.lr * db\n\n  def predict(self, X):\n      linear_model = np.dot(X, self.weights) + self.bias\n      y_predicted = self._sigmoid(linear_model)\n      return [1 if i &gt; 0.5 else 0 for i in y_predicted]\n\n# Example dataset\nX = np.array([[1, 2], [2, 1], [3, 4], [4, 3]])\ny = np.array([0, 0, 1, 1])\n\nclf = LogisticRegression(n_iters=5000)\nclf.fit(X, y)\nprint(f\&quot;Weights: {clf.weights}\&quot;)\nprint(f\&quot;Bias: {clf.bias:.4f}\&quot;)\nprint(f\&quot;Predictions: {clf.predict(X)}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Weights: [0.7... 0.7...]\nBias: -4.3...\nPredictions: [0, 0, 1, 1]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

class LogisticRegression:
  def __init__(self, lr=0.1, n_iters=1000):
      self.lr = lr
      self.n_iters = n_iters
      self.weights = None
      self.bias = None

  def _sigmoid(self, z):
      return 1 / (1 + np.exp(-z))

  def fit(self, X, y):
      n_samples, n_features = X.shape
      self.weights = np.zeros(n_features)
      self.bias = 0

      for _ in range(self.n_iters):
          linear_model = np.dot(X, self.weights) + self.bias
          y_predicted = self._sigmoid(linear_model)

          # Gradient calculation
          dw = (1 / n_samples) * np.dot(X.T, (y_predicted - y))
          db = (1 / n_samples) * np.sum(y_predicted - y)

          # Update weights
          self.weights -= self.lr * dw
          self.bias -= self.lr * db

  def predict(self, X):
      linear_model = np.dot(X, self.weights) + self.bias
      y_predicted = self._sigmoid(linear_model)
      return [1 if i &gt; 0.5 else 0 for i in y_predicted]

# Example dataset
X = np.array([[1, 2], [2, 1], [3, 4], [4, 3]])
y = np.array([0, 0, 1, 1])

clf = LogisticRegression(n_iters=5000)
clf.fit(X, y)
print(f&quot;Weights: {clf.weights}&quot;)
print(f&quot;Bias: {clf.bias:.4f}&quot;)
print(f&quot;Predictions: {clf.predict(X)}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">class</span> LogisticRegression:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> __init__<span class="hl-bracket">(</span>self, lr<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">1</span>, n_iters<span class="hl-operator">=</span><span class="hl-number">1000</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">      self.lr <span class="hl-operator">=</span> lr</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">      self.n_iters <span class="hl-operator">=</span> n_iters</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">      self.weights <span class="hl-operator">=</span> <span class="hl-keyword">None</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">      self.bias <span class="hl-operator">=</span> <span class="hl-keyword">None</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> _sigmoid<span class="hl-bracket">(</span>self, z<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">      <span class="hl-keyword">return</span> <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-z</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> fit<span class="hl-bracket">(</span>self, X, y<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">      n_samples, n_features <span class="hl-operator">=</span> X.shape</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">      self.weights <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span>n_features<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">      self.bias <span class="hl-operator">=</span> <span class="hl-number">0</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> _ <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>self.n_iters<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">          linear_model <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>X, self.weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> self.bias</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">          y_predicted <span class="hl-operator">=</span> self._sigmoid<span class="hl-bracket">(</span>linear_model<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">          <span class="hl-comment"># Gradient calculation</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">          dw <span class="hl-operator">=</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">/</span> n_samples<span class="hl-bracket">)</span> <span class="hl-operator">*</span> np.dot<span class="hl-bracket">(</span>X.T, <span class="hl-bracket">(</span>y_predicted <span class="hl-flag">-</span> y<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">          db <span class="hl-operator">=</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">/</span> n_samples<span class="hl-bracket">)</span> <span class="hl-operator">*</span> np.<span class="hl-function">sum</span><span class="hl-bracket">(</span>y_predicted <span class="hl-flag">-</span> y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">          <span class="hl-comment"># Update weights</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">          self.weights <span class="hl-flag">-</span><span class="hl-operator">=</span> self.lr <span class="hl-operator">*</span> dw</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">          self.bias <span class="hl-flag">-</span><span class="hl-operator">=</span> self.lr <span class="hl-operator">*</span> db</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> predict<span class="hl-bracket">(</span>self, X<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">      linear_model <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>X, self.weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> self.bias</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">      y_predicted <span class="hl-operator">=</span> self._sigmoid<span class="hl-bracket">(</span>linear_model<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre">      <span class="hl-keyword">return</span> <span class="hl-bracket">[</span><span class="hl-number">1</span> <span class="hl-keyword">if</span> i <span class="hl-operator">&gt;</span> <span class="hl-number">0</span>.<span class="hl-number">5</span> <span class="hl-keyword">else</span> <span class="hl-number">0</span> <span class="hl-keyword">for</span> i <span class="hl-keyword">in</span> y_predicted<span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre"><span class="hl-comment"># Example dataset</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">36</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">2</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">2</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">3</span>, <span class="hl-number">4</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">4</span>, <span class="hl-number">3</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">37</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">38</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">39</span><span class="whitespace-pre">clf <span class="hl-operator">=</span> LogisticRegression<span class="hl-bracket">(</span>n_iters<span class="hl-operator">=</span><span class="hl-number">5000</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">40</span><span class="whitespace-pre">clf.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">41</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Weights: {clf.weights}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">42</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Bias: {clf.bias:.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">43</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Predictions: {clf.predict(X)}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="performance-metrics-for-classification">Performance Metrics for Classification</h2>
<p>Accuracy is simply <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">TP</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">TN</span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord text"><span class="mord">Total Data</span></span></span></span></span>. While intuitive, it is dangerous for imbalanced data (e.g., detecting rare diseases). Instead, we use:</p>
<ol>
<li><strong>Confusion Matrix</strong>: A table showing True Positives (TP), True Negatives (TN), False Positives (FP), and False Negatives (FN).</li>
<li><strong>Precision</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">TP</span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord text"><span class="mord">TP</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">FP</span></span><span class="mclose">)</span></span></span></span>. Measures accuracy of positive predictions.</li>
<li><strong>Recall (Sensitivity)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">TP</span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord text"><span class="mord">TP</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">FN</span></span><span class="mclose">)</span></span></span></span>. Measures the coverage of positive instances.</li>
<li><strong>F1-Score</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2834em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Precision</span></span><span class="mbin mtight">+</span><span class="mord text mtight"><span class="mord mtight">Recall</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Precision</span></span><span class="mbin mtight">×</span><span class="mord text mtight"><span class="mord mtight">Recall</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Harmonic mean of both.</li>
<li><strong>ROC Curve and AUC</strong>: Plots the True Positive Rate against the False Positive Rate at various thresholds. AUC (Area Under the Curve) measures overall model quality.</li>
</ol>
<astro-island uid="Z1YtUbO" prefix="r12" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;In a medical test for a dangerous disease, which metric is more important to maximize?&quot;],&quot;options&quot;:[1,[[0,&quot;Precision&quot;],[0,&quot;Recall&quot;],[0,&quot;Accuracy&quot;],[0,&quot;F1-Score&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;In medical contexts, a False Negative (missing a sick patient) is far worse than a False Positive (treating a healthy patient). Recall measures how many of the actual sick patients you caught.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">In a medical test for a dangerous disease, which metric is more important to maximize?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Precision</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Recall</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Accuracy</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">F1-Score</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="multiclass-classification-softmax-and-one-vs-rest">Multiclass Classification: Softmax and One-vs-Rest</h2>
<p>Logistic regression is binary by default. To classify <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> classes:</p>
<ul>
<li>
<p><strong>One-vs-Rest (OvR)</strong>: Train <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> binary classifiers. Pick the class with the highest probability.</p>
</li>
<li>
<p><strong>Multinomial Logistic Regression (Softmax)</strong>: Generalize the Sigmoid to the <strong>Softmax function</strong>, which turns a vector of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> scores into a probability distribution that sums to 1:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6629em;vertical-align:-0.7519em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.911em"><span style="top:-2.5703em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8852em"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.779em"><span style="top:-2.9714em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3448em;margin-left:-0.044em;margin-right:0.1em"><span class="pstrut" style="height:2.6595em"></span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5092em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3448em;margin-left:-0.044em;margin-right:0.1em"><span class="pstrut" style="height:2.6595em"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
</ul>
<h2 id="regularization">Regularization</h2>
<p>Just like linear models, logistic regression can overfit if it has too many features. We can add a penalty term to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> to keep parameters small:</p>
<ul>
<li><strong>L1 (Lasso)</strong>: Adds <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>. Can perform feature selection by making weights zero.</li>
<li><strong>L2 (Ridge)</strong>: Adds <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span></span></span>. Standard for preventing overfitting.</li>
</ul>
<h2 id="interpretability-and-the-odds-ratio">Interpretability and the Odds Ratio</h2>
<p>One of the great advantages of Logistic Regression over complex “black-box” models like Deep Learning is its interpretability.</p>
<p>The linear part of the model, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.123em"></span><span class="minner">…</span></span></span></span>, can be rewritten in terms of the <strong>logit</strong> function (the inverse of the sigmoid):</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.123em"></span><span class="minner">…</span></span></span></span></p>
<p>The term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2286em;vertical-align:-0.4811em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> is known as the <strong>Odds</strong>. By taking the exponent of a weight <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, we get the <strong>Odds Ratio</strong>:</p>
<ul>
<li>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.2</span></span></span></span>, it means that for every 1-unit increase in feature <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, the odds of the positive class increase by 20%, holding all other features constant.</li>
<li>This makes logistic regression a favorite in fields like medicine and sociology where understanding <em>why</em> a prediction was made is just as important as the prediction itself.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Logistic Regression is the gateway to deep learning. A single neuron in a neural network is essentially a logistic regression unit (with a bias and weights). Mastering its optimization and evaluation logic is vital for transitioning to modern AI architectures.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Regularization Theory: Combating Overfitting</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-problem-of-overfitting">The Problem of Overfitting</h1>
<p>In machine learning, we don’t just care about minimizing error on our training data; we care about <strong>generalization</strong>—the performance on unseen data. A model that fits the training set perfectly but fails on new data is said to be <strong>Overfitting</strong>. This occurs when the model (the hypothesis <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span>) is too complex relative to the amount and noise of the data, essentially “memorizing” individual samples rather than learning the underlying function.</p>
<h2 id="1-the-bias-variance-trade-off">1. The Bias-Variance Trade-off</h2>
<p>Regularization is the mathematical tool used to navigate the <strong>Bias-Variance trade-off</strong>.</p>
<ul>
<li><strong>Variance</strong>: The error from sensitivity to small fluctuations in the training set. High variance leads to a model that captures random noise as if it were signal.</li>
<li><strong>Bias</strong>: The error from erroneous assumptions in the learning algorithm. High bias leads to a model that misses the relevant relations between features and targets (<strong>Underfitting</strong>).</li>
</ul>
<p>Total Expected Error can be decomposed as:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Total Error</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9707em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord text"><span class="mord">Bias</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em"><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord">Variance</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0728em;vertical-align:-0.2587em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">se</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></p>
<p>Regularization intentionally increases the bias slightly to achieve a significantly larger reduction in variance, leading to lower total error on the test set.</p>
<h2 id="2-weight-penalties-l1-vs-l2">2. Weight Penalties: L1 vs. L2</h2>
<p>Weight regularization adds a penalty term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> to the cost function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> to discourage large coefficients.</p>
<h3 id="ridge-regularization-l2">Ridge Regularization (L2)</h3>
<p>L2 regularization adds the sum of the squares of the weights. The augmented cost function becomes:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.3159em;vertical-align:-0.4358em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span></span></span>
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span> is the <strong>regularization parameter</strong>. As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord">∞</span></span></span></span>, weights <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>. L2 is effective at handling multicollinearity (correlated features).</p>
<h3 id="lasso-regularization-l1">Lasso Regularization (L1)</h3>
<p>Lasso (Least Absolute Shrinkage and Selection Operator) uses the sum of absolute magnitudes:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.3159em;vertical-align:-0.4358em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>
L1 is unique because it produces <strong>sparse models</strong>. It acts as a built-in feature selection tool by forcing redundant or irrelevant feature weights to be exactly zero.</p>
<astro-island uid="ZQEbdm" prefix="r13" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import Ridge, Lasso, LinearRegression\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.pipeline import make_pipeline\n\n# Create noisy data\nnp.random.seed(42)\nX = np.sort(np.random.rand(20, 1) * 3, axis=0)\ny = 0.5 * X**3 - 2 * X**2 + X + np.random.normal(0, 0.5, X.shape)\n\n# Transform to high-degree polynomial (prone to overfitting)\ndegree = 10\nX_test = np.linspace(0, 3, 100).reshape(-1, 1)\n\n# Compare No Reg, L1, and L2\nmodels = [\n  (\&quot;Linear (No Reg)\&quot;, make_pipeline(PolynomialFeatures(degree), LinearRegression())),\n  (\&quot;Ridge (L2)\&quot;, make_pipeline(PolynomialFeatures(degree), Ridge(alpha=10))),\n  (\&quot;Lasso (L1)\&quot;, make_pipeline(PolynomialFeatures(degree), Lasso(alpha=0.1)))\n]\n\nplt.figure(figsize=(12, 6))\nplt.scatter(X, y, color=&#39;black&#39;, label=\&quot;Samples\&quot;)\nfor name, model in models:\n  model.fit(X, y)\n  plt.plot(X_test, model.predict(X_test), label=name, linewidth=2)\n\nplt.ylim(-5, 5)\nplt.legend()\nplt.title(\&quot;L1 vs L2 vs No Regularization (High Degree Polynomial)\&quot;)\nplt.show()\n\nlasso_coefs = models[2][1].named_steps[&#39;lasso&#39;].coef_\nprint(f\&quot;Lasso non-zero coefficients: {np.sum(lasso_coefs != 0)} out of {len(lasso_coefs)}\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import Ridge, Lasso, LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import make_pipeline

# Create noisy data
np.random.seed(42)
X = np.sort(np.random.rand(20, 1) * 3, axis=0)
y = 0.5 * X**3 - 2 * X**2 + X + np.random.normal(0, 0.5, X.shape)

# Transform to high-degree polynomial (prone to overfitting)
degree = 10
X_test = np.linspace(0, 3, 100).reshape(-1, 1)

# Compare No Reg, L1, and L2
models = [
  (&quot;Linear (No Reg)&quot;, make_pipeline(PolynomialFeatures(degree), LinearRegression())),
  (&quot;Ridge (L2)&quot;, make_pipeline(PolynomialFeatures(degree), Ridge(alpha=10))),
  (&quot;Lasso (L1)&quot;, make_pipeline(PolynomialFeatures(degree), Lasso(alpha=0.1)))
]

plt.figure(figsize=(12, 6))
plt.scatter(X, y, color=&#x27;black&#x27;, label=&quot;Samples&quot;)
for name, model in models:
  model.fit(X, y)
  plt.plot(X_test, model.predict(X_test), label=name, linewidth=2)

plt.ylim(-5, 5)
plt.legend()
plt.title(&quot;L1 vs L2 vs No Regularization (High Degree Polynomial)&quot;)
plt.show()

lasso_coefs = models[2][1].named_steps[&#x27;lasso&#x27;].coef_
print(f&quot;Lasso non-zero coefficients: {np.sum(lasso_coefs != 0)} out of {len(lasso_coefs)}&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.linear_model <span class="hl-keyword">import</span> Ridge, Lasso, LinearRegression</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.preprocessing <span class="hl-keyword">import</span> PolynomialFeatures</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.pipeline <span class="hl-keyword">import</span> make_pipeline</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-comment"># Create noisy data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.sort<span class="hl-bracket">(</span>np.random.rand<span class="hl-bracket">(</span><span class="hl-number">20</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span> <span class="hl-operator">*</span> <span class="hl-number">3</span>, axis<span class="hl-operator">=</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">y <span class="hl-operator">=</span> <span class="hl-number">0</span>.<span class="hl-number">5</span> <span class="hl-operator">*</span> X<span class="hl-operator">*</span><span class="hl-operator">*</span><span class="hl-number">3</span> <span class="hl-flag">-</span> <span class="hl-number">2</span> <span class="hl-operator">*</span> X<span class="hl-operator">*</span><span class="hl-operator">*</span><span class="hl-number">2</span> <span class="hl-operator">+</span> X <span class="hl-operator">+</span> np.random.normal<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">0</span>.<span class="hl-number">5</span>, X.shape<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-comment"># Transform to high-degree polynomial (prone to overfitting)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">degree <span class="hl-operator">=</span> <span class="hl-number">10</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">X_test <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">3</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span>.reshape<span class="hl-bracket">(</span><span class="hl-flag">-1</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-comment"># Compare No Reg, L1, and L2</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">models <span class="hl-operator">=</span> <span class="hl-bracket">[</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">  <span class="hl-bracket">(</span><span class="hl-string">&quot;Linear (No Reg)&quot;</span>, make_pipeline<span class="hl-bracket">(</span>PolynomialFeatures<span class="hl-bracket">(</span>degree<span class="hl-bracket">)</span>, LinearRegression<span class="hl-bracket">(</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">  <span class="hl-bracket">(</span><span class="hl-string">&quot;Ridge (L2)&quot;</span>, make_pipeline<span class="hl-bracket">(</span>PolynomialFeatures<span class="hl-bracket">(</span>degree<span class="hl-bracket">)</span>, Ridge<span class="hl-bracket">(</span>alpha<span class="hl-operator">=</span><span class="hl-number">10</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">  <span class="hl-bracket">(</span><span class="hl-string">&quot;Lasso (L1)&quot;</span>, make_pipeline<span class="hl-bracket">(</span>PolynomialFeatures<span class="hl-bracket">(</span>degree<span class="hl-bracket">)</span>, Lasso<span class="hl-bracket">(</span>alpha<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">1</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">12</span>, <span class="hl-number">6</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">plt.scatter<span class="hl-bracket">(</span>X, y, color<span class="hl-operator">=</span><span class="hl-string">&#039;black&#039;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;Samples&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre"><span class="hl-keyword">for</span> name, model <span class="hl-keyword">in</span> models:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">  model.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">  plt.plot<span class="hl-bracket">(</span>X_test, model.predict<span class="hl-bracket">(</span>X_test<span class="hl-bracket">)</span>, label<span class="hl-operator">=</span>name, linewidth<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">plt.ylim<span class="hl-bracket">(</span><span class="hl-flag">-5</span>, <span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">plt.legend<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;L1 vs L2 vs No Regularization (High Degree Polynomial)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre">lasso_coefs <span class="hl-operator">=</span> models<span class="hl-bracket">[</span><span class="hl-number">2</span><span class="hl-bracket">]</span><span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span>.named_steps<span class="hl-bracket">[</span><span class="hl-string">&#039;lasso&#039;</span><span class="hl-bracket">]</span>.coef_</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Lasso non-zero coefficients: {np.sum(lasso_coefs != 0)} out of {len(lasso_coefs)}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">36</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="3-regularization-in-deep-learning">3. Regularization in Deep Learning</h2>
<p>While L1/L2 weights are still used in neural networks (often called “Weight Decay”), deep learning architectures require specialized techniques.</p>
<h3 id="dropout">Dropout</h3>
<p>Dropout is a stochastic regularization technique where, during training, each neuron in a layer is “dropped” (set to zero) with a probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> (e.g., 0.5).</p>
<ul>
<li><strong>Intuition</strong>: This prevents “co-adaptation” of neurons. A neuron cannot rely on the presence of specific other neurons to correct its mistakes, forcing it to learn more robust, independent features.</li>
<li><strong>At Inference</strong>: Dropout is turned off, and weights are scaled by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> to account for the increased number of active neurons.</li>
</ul>
<h3 id="batch-normalization">Batch Normalization</h3>
<p>Although often viewed as an optimization accelerator, Batch Norm acts as a powerful regularizer. By normalizing the inputs to each layer (subtracting mean, dividing by variance), it reduces “Internal Covariate Shift” and adds a small amount of noise, reducing the need for Dropout.</p>
<h3 id="early-stopping">Early Stopping</h3>
<p>Early stopping is a simple yet effective strategy: monitor the model’s performance on a validation set during training. When validation loss stops decreasing (or starts increasing) while training loss continues to fall, terminate training. This “free” regularization prevents the model from fitting the noise that appears late in the training process.</p>
<h2 id="4-normalization-and-scaling">4. Normalization and Scaling</h2>
<p>Regularization is highly sensitive to the scale of features. Since <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> treats all <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> equally in the penalty term, a feature with a large range (e.g., House Price in millions) would have a disproportionately large weight compared to a feature with a small range (e.g., Number of Bathrooms), even if the latter is more important.</p>
<p><strong>Crucial Step</strong>: Always apply <strong>Standardization</strong> (Z-score normalization) or <strong>Min-Max Scaling</strong> before applying L1 or L2 regularization.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1994em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8544em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">σ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<astro-island uid="2m6niW" prefix="r14" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is regularization almost always paired with feature scaling?&quot;],&quot;options&quot;:[1,[[0,&quot;To make the cost function look like a perfectly round bowl, ensuring the penalty term treats all features fairly regardless of their original magnitude.&quot;],[0,&quot;Because regularization only works on features between 0 and 1.&quot;],[0,&quot;To ensure that Dropout can turn off the correct neurons.&quot;],[0,&quot;To prevent categorical variables from being ignored.&quot;]]],&quot;answerIndex&quot;:[0,0],&quot;explanation&quot;:[0,&quot;The penalty term $\\lambda \\sum \\theta^2$ does not distinguish between feature units. If one feature is 1000x larger than another, its coefficient will naturally be 1000x smaller. Without scaling, the regularization penalty would unfairly target features with large scales, possibly ignoring smaller but more predictive features.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is regularization almost always paired with feature scaling?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To make the cost function look like a perfectly round bowl, ensuring the penalty term treats all features fairly regardless of their original magnitude.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because regularization only works on features between 0 and 1.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To ensure that Dropout can turn off the correct neurons.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To prevent categorical variables from being ignored.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="5-elastic-net-the-best-of-both-worlds">5. Elastic Net: The Best of Both Worlds</h2>
<p>When you have a dataset with many correlated features, Lasso (L1) tends to arbitrarily pick one feature and zero out the others. Ridge (L2) tends to keep all of them. <strong>Elastic Net</strong> combines both penalties:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span></span></span></p>
<p>This allows for sparse selection (like Lasso) while maintaining the stability and group-selection properties of Ridge.</p>
<h2 id="summary-checklist">Summary Checklist</h2>
<ul>
<li><strong>Symptoms of Overfitting</strong>: Large gap between training and validation accuracy; extremely large weight magnitudes.</li>
<li><strong>Solution Strategy</strong>:
<ol>
<li>Add more data (if possible).</li>
<li>Simplify the model (fewer parameters/layers).</li>
<li>Apply <strong>L2 Regularization</strong> for general stabilization.</li>
<li>Apply <strong>L1 Regularization</strong> if you suspect many features are irrelevant.</li>
<li>Use <strong>Dropout</strong> and <strong>Early Stopping</strong> for neural networks.</li>
</ol>
</li>
</ul> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Algorithms</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Support Vector Machines: Maximum Margin Classifiers</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="geometric-logic-of-support-vector-machines">Geometric Logic of Support Vector Machines</h1>
<p>Support Vector Machines (SVMs) represent one of the most mathematically rigorous approaches to classification. While algorithms like Logistic Regression focus on minimizing probability errors, SVM is fundamentally geometric. It seeks to find the hyperplane that separates classes with the <strong>Maximum Margin</strong>.</p>
<div class="my-12 flex flex-col items-center bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-[2.5rem] overflow-hidden shadow-xl p-8 transition-colors"> <div class="w-full flex justify-center overflow-x-auto dark:invert dark:hue-rotate-180 dark:brightness-110"> 
        <div class="w-full text-center py-10 bg-rose-50/50 dark:bg-rose-900/10 rounded-3xl border border-rose-200 dark:border-rose-900/30">
            <div class="inline-flex p-3 bg-rose-100 dark:bg-rose-900/40 text-rose-600 dark:text-rose-400 rounded-2xl mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            </div>
            <h4 class="font-black text-rose-900 dark:text-rose-100 uppercase tracking-tighter text-sm mb-1">Diagram Rendering Suspended</h4>
            <p class="text-[10px] font-bold text-rose-400/80 uppercase tracking-widest leading-relaxed px-4">The public PlantUML servers are currently unreachable or over-capacity.</p>
            
            <div class="mt-8 mx-auto max-w-[90%] text-left">
                <div class="flex items-center justify-between mb-2 px-4">
                    <div class="text-[9px] font-black text-light-muted dark:text-dark-muted uppercase tracking-[0.2em] opacity-50">Local Source Definition</div>
                    <a href="https://www.plantuml.com/plantuml/uml/TP1DQy9048Rl-ok6d5A846EB7ZLAeOUKqXvwdhgZBYQpOMQ3sb_VDH4Q2ptDpFFE5-zI0qhecjeOqAFZ5WKR-CBjSI--OxlsjHS8WgnH8WxZDZsWzIV7UzXXhJIMDhJ3hWxFdiChDWJ92mUI98D4BngecNGk5XhNJfJ4xVwP_N3V1DDYhBwXjTUJYp5y7tuL9ldJNk6v8bNSqx3hAH-h9y7sqzbmW2A_4zXRKchXlZtQSBnHyqiFoFOaBWJYcn6_MkFPRm_YemL1EZ9My0Jd32w0PrAJvbd-0AZWnUqTcxJ85dtTJaqwo-P3NfXqditwd2DVP8z3NfZhcv2iQrI5LNA5gpjMzgmqxHGcawYrnH2vhql3nH1DxJWERMZhr7c6ykedogKVtvIcGOdlGLBriQULMHBRhgb_0000" target="_blank" class="text-[9px] font-black text-primary uppercase tracking-[0.2em] hover:underline">Open in Editor ↗</a>
                </div>
                <pre class="bg-white/50 dark:bg-black/20 p-6 rounded-2xl border border-rose-100 dark:border-rose-900/20 font-mono text-xs overflow-x-auto text-light-text dark:text-dark-text opacity-70">@startuml
skinparam handwritten false
skinparam monochrome true
draw x, y axes
(0,0) as origin
(2,8) as p1
(3,7) as p2
(7,3) as n1
(8,4) as n2
node "Class A" as A
node "Class B" as B
p1 -- A
p2 -- A
n1 -- B
n2 -- B

line "Decision Boundary" as DB
margin "Margin" as M
@enduml</pre>
            </div>
        </div>
       </div> </div>
<h2 id="the-maximum-margin-hyperplane">The Maximum Margin Hyperplane</h2>
<p>In a binary classification task, multiple hyperplanes could technically separate the data. However, a hyperplane that passes too close to the data points of either class is “brittle”—a small amount of noise in new data could easily lead to a misclassification.</p>
<p>SVM identifies the <strong>Support Vectors</strong>: the data points from each class that are closest to the boundary. The distance between the parallel hyperplanes passing through these support vectors is the <strong>Margin</strong>. SVM optimizes to find the boundary that maximizes this distance.</p>
<h2 id="mathematical-formulation-the-primal-problem">Mathematical Formulation: The Primal Problem</h2>
<p>A hyperplane in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-dimensional space is defined by the equation:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></p>
<p>For a dataset <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>, we want to satisfy:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9713em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9713em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord">1</span></span></span></span> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></li>
</ul>
<p>This simplifies to the constraint:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></p>
<p>The distance from a point to the hyperplane is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6484em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1284em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="mord mtight">∣∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. By setting the functional margin to 1 for the support vectors, the geometric margin becomes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3651em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="mord mtight">∣∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Maximizing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3651em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="mord mtight">∣∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> is equivalent to minimizing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>This is a <strong>Quadratic Programming (QP)</strong> problem:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></p>
<h2 id="handling-non-linearity-soft-margin-svm">Handling Non-Linearity: Soft Margin SVM</h2>
<p>Real-world datasets are rarely linearly separable. They contain noise, outliers, and overlapping distributions. To address this, we introduce <strong>Slack Variables</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>. These allow certain points to “violate” the margin.</p>
<p>The new objective function becomes:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04601em">ξ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></p>
<h3 id="the-c-hyperparameter">The C Hyperparameter</h3>
<p>The parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> acts as a regularization weight:</p>
<ul>
<li><strong>Large <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> (Hard Margin)</strong>: The model is heavily penalized for any misclassification. This leads to a narrow margin and high sensitivity to outliers (High Variance/Overfitting).</li>
<li><strong>Small <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> (Soft Margin)</strong>: The model is more “forgiving”, allowing more points to be inside the margin or misclassified in exchange for a wider boundary (High Bias/Better Generalization).</li>
</ul>
<astro-island uid="1QqLiB" prefix="r15" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import svm\n\n# Generate un-separable data\nX = np.r_[np.random.randn(20, 2) - [2, 2], np.random.randn(20, 2) + [2, 2]]\nY = [0] * 20 + [1] * 20\n\n# Fit models with different C values\nclf_soft = svm.SVC(kernel=&#39;linear&#39;, C=0.01)\nclf_hard = svm.SVC(kernel=&#39;linear&#39;, C=100)\n\nclf_soft.fit(X, Y)\nclf_hard.fit(X, Y)\n\nprint(f\&quot;Soft Margin (C=0.01) Support Vectors: {len(clf_soft.support_vectors_)}\&quot;)\nprint(f\&quot;Hard Margin (C=100) Support Vectors: {len(clf_hard.support_vectors_)}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Soft Margin (C=0.01) Support Vectors: 25-30\nHard Margin (C=100) Support Vectors: 2-5&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn import svm

# Generate un-separable data
X = np.r_[np.random.randn(20, 2) - [2, 2], np.random.randn(20, 2) + [2, 2]]
Y = [0] * 20 + [1] * 20

# Fit models with different C values
clf_soft = svm.SVC(kernel=&#x27;linear&#x27;, C=0.01)
clf_hard = svm.SVC(kernel=&#x27;linear&#x27;, C=100)

clf_soft.fit(X, Y)
clf_hard.fit(X, Y)

print(f&quot;Soft Margin (C=0.01) Support Vectors: {len(clf_soft.support_vectors_)}&quot;)
print(f&quot;Hard Margin (C=100) Support Vectors: {len(clf_hard.support_vectors_)}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn <span class="hl-keyword">import</span> svm</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Generate un-separable data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.r_<span class="hl-bracket">[</span>np.random.randn<span class="hl-bracket">(</span><span class="hl-number">20</span>, <span class="hl-number">2</span><span class="hl-bracket">)</span> <span class="hl-flag">-</span> <span class="hl-bracket">[</span><span class="hl-number">2</span>, <span class="hl-number">2</span><span class="hl-bracket">]</span>, np.random.randn<span class="hl-bracket">(</span><span class="hl-number">20</span>, <span class="hl-number">2</span><span class="hl-bracket">)</span> <span class="hl-operator">+</span> <span class="hl-bracket">[</span><span class="hl-number">2</span>, <span class="hl-number">2</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">Y <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span> <span class="hl-operator">*</span> <span class="hl-number">20</span> <span class="hl-operator">+</span> <span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span> <span class="hl-operator">*</span> <span class="hl-number">20</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># Fit models with different C values</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">clf_soft <span class="hl-operator">=</span> svm.SVC<span class="hl-bracket">(</span>kernel<span class="hl-operator">=</span><span class="hl-string">&#039;linear&#039;</span>, C<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">01</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">clf_hard <span class="hl-operator">=</span> svm.SVC<span class="hl-bracket">(</span>kernel<span class="hl-operator">=</span><span class="hl-string">&#039;linear&#039;</span>, C<span class="hl-operator">=</span><span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">clf_soft.fit<span class="hl-bracket">(</span>X, Y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">clf_hard.fit<span class="hl-bracket">(</span>X, Y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Soft Margin (C=0.01) Support Vectors: {len(clf_soft.support_vectors_)}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Hard Margin (C=100) Support Vectors: {len(clf_hard.support_vectors_)}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="the-dual-problem-and-lagrange-multipliers">The Dual Problem and Lagrange Multipliers</h2>
<p>The Primal optimization is dependent on the dimensionality of the features. By converting it to its <strong>Dual Form</strong> using Lagrange multipliers <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, the problem becomes dependent on the number of training samples <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span></span></span></span>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.3238em;vertical-align:-0.4358em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>Subject to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>.</p>
<p>Crucially, the data points <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> only appear as <strong>dot products</strong>. This observation leads to the most famous feature of SVMs: the Kernel Trick.</p>
<h2 id="the-kernel-trick">The Kernel Trick</h2>
<p>If a dataset is not linearly separable in its original space, we can map it to a higher-dimensional feature space <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> where a linear separator might exist. However, computing high-dimensional mappings is computationally expensive.</p>
<p>A <strong>Kernel function</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span></span></span></span> computes the dot product in the high-dimensional space directly from the original vectors:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span></span></span></span></p>
<h3 id="common-kernels">Common Kernels</h3>
<ol>
<li><strong>Linear</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span>. Standard linear boundary.</li>
<li><strong>Polynomial</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>. Useful for data with curved boundaries.</li>
<li><strong>Radial Basis Function (RBF)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord">∣∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. This implicitly maps data into an <strong>infinite-dimensional</strong> space. It is the most robust and widely used kernel.</li>
</ol>
<astro-island uid="ZXck64" prefix="r16" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn import datasets\nfrom sklearn.svm import SVC\n\n# Load XOR-like data\nX, y = datasets.make_moons(n_samples=100, noise=0.1, random_state=42)\n\n# Linear kernel (will fail on moons)\nclf_lin = SVC(kernel=&#39;linear&#39;).fit(X, y)\n# RBF kernel (will succeed)\nclf_rbf = SVC(kernel=&#39;rbf&#39;, gamma=&#39;auto&#39;).fit(X, y)\n\nprint(f\&quot;Linear Accuracy: {clf_lin.score(X, y):.2f}\&quot;)\nprint(f\&quot;RBF Accuracy: {clf_rbf.score(X, y):.2f}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Linear Accuracy: 0.86\nRBF Accuracy: 0.98&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn import datasets
from sklearn.svm import SVC

# Load XOR-like data
X, y = datasets.make_moons(n_samples=100, noise=0.1, random_state=42)

# Linear kernel (will fail on moons)
clf_lin = SVC(kernel=&#x27;linear&#x27;).fit(X, y)
# RBF kernel (will succeed)
clf_rbf = SVC(kernel=&#x27;rbf&#x27;, gamma=&#x27;auto&#x27;).fit(X, y)

print(f&quot;Linear Accuracy: {clf_lin.score(X, y):.2f}&quot;)
print(f&quot;RBF Accuracy: {clf_rbf.score(X, y):.2f}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn <span class="hl-keyword">import</span> datasets</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.svm <span class="hl-keyword">import</span> SVC</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># Load XOR-like data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">X, y <span class="hl-operator">=</span> datasets.make_moons<span class="hl-bracket">(</span>n_samples<span class="hl-operator">=</span><span class="hl-number">100</span>, noise<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">1</span>, random_state<span class="hl-operator">=</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-comment"># Linear kernel (will fail on moons)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">clf_lin <span class="hl-operator">=</span> SVC<span class="hl-bracket">(</span>kernel<span class="hl-operator">=</span><span class="hl-string">&#039;linear&#039;</span><span class="hl-bracket">)</span>.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># RBF kernel (will succeed)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">clf_rbf <span class="hl-operator">=</span> SVC<span class="hl-bracket">(</span>kernel<span class="hl-operator">=</span><span class="hl-string">&#039;rbf&#039;</span>, gamma<span class="hl-operator">=</span><span class="hl-string">&#039;auto&#039;</span><span class="hl-bracket">)</span>.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Linear Accuracy: {clf_lin.score(X, y):.2f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;RBF Accuracy: {clf_rbf.score(X, y):.2f}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="support-vectors-the-sparesness-of-the-solution">Support Vectors: The Sparesness of the Solution</h2>
<p>In the Dual formulation, most <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> will be zero. Only the points where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> contribute to the final decision function. These are the <strong>Support Vectors</strong>.</p>
<p>This means SVM is a “sparse” model. Once the model is trained, we can throw away most of the training data; we only need to store the support vectors to make future predictions. This contrast with algorithms like <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-Nearest Neighbors, which require storing the entire dataset.</p>
<h2 id="svm-for-regression-svr">SVM for Regression (SVR)</h2>
<p>SVM can be adapted for regression by flipping the logic. In classification, we want to keep points <em>out</em> of the margin. In <strong>Support Vector Regression (SVR)</strong>, we want to fit as many points as possible <em>inside</em> a tube of width <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span> around the prediction line, while minimizing the weights.</p>
<astro-island uid="Z9SO6O" prefix="r17" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;How does the RBF kernel handle data that is not linearly separable?&quot;],&quot;options&quot;:[1,[[0,&quot;It ignores the outliers to find a straight line.&quot;],[0,&quot;It maps the data into a higher-dimensional space where a linear hyperplane can separate the classes.&quot;],[0,&quot;It converts the classification problem into a regression problem.&quot;],[0,&quot;It uses a voting system between multiple linear models.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;The RBF kernel projects data into a higher (potentially infinite) dimensional space where points that are clustered together in the original space become linearly separable from other clusters.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">How does the RBF kernel handle data that is not linearly separable?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It ignores the outliers to find a straight line.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It maps the data into a higher-dimensional space where a linear hyperplane can separate the classes.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It converts the classification problem into a regression problem.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It uses a voting system between multiple linear models.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="training-svms-in-python-with-scikit-learn">Training SVMs in Python with Scikit-Learn</h2>
<p>When using SVM in practice, three hyperparameters are critical:</p>
<ol>
<li><strong>C</strong>: Penalty for misclassification.</li>
<li><strong>kernel</strong>: The type of boundary (linear, poly, rbf).</li>
<li><strong>gamma</strong>: Specific to RBF. It defines how far the influence of a single training example reaches. Low gamma means ‘far’ (smooth boundary), high gamma means ‘close’ (wiggly boundary).</li>
</ol>
<astro-island uid="Z2j2CnW" prefix="r18" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.svm import SVC\nfrom sklearn.model_selection import GridSearchCV\n\n# Simulating hyperparameter tuning\nparam_grid = {&#39;C&#39;: [0.1, 1, 10], &#39;gamma&#39;: [1, 0.1, 0.01], &#39;kernel&#39;: [&#39;rbf&#39;]}\ngrid = GridSearchCV(SVC(), param_grid, refit=True, verbose=0)\n# grid.fit(X, y) # In real usage\nprint(\&quot;GridSearchCV identifies the optimal C and Gamma to balance Bias and Variance.\&quot;)&quot;],&quot;output&quot;:[0,&quot;GridSearchCV identifies the optimal C and Gamma to balance Bias and Variance.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.svm import SVC
from sklearn.model_selection import GridSearchCV

# Simulating hyperparameter tuning
param_grid = {&#x27;C&#x27;: [0.1, 1, 10], &#x27;gamma&#x27;: [1, 0.1, 0.01], &#x27;kernel&#x27;: [&#x27;rbf&#x27;]}
grid = GridSearchCV(SVC(), param_grid, refit=True, verbose=0)
# grid.fit(X, y) # In real usage
print(&quot;GridSearchCV identifies the optimal C and Gamma to balance Bias and Variance.&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.svm <span class="hl-keyword">import</span> SVC</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.model_selection <span class="hl-keyword">import</span> GridSearchCV</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># Simulating hyperparameter tuning</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">param_grid <span class="hl-operator">=</span> <span class="hl-bracket">{</span><span class="hl-string">&#039;C&#039;</span>: <span class="hl-bracket">[</span><span class="hl-number">0</span>.<span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">10</span><span class="hl-bracket">]</span>, <span class="hl-string">&#039;gamma&#039;</span>: <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">0</span>.<span class="hl-number">1</span>, <span class="hl-number">0</span>.<span class="hl-number">01</span><span class="hl-bracket">]</span>, <span class="hl-string">&#039;kernel&#039;</span>: <span class="hl-bracket">[</span><span class="hl-string">&#039;rbf&#039;</span><span class="hl-bracket">]</span><span class="hl-bracket">}</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">grid <span class="hl-operator">=</span> GridSearchCV<span class="hl-bracket">(</span>SVC<span class="hl-bracket">(</span><span class="hl-bracket">)</span>, param_grid, refit<span class="hl-operator">=</span>True, verbose<span class="hl-operator">=</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-comment"># grid.fit(X, y) # In real usage</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;GridSearchCV identifies the optimal C and Gamma to balance Bias and Variance.&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="comparison-svm-vs-logistic-regression">Comparison: SVM vs. Logistic Regression</h2>






























<table><thead><tr><th style="text-align:left">Feature</th><th style="text-align:left">SVM</th><th style="text-align:left">Logistic Regression</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Objective</strong></td><td style="text-align:left">Maximize Margin</td><td style="text-align:left">Maximize Likelihood / Minimize Log-Loss</td></tr><tr><td style="text-align:left"><strong>Sensitivity</strong></td><td style="text-align:left">Only Support Vectors matter</td><td style="text-align:left">All points influence the boundary</td></tr><tr><td style="text-align:left"><strong>Output</strong></td><td style="text-align:left">Class label (hard)</td><td style="text-align:left">Probability (soft)</td></tr><tr><td style="text-align:left"><strong>Complexity</strong></td><td style="text-align:left">Handles non-linearity via Kernels</td><td style="text-align:left">Requires manual feature engineering for non-linearity</td></tr></tbody></table>
<h2 id="conclusion">Conclusion</h2>
<p>Support Vector Machines offer a robust framework for classification, especially when dealing with high-dimensional data where the number of features exceeds the number of samples. By understanding the geometric trade-offs between margin width and classification error, and leveraging the power of kernels, one can build models that generalize exceptionally well to unseen data.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Decision Trees: Recursive Partitioning of Feature Space</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="hierarchical-logic">Hierarchical Logic</h1>
<p>A Decision Tree is a non-parametric supervised learning method used for classification and regression. Unlike linear models that find a global hyperplane, decision trees partition the feature space into a set of rectangular regions. The goal is to create a model that predicts the target variable by learning simple “if-then-else” decision rules.</p>
<p>The structure is intuitive:</p>
<ul>
<li><strong>Internal Nodes</strong>: Represent a test on an attribute (e.g., “Is Age &gt; 30?”).</li>
<li><strong>Branches</strong>: Represent the outcome of the test.</li>
<li><strong>Leaf Nodes</strong>: Represent a class label (classification) or a continuous value (regression).</li>
</ul>
<h2 id="measuring-impurity-the-math-of-splits">Measuring Impurity: The Math of Splits</h2>
<p>To build an optimal tree, we need a mathematical criterion to decide which feature to split on. We want to choose the split that results in the “purest” child nodes.</p>
<h3 id="1-entropy">1. Entropy</h3>
<p>Entropy measures the amount of uncertainty or “disorder” in a dataset. For a classification problem with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> classes, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is the proportion of examples belonging to class <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<ul>
<li><strong>Purity</strong>: If all examples in node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span> belong to one class, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>.</li>
<li><strong>Chaos</strong>: If examples are evenly distributed across classes, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span></span></span></span> is maximized.</li>
</ul>
<h3 id="2-gini-impurity">2. Gini Impurity</h3>
<p>Gini impurity is the default metric for the popular CART (Classification and Regression Trees) algorithm. It calculates the probability of a randomly chosen element being incorrectly labeled.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></p>
<p>Gini is often preferred in large-scale implementations because it avoids the computationally expensive <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span> calculation required by Entropy.</p>
<h2 id="selecting-the-best-split-information-gain">Selecting the Best Split: Information Gain</h2>
<p>Information Gain (IG) measures the reduction in entropy achieved by partitioning the data according to a specific feature <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">Va</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">es</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">A</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣/∣</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord">∣</span></span></span></span> is the weight of the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span>-th child node. The algorithm (ID3/C4.5) iterates through all possible features and all possible split points for each feature, choosing the one that maximizes Information Gain.</p>
<astro-island uid="Z1pMouc" prefix="r19" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\ndef calculate_entropy(y):\n  # Count occurrences of each class\n  _, counts = np.unique(y, return_counts=True)\n  probabilities = counts / len(y)\n  return -np.sum(probabilities * np.log2(probabilities))\n\n# Example: 5 positive, 5 negative samples\ny_chaos = [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]\n# Example: 9 positive, 1 negative samples\ny_pure = [1, 1, 1, 1, 1, 1, 1, 1, 1, 0]\n\nprint(f\&quot;Entropy (50/50): {calculate_entropy(y_chaos):.4f}\&quot;)\nprint(f\&quot;Entropy (90/10): {calculate_entropy(y_pure):.4f}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Entropy (50/50): 1.0000\nEntropy (90/10): 0.4690&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

def calculate_entropy(y):
  # Count occurrences of each class
  _, counts = np.unique(y, return_counts=True)
  probabilities = counts / len(y)
  return -np.sum(probabilities * np.log2(probabilities))

# Example: 5 positive, 5 negative samples
y_chaos = [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]
# Example: 9 positive, 1 negative samples
y_pure = [1, 1, 1, 1, 1, 1, 1, 1, 1, 0]

print(f&quot;Entropy (50/50): {calculate_entropy(y_chaos):.4f}&quot;)
print(f&quot;Entropy (90/10): {calculate_entropy(y_pure):.4f}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">def</span> calculate_entropy<span class="hl-bracket">(</span>y<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">  <span class="hl-comment"># Count occurrences of each class</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  _, counts <span class="hl-operator">=</span> np.unique<span class="hl-bracket">(</span>y, return_counts<span class="hl-operator">=</span>True<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">  probabilities <span class="hl-operator">=</span> counts <span class="hl-operator">/</span> <span class="hl-function">len</span><span class="hl-bracket">(</span>y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> <span class="hl-flag">-np</span>.<span class="hl-function">sum</span><span class="hl-bracket">(</span>probabilities <span class="hl-operator">*</span> np.log2<span class="hl-bracket">(</span>probabilities<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># Example: 5 positive, 5 negative samples</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">y_chaos <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-comment"># Example: 9 positive, 1 negative samples</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">y_pure <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Entropy (50/50): {calculate_entropy(y_chaos):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Entropy (90/10): {calculate_entropy(y_pure):.4f}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="recursive-induction-the-cart-algorithm">Recursive Induction: The CART Algorithm</h2>
<p>The Classification and Regression Trees (CART) algorithm builds binary trees. The process is recursive:</p>
<ol>
<li>Start at the root node.</li>
<li>For every feature, find the split point that minimizes impurity (Gini/Entropy).</li>
<li>Split the dataset into two subsets.</li>
<li>Repeat 2-3 for each subset until a “Stopping Criterion” is met.</li>
</ol>
<h3 id="stopping-criteria">Stopping Criteria</h3>
<p>Without limits, a tree will continue splitting until every leaf contains only one sample. This is perfect on the training data but disastrous on new data (Overfitting). We stop when:</p>
<ul>
<li>Maximum depth is reached.</li>
<li>The number of samples in a node falls below a threshold.</li>
<li>The impurity reduction is below a certain value.</li>
</ul>
<h2 id="the-problem-of-overfitting-and-pruning">The Problem of Overfitting and Pruning</h2>
<p>Decision trees are notorious for high variance. Because they can adapt to every tiny wiggle in the data, they often “memorize” the noise.</p>
<h3 id="pruning-strategies">Pruning Strategies</h3>
<ol>
<li><strong>Pre-pruning (Early Stopping)</strong>: Use hyperparameters like <code>max_depth</code>, <code>min_samples_split</code>, or <code>min_samples_leaf</code> to limit tree growth.</li>
<li><strong>Post-pruning (Cost Complexity Pruning)</strong>: Let the tree grow to its maximum length and then remove subtrees that do not contribute significantly to predictive accuracy (based on a validation set).</li>
</ol>
<astro-island uid="Z1R3NCd" prefix="r20" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.datasets import load_iris\nfrom sklearn.tree import DecisionTreeClassifier, export_text\nfrom sklearn.model_selection import train_test_split\n\n# Load data\niris = load_iris()\nX, y = iris.data, iris.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# Train a Tree with pre-pruning\nclf = DecisionTreeClassifier(max_depth=3, criterion=&#39;gini&#39;)\nclf.fit(X_train, y_train)\n\n# Accuracy\nprint(f\&quot;Training Accuracy: {clf.score(X_train, y_train):.4f}\&quot;)\nprint(f\&quot;Testing Accuracy: {clf.score(X_test, y_test):.4f}\&quot;)\n\n# Display the logic\nprint(\&quot;\&quot;)\nprint(\&quot;Tree Structure:\&quot;)\nprint(export_text(clf, feature_names=iris.feature_names))&quot;],&quot;output&quot;:[0,&quot;Training Accuracy: 0.9583\nTesting Accuracy: 1.0000 Tree Structure:\n|--- petal width (cm) &lt;= 0.80\n|   |--- class: 0\n|--- petal width (cm) &gt;  0.80\n|   |--- petal width (cm) &lt;= 1.75\n|   |   |--- petal length (cm) &lt;= 4.85\n|   |   |   |--- class: 1\n|   |   |--- petal length (cm) &gt;  4.85\n|   |   |   |--- class: 2&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier, export_text
from sklearn.model_selection import train_test_split

# Load data
iris = load_iris()
X, y = iris.data, iris.target
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Train a Tree with pre-pruning
clf = DecisionTreeClassifier(max_depth=3, criterion=&#x27;gini&#x27;)
clf.fit(X_train, y_train)

# Accuracy
print(f&quot;Training Accuracy: {clf.score(X_train, y_train):.4f}&quot;)
print(f&quot;Testing Accuracy: {clf.score(X_test, y_test):.4f}&quot;)

# Display the logic
print(&quot;&quot;)
print(&quot;Tree Structure:&quot;)
print(export_text(clf, feature_names=iris.feature_names))</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> load_iris</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.tree <span class="hl-keyword">import</span> DecisionTreeClassifier, export_text</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.model_selection <span class="hl-keyword">import</span> train_test_split</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Load data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">iris <span class="hl-operator">=</span> load_iris<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X, y <span class="hl-operator">=</span> iris.data, iris.target</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">X_train, X_test, y_train, y_test <span class="hl-operator">=</span> train_test_split<span class="hl-bracket">(</span>X, y, test_size<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">2</span>, random_state<span class="hl-operator">=</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-comment"># Train a Tree with pre-pruning</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">clf <span class="hl-operator">=</span> DecisionTreeClassifier<span class="hl-bracket">(</span>max_depth<span class="hl-operator">=</span><span class="hl-number">3</span>, criterion<span class="hl-operator">=</span><span class="hl-string">&#039;gini&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">clf.fit<span class="hl-bracket">(</span>X_train, y_train<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-comment"># Accuracy</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Training Accuracy: {clf.score(X_train, y_train):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Testing Accuracy: {clf.score(X_test, y_test):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-comment"># Display the logic</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Tree Structure:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>export_text<span class="hl-bracket">(</span>clf, feature_names<span class="hl-operator">=</span>iris.feature_names<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="regression-trees-predicting-numbers">Regression Trees: Predicting Numbers</h2>
<p>Contrary to classification trees, <strong>Regression Trees</strong> predict a continuous value at the leaf nodes.</p>
<ul>
<li><strong>Splitting Criterion</strong>: Instead of Entropy/Gini, it uses <strong>Mean Squared Error (MSE)</strong>. The algorithm finds a split that minimizes the sum of squared residuals in the child nodes.</li>
<li><strong>Leaf Value</strong>: The prediction at a leaf node is the <strong>average</strong> of the target values of all training samples in that leaf.</li>
</ul>
<h2 id="logic-and-interpretabilty">Logic and Interpretabilty</h2>
<p>Decision trees are “White Box” models. You can trace the exact logic used to reach a prediction. This makes them invaluable in regulated industries like finance or healthcare.</p>
<h3 id="feature-importance">Feature Importance</h3>
<p>The total reduction in Gini/Entropy contributed by a feature across all nodes where it was used tells us how important that feature is to the model.</p>
<astro-island uid="1JRrhf" prefix="r21" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;A decision tree has 100% accuracy on the training set but 55% on the test set. What hyperparameter should you likely DECREASE?&quot;],&quot;options&quot;:[1,[[0,&quot;min_samples_split&quot;],[0,&quot;learning_rate&quot;],[0,&quot;max_depth&quot;],[0,&quot;n_estimators&quot;]]],&quot;answerIndex&quot;:[0,2],&quot;explanation&quot;:[0,&quot;Decreasing the max_depth prevents the tree from creating overly specific nodes that memorize noise. This simplifies the model (reducing variance) and helps with generalization.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">A decision tree has 100% accuracy on the training set but 55% on the test set. What hyperparameter should you likely DECREASE?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">min_samples_split</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">learning_rate</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">max_depth</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">n_estimators</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="pros-and-cons">Pros and Cons</h2>





















<table><thead><tr><th style="text-align:left">Advantages</th><th style="text-align:left">Disadvantages</th></tr></thead><tbody><tr><td style="text-align:left"><strong>No Data Scaling</strong>: Doesn’t require normalization as splits are based on ordering.</td><td style="text-align:left"><strong>Instability</strong>: Small changes in data can lead to a completely different tree.</td></tr><tr><td style="text-align:left"><strong>Handles Non-linearity</strong>: Can capture complex interaction between features.</td><td style="text-align:left"><strong>Linearity</strong>: Decision trees struggled to capture purely linear relationships (they use ‘stairstep’ approximations).</td></tr><tr><td style="text-align:left"><strong>Interpretability</strong>: Easy to explain to non-technical stakeholders.</td><td style="text-align:left"><strong>Greedy</strong>: They make locally optimal splits at each node, which doesn’t guarantee a globally optimal tree.</td></tr></tbody></table>
<h2 id="conclusion">Conclusion</h2>
<p>Decision trees are the building blocks of most modern winning algorithms. While a single tree is prone to high variance, combining hundreds of trees together leads to <strong>Random Forests</strong> and <strong>Gradient Boosted Machines (XGBoost/LightGBM)</strong>, which currently dominate tabular data competitions. Understanding the core logic of a single tree is the prerequisite to mastering these ensemble methods.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Ensemble Learning: Theory and Implementation</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-ensemble-principle">The Ensemble Principle</h1>
<p>Ensemble learning is a meta-algorithmic framework that combines predictions from multiple models (base learners) to improve overall stability and performance. The fundamental hypothesis is that a collection of models will likely compensate for the individual weaknesses of its members, leading to a “wisdom of the crowd” effect.</p>
<p>Mathematically, if we have <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span> independent models each with an error rate <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span>, the probability of the majority vote being wrong follows a binomial distribution. As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord">∞</span></span></span></span>, the probability of error approaches 0. In practice, however, learners are rarely independent, as they are trained on the same or similar datasets. Therefore, ensemble methods focus on two primary objectives: reducing <strong>Variance</strong> (Bagging) and reducing <strong>Bias</strong> (Boosting).</p>
<h2 id="bias-variance-decomposition-in-ensembles">Bias-Variance Decomposition in Ensembles</h2>
<p>The expected prediction error of a model can be decomposed into:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">[(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Bias</span></span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Var</span></span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> is the irreducible noise.</p>
<ul>
<li><strong>Bagging</strong> reduces error primarily by decreasing the <strong>Variance</strong> term. By averaging multiple models trained on slightly different data, the fluctuations of individual models are smoothed out.</li>
<li><strong>Boosting</strong> reduces error primarily by decreasing the <strong>Bias</strong> term. By sequentially focusing on samples that the previous models struggled with, the ensemble gradually approximates the true target function more closely.</li>
</ul>
<h2 id="bagging-bootstrap-aggregating">Bagging (Bootstrap Aggregating)</h2>
<p>Bagging involves training multiple models in parallel on different subsets of the data.</p>
<h3 id="implementation-the-bootstrapping-process">Implementation: The Bootstrapping Process</h3>
<ol>
<li><strong>Bootstrapping</strong>: Given a dataset of size <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span>, we create <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span> new datasets of size <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> by sampling with replacement. On average, each bootstrap sample contains approximately 63.2% of the unique original data points; the remaining 36.8% are referred to as <strong>Out-of-Bag (OOB)</strong> samples, which can be used for internal validation.</li>
<li><strong>Parallel Training</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span> independent base learners (usually of the same type) are trained.</li>
<li><strong>Aggregation</strong>:
<ul>
<li>For <strong>Regression</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></li>
<li>For <strong>Classification</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">mode</span></span><span class="mopen">{</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span><span style="top:-3.2634em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.0833em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)}</span></span></span></span></li>
</ul>
</li>
</ol>
<h3 id="random-forests-feature-randomness">Random Forests: Feature Randomness</h3>
<p>A Random Forest improves upon Bagging by introducing <strong>feature randomness</strong>. When splitting a node in a decision tree, instead of searching for the best feature among all available features, it searches among a random subset of size <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> (typically <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.3369em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7031em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:0.833em"><span class="mord mathnormal">p</span></span></span><span style="top:-2.6631em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3369em"><span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> is the total number of features). This “feature bagging” ensures that the trees are highly decorrelated.</p>
<astro-island uid="1XsIsk" prefix="r22" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.tree import DecisionTreeRegressor\n\n# Generate non-linear data with noise\nnp.random.seed(42)\nX = np.sort(5 * np.random.rand(80, 1), axis=0)\ny = np.sin(X).ravel() + np.random.normal(0, 0.1, X.shape[0])\n\n# Train a single Decision Tree vs Random Forest\ntree = DecisionTreeRegressor(max_depth=5)\nrf = RandomForestRegressor(n_estimators=100, max_depth=5)\n\ntree.fit(X, y)\nrf.fit(X, y)\n\n# Predict\nX_test = np.linspace(0, 5, 500)[:, np.newaxis]\ny_tree = tree.predict(X_test)\ny_rf = rf.predict(X_test)\n\nplt.figure(figsize=(10, 6))\nplt.scatter(X, y, s=20, edgecolor=\&quot;black\&quot;, c=\&quot;darkorange\&quot;, label=\&quot;data\&quot;)\nplt.plot(X_test, y_tree, color=\&quot;cornflowerblue\&quot;, label=\&quot;Decision Tree\&quot;, linewidth=2)\nplt.plot(X_test, y_rf, color=\&quot;red\&quot;, label=\&quot;Random Forest\&quot;, linewidth=2)\nplt.xlabel(\&quot;data\&quot;)\nplt.ylabel(\&quot;target\&quot;)\nplt.title(\&quot;Decision Tree vs. Random Forest (Smoothing Effect)\&quot;)\nplt.legend()\nplt.show()\n\nprint(f\&quot;RF Variance (MSE on test): {np.mean((y_rf - np.sin(X_test).ravel())**2):.4f}\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.tree import DecisionTreeRegressor

# Generate non-linear data with noise
np.random.seed(42)
X = np.sort(5 * np.random.rand(80, 1), axis=0)
y = np.sin(X).ravel() + np.random.normal(0, 0.1, X.shape[0])

# Train a single Decision Tree vs Random Forest
tree = DecisionTreeRegressor(max_depth=5)
rf = RandomForestRegressor(n_estimators=100, max_depth=5)

tree.fit(X, y)
rf.fit(X, y)

# Predict
X_test = np.linspace(0, 5, 500)[:, np.newaxis]
y_tree = tree.predict(X_test)
y_rf = rf.predict(X_test)

plt.figure(figsize=(10, 6))
plt.scatter(X, y, s=20, edgecolor=&quot;black&quot;, c=&quot;darkorange&quot;, label=&quot;data&quot;)
plt.plot(X_test, y_tree, color=&quot;cornflowerblue&quot;, label=&quot;Decision Tree&quot;, linewidth=2)
plt.plot(X_test, y_rf, color=&quot;red&quot;, label=&quot;Random Forest&quot;, linewidth=2)
plt.xlabel(&quot;data&quot;)
plt.ylabel(&quot;target&quot;)
plt.title(&quot;Decision Tree vs. Random Forest (Smoothing Effect)&quot;)
plt.legend()
plt.show()

print(f&quot;RF Variance (MSE on test): {np.mean((y_rf - np.sin(X_test).ravel())**2):.4f}&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.ensemble <span class="hl-keyword">import</span> RandomForestRegressor</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.tree <span class="hl-keyword">import</span> DecisionTreeRegressor</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># Generate non-linear data with noise</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.sort<span class="hl-bracket">(</span><span class="hl-number">5</span> <span class="hl-operator">*</span> np.random.rand<span class="hl-bracket">(</span><span class="hl-number">80</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span>, axis<span class="hl-operator">=</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.sin<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span>.ravel<span class="hl-bracket">(</span><span class="hl-bracket">)</span> <span class="hl-operator">+</span> np.random.normal<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">0</span>.<span class="hl-number">1</span>, X.shape<span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-comment"># Train a single Decision Tree vs Random Forest</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">tree <span class="hl-operator">=</span> DecisionTreeRegressor<span class="hl-bracket">(</span>max_depth<span class="hl-operator">=</span><span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">rf <span class="hl-operator">=</span> RandomForestRegressor<span class="hl-bracket">(</span>n_estimators<span class="hl-operator">=</span><span class="hl-number">100</span>, max_depth<span class="hl-operator">=</span><span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">tree.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">rf.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-comment"># Predict</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">X_test <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">5</span>, <span class="hl-number">500</span><span class="hl-bracket">)</span><span class="hl-bracket">[</span>:, np.newaxis<span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">y_tree <span class="hl-operator">=</span> tree.predict<span class="hl-bracket">(</span>X_test<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">y_rf <span class="hl-operator">=</span> rf.predict<span class="hl-bracket">(</span>X_test<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">10</span>, <span class="hl-number">6</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">plt.scatter<span class="hl-bracket">(</span>X, y, s<span class="hl-operator">=</span><span class="hl-number">20</span>, edgecolor<span class="hl-operator">=</span><span class="hl-string">&quot;black&quot;</span>, c<span class="hl-operator">=</span><span class="hl-string">&quot;darkorange&quot;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;data&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>X_test, y_tree, color<span class="hl-operator">=</span><span class="hl-string">&quot;cornflowerblue&quot;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;Decision Tree&quot;</span>, linewidth<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>X_test, y_rf, color<span class="hl-operator">=</span><span class="hl-string">&quot;red&quot;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;Random Forest&quot;</span>, linewidth<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">plt.xlabel<span class="hl-bracket">(</span><span class="hl-string">&quot;data&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">plt.ylabel<span class="hl-bracket">(</span><span class="hl-string">&quot;target&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Decision Tree vs. Random Forest (Smoothing Effect)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">plt.legend<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;RF Variance (MSE on test): {np.mean((y_rf - np.sin(X_test).ravel())**2):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="boosting-sequential-optimization">Boosting: Sequential Optimization</h2>
<p>Boosting is a sequential method where each model <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> attempts to correct the errors of the preceding ensemble <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>.</p>
<h3 id="adaboost-adaptive-boosting">AdaBoost (Adaptive Boosting)</h3>
<p>AdaBoost focuses on sample weights. Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3217em;vertical-align:-0.2769em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> for all <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>. At each step <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span></span></span></span>:</p>
<ol>
<li>Fit a weak learner <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> to the weighted data.</li>
<li>Calculate the weighted error: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3445em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3217em;vertical-align:-0.2769em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>Compute the model weight: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8612em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span> is a learning rate.</li>
<li>Update weights: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3217em;vertical-align:-0.2769em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3217em;vertical-align:-0.2769em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)))</span></span></span></span>.</li>
</ol>
<p>The final classifier is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em"></span><span class="mord text"><span class="mord">sign</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0017em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span>.</p>
<h3 id="gradient-boosting-machines-gbm">Gradient Boosting Machines (GBM)</h3>
<p>Instead of reweighting samples, GBM treats the problem as a gradient descent in the functional space. We want to find a function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> that minimizes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>. At each step <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span></span></span></span>:</p>
<ol>
<li>Compute pseudo-residuals: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0247em;vertical-align:-0.8747em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">L</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">))</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">]</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.1747em"><span style="top:-2.0003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>Fit a weak learner <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> to the residuals <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>Update the model: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.06366em">ν</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.06366em">ν</span></span></span></span> is the shrinkage (learning rate).</li>
</ol>
<p>For regression with Mean Squared Error, the pseudo-residual is simply <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<h2 id="stacking-stacked-generalization">Stacking (Stacked Generalization)</h2>
<p>Stacking is distinct from Bagging and Boosting as it typically involves heterogeneous base learners (e.g., Logistic Regression, KNN, and SVM combined).</p>
<ol>
<li><strong>Layer 0</strong>: Train <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> different base models on the training set.</li>
<li><strong>Cross-Validation</strong>: To avoid overfitting, use K-fold cross-validation to generate “out-of-fold” predictions for the training set.</li>
<li><strong>Layer 1 (Meta-learner)</strong>: Use the predictions from Layer 0 as features to train a final model (the meta-learner) that outputs the final prediction.</li>
</ol>
<p>The meta-learner effectively learns <em>how</em> to best combine the signals from the base learners based on their specific strengths.</p>
<h2 id="comparison-of-ensemble-strategies">Comparison of Ensemble Strategies</h2>



































<table><thead><tr><th style="text-align:left">Feature</th><th style="text-align:left">Bagging (e.g., Random Forest)</th><th style="text-align:left">Boosting (e.g., XGBoost)</th><th style="text-align:left">Stacking</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Primary Goal</strong></td><td style="text-align:left">Variance Reduction</td><td style="text-align:left">Bias Reduction</td><td style="text-align:left">Improved Generalization</td></tr><tr><td style="text-align:left"><strong>Model Dependency</strong></td><td style="text-align:left">Independent (Parallel)</td><td style="text-align:left">Dependent (Sequential)</td><td style="text-align:left">Mixed</td></tr><tr><td style="text-align:left"><strong>Base Learners</strong></td><td style="text-align:left">Homogeneous (Usually Deep Trees)</td><td style="text-align:left">Homogeneous (Usually Shallow Trees)</td><td style="text-align:left">Heterogeneous</td></tr><tr><td style="text-align:left"><strong>Overfitting Risk</strong></td><td style="text-align:left">Low (Self-regularizing)</td><td style="text-align:left">High (Requires tuning)</td><td style="text-align:left">Moderate</td></tr></tbody></table>
<astro-island uid="mc4yH" prefix="r23" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.datasets import make_moons\nfrom sklearn.model_selection import train_test_split\n\nX, y = make_moons(n_samples=500, noise=0.3, random_state=42)\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)\n\n# AdaBoost with Decision Stumps\nada_clf = AdaBoostClassifier(\n  DecisionTreeClassifier(max_depth=1), n_estimators=200,\n  algorithm=\&quot;SAMME.R\&quot;, learning_rate=0.5, random_state=42\n)\nada_clf.fit(X_train, y_train)\n\nprint(f\&quot;AdaBoost Test Accuracy: {ada_clf.score(X_test, y_test):.4f}\&quot;)\n\n# Visualize step-wise weight updates (conceptual implementation)\ndef plot_decision_boundary(clf, X, y, axes):\n  x1s = np.linspace(axes[0], axes[1], 100)\n  x2s = np.linspace(axes[2], axes[3], 100)\n  x1, x2 = np.meshgrid(x1s, x2s)\n  X_new = np.c_[x1.ravel(), x2.ravel()]\n  y_pred = clf.predict(X_new).reshape(x1.shape)\n  plt.contourf(x1, x2, y_pred, alpha=0.3, cmap=plt.cm.brg)\n  plt.scatter(X[:, 0], X[:, 1], c=y, cmap=plt.cm.brg, s=10)\n\nplt.figure(figsize=(8, 4))\nplot_decision_boundary(ada_clf, X, y, [-1.5, 2.5, -1, 1.5])\nplt.title(\&quot;AdaBoost Decision Boundary (Moons Dataset)\&quot;)\nplt.show()\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.ensemble import AdaBoostClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import make_moons
from sklearn.model_selection import train_test_split

X, y = make_moons(n_samples=500, noise=0.3, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)

# AdaBoost with Decision Stumps
ada_clf = AdaBoostClassifier(
  DecisionTreeClassifier(max_depth=1), n_estimators=200,
  algorithm=&quot;SAMME.R&quot;, learning_rate=0.5, random_state=42
)
ada_clf.fit(X_train, y_train)

print(f&quot;AdaBoost Test Accuracy: {ada_clf.score(X_test, y_test):.4f}&quot;)

# Visualize step-wise weight updates (conceptual implementation)
def plot_decision_boundary(clf, X, y, axes):
  x1s = np.linspace(axes[0], axes[1], 100)
  x2s = np.linspace(axes[2], axes[3], 100)
  x1, x2 = np.meshgrid(x1s, x2s)
  X_new = np.c_[x1.ravel(), x2.ravel()]
  y_pred = clf.predict(X_new).reshape(x1.shape)
  plt.contourf(x1, x2, y_pred, alpha=0.3, cmap=plt.cm.brg)
  plt.scatter(X[:, 0], X[:, 1], c=y, cmap=plt.cm.brg, s=10)

plt.figure(figsize=(8, 4))
plot_decision_boundary(ada_clf, X, y, [-1.5, 2.5, -1, 1.5])
plt.title(&quot;AdaBoost Decision Boundary (Moons Dataset)&quot;)
plt.show()
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.ensemble <span class="hl-keyword">import</span> AdaBoostClassifier</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.tree <span class="hl-keyword">import</span> DecisionTreeClassifier</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> make_moons</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.model_selection <span class="hl-keyword">import</span> train_test_split</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">X, y <span class="hl-operator">=</span> make_moons<span class="hl-bracket">(</span>n_samples<span class="hl-operator">=</span><span class="hl-number">500</span>, noise<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">3</span>, random_state<span class="hl-operator">=</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X_train, X_test, y_train, y_test <span class="hl-operator">=</span> train_test_split<span class="hl-bracket">(</span>X, y, random_state<span class="hl-operator">=</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># AdaBoost with Decision Stumps</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">ada_clf <span class="hl-operator">=</span> AdaBoostClassifier<span class="hl-bracket">(</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">  DecisionTreeClassifier<span class="hl-bracket">(</span>max_depth<span class="hl-operator">=</span><span class="hl-number">1</span><span class="hl-bracket">)</span>, n_estimators<span class="hl-operator">=</span><span class="hl-number">200</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">  algorithm<span class="hl-operator">=</span><span class="hl-string">&quot;SAMME.R&quot;</span>, learning_rate<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">5</span>, random_state<span class="hl-operator">=</span><span class="hl-number">42</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">ada_clf.fit<span class="hl-bracket">(</span>X_train, y_train<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;AdaBoost Test Accuracy: {ada_clf.score(X_test, y_test):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-comment"># Visualize step-wise weight updates (conceptual implementation)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre"><span class="hl-keyword">def</span> plot_decision_boundary<span class="hl-bracket">(</span>clf, X, y, axes<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">  x1s <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span>axes<span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span>, axes<span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">  x2s <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span>axes<span class="hl-bracket">[</span><span class="hl-number">2</span><span class="hl-bracket">]</span>, axes<span class="hl-bracket">[</span><span class="hl-number">3</span><span class="hl-bracket">]</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">  x1, x2 <span class="hl-operator">=</span> np.meshgrid<span class="hl-bracket">(</span>x1s, x2s<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">  X_new <span class="hl-operator">=</span> np.c_<span class="hl-bracket">[</span>x1.ravel<span class="hl-bracket">(</span><span class="hl-bracket">)</span>, x2.ravel<span class="hl-bracket">(</span><span class="hl-bracket">)</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">  y_pred <span class="hl-operator">=</span> clf.predict<span class="hl-bracket">(</span>X_new<span class="hl-bracket">)</span>.reshape<span class="hl-bracket">(</span>x1.shape<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">  plt.contourf<span class="hl-bracket">(</span>x1, x2, y_pred, alpha<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">3</span>, cmap<span class="hl-operator">=</span>plt.cm.brg<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">  plt.scatter<span class="hl-bracket">(</span>X<span class="hl-bracket">[</span>:, <span class="hl-number">0</span><span class="hl-bracket">]</span>, X<span class="hl-bracket">[</span>:, <span class="hl-number">1</span><span class="hl-bracket">]</span>, c<span class="hl-operator">=</span>y, cmap<span class="hl-operator">=</span>plt.cm.brg, s<span class="hl-operator">=</span><span class="hl-number">10</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">8</span>, <span class="hl-number">4</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">plot_decision_boundary<span class="hl-bracket">(</span>ada_clf, X, y, <span class="hl-bracket">[</span><span class="hl-flag">-1</span>.<span class="hl-number">5</span>, <span class="hl-number">2</span>.<span class="hl-number">5</span>, <span class="hl-flag">-1</span>, <span class="hl-number">1</span>.<span class="hl-number">5</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;AdaBoost Decision Boundary (Moons Dataset)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<astro-island uid="Z2nb7pe" prefix="r24" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;In Gradient Boosting, what is the role of the &#39;learning rate&#39; (shrinkage) parameter?&quot;],&quot;options&quot;:[1,[[0,&quot;It determines how many trees are added to the ensemble.&quot;],[0,&quot;It scales the contribution of each new tree to prevent overfitting and ensure gradual optimization.&quot;],[0,&quot;It controls the maximum depth of the individual decision trees.&quot;],[0,&quot;It defines the ratio of features used in each split.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;By scaling each tree&#39;s contribution (usually by a small value like 0.01 or 0.1), the model is forced to learn slowly and rely on the collective sum of many trees, which significantly improves generalization and reduces the risk of overshooting the minimum of the loss function.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">In Gradient Boosting, what is the role of the &#x27;learning rate&#x27; (shrinkage) parameter?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It determines how many trees are added to the ensemble.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It scales the contribution of each new tree to prevent overfitting and ensure gradual optimization.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It controls the maximum depth of the individual decision trees.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It defines the ratio of features used in each split.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="advanced-concept-out-of-bag-oob-estimation">Advanced Concept: Out-of-Bag (OOB) Estimation</h2>
<p>In Bagging, since each tree is trained on a bootstrap sample, approximately 37% of the data is never seen by that specific tree. We can use this “unseen” data to estimate the generalization error of the ensemble without a separate validation set. For each observation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, we average the predictions of only those trees where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> was in the OOB set. The resulting OOB score is a reliable proxy for test accuracy.</p>
<h2 id="summary-checklist">Summary Checklist</h2>
<ul>
<li><strong>Use Bagging</strong> when you have a high-variance, complex model (like deep decision trees) and want to make it robust.</li>
<li><strong>Use Boosting</strong> when you have high-bias models or want to squeeze the maximum possible performance out of a dataset by learning from errors.</li>
<li><strong>Use Stacking</strong> when you have diverse models that capture different patterns in the data and a clear meta-logic for combining them.</li>
</ul> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Gradient Boosting Machines: XGBoost and Advanced Systems</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="from-boosting-to-gradient-boosting">From Boosting to Gradient Boosting</h1>
<p>Gradient Boosting is a powerful ensemble technique that builds models sequentially, with each new model attempting to minimize the loss of the previous ensemble. While AdaBoost uses weighted data points to focus on errors, Gradient Boosting (GBM) generalizes this by using the <strong>gradient</strong> of the loss function.</p>
<h2 id="the-gbm-algorithm-functional-gradient-descent">The GBM Algorithm: Functional Gradient Descent</h2>
<p>Given a differentiable loss function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>, the goal is to find a function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> that minimizes the expected loss. We approximate <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> as an additive expansion of base learners:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.06366em">ν</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></p>
<p>Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.06366em">ν</span></span></span></span> is the learning rate (shrinkage). At each step <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span></span></span></span>, we perform the following:</p>
<ol>
<li><strong>Compute Pseudo-Residuals</strong>: Calculate the negative gradient of the loss function relative to the current ensemble’s predictions:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0247em;vertical-align:-0.8747em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">L</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">))</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">]</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.1747em"><span style="top:-2.0003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>Fit Base Learner</strong>: Train a weak learner <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> (usually a regression tree) to predict these pseudo-residuals <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>.</li>
<li><strong>Step Length Optimization</strong>: Find the optimal scale <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> to minimize the loss:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ρ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ρ</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></li>
<li><strong>Update Ensemble</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.06366em">ν</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>.</li>
</ol>
<p>For Mean Squared Error <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>, the negative gradient is exactly the <strong>residual</strong> (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>). However, GBM allows for any differentiable loss, such as Huber loss for robustness or Log-Loss for classification.</p>
<h2 id="the-xgboost-evolution">The XGBoost Evolution</h2>
<p>XGBoost (Extreme Gradient Boosting) introduced several key innovations that solved the scalability and overfitting issues inherent in traditional GBM.</p>
<h3 id="1-second-order-taylor-approximation">1. Second-Order Taylor Approximation</h3>
<p>While standard GBM uses a first-order approximation, XGBoost uses a <strong>second-order Taylor expansion</strong> of the loss function. This utilizes both the <strong>Gradient (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>)</strong> and the <strong>Hessian (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>)</strong>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3445em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>This provides more information about the curvature of the loss surface, significantly speeding up convergence.</p>
<h3 id="2-regularized-objective">2. Regularized Objective</h3>
<p>XGBoost adds a penalty term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Ω</span></span></span></span> to the objective function to control model complexity:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.417em;vertical-align:-0.4358em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4413em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span> is the number of leaves in the tree.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> are the leaf weights.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span> are regularization parameters.</li>
</ul>
<h3 id="3-split-finding-algorithms">3. Split Finding Algorithms</h3>
<p>To handle large datasets, XGBoost implements a <strong>Weighted Quantile Sketch</strong> algorithm. Instead of trying all possible split points (which is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span>), it uses a histogram-based approach to find candidate splits, balancing efficiency and accuracy.</p>
<astro-island uid="1lUChP" prefix="r25" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.metrics import mean_squared_error\n\n# Create a complex periodic signal with noise\nnp.random.seed(42)\nX = np.linspace(0, 10, 100).reshape(-1, 1)\ny = np.sin(X).ravel() + np.cos(2*X).ravel() + np.random.normal(0, 0.2, 100)\n\n# Compare GBM with different learning rates\ngbm_slow = GradientBoostingRegressor(n_estimators=200, learning_rate=0.05, max_depth=3)\ngbm_fast = GradientBoostingRegressor(n_estimators=200, learning_rate=0.5, max_depth=3)\n\ngbm_slow.fit(X, y)\ngbm_fast.fit(X, y)\n\nX_test = np.linspace(0, 10, 500).reshape(-1, 1)\ny_slow = gbm_slow.predict(X_test)\ny_fast = gbm_fast.predict(X_test)\n\nplt.figure(figsize=(10, 5))\nplt.scatter(X, y, color=&#39;black&#39;, s=10, label=\&quot;Data\&quot;)\nplt.plot(X_test, y_slow, &#39;r-&#39;, label=\&quot;LR=0.05 (Smoother)\&quot;)\nplt.plot(X_test, y_fast, &#39;b--&#39;, label=\&quot;LR=0.5 (Noisy/Overfit)\&quot;)\nplt.title(\&quot;Effect of Learning Rate in Gradient Boosting\&quot;)\nplt.legend()\nplt.show()\n\nprint(f\&quot;Slow GBM MSE: {mean_squared_error(y, gbm_slow.predict(X)):.4f}\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import GradientBoostingRegressor
from sklearn.metrics import mean_squared_error

# Create a complex periodic signal with noise
np.random.seed(42)
X = np.linspace(0, 10, 100).reshape(-1, 1)
y = np.sin(X).ravel() + np.cos(2*X).ravel() + np.random.normal(0, 0.2, 100)

# Compare GBM with different learning rates
gbm_slow = GradientBoostingRegressor(n_estimators=200, learning_rate=0.05, max_depth=3)
gbm_fast = GradientBoostingRegressor(n_estimators=200, learning_rate=0.5, max_depth=3)

gbm_slow.fit(X, y)
gbm_fast.fit(X, y)

X_test = np.linspace(0, 10, 500).reshape(-1, 1)
y_slow = gbm_slow.predict(X_test)
y_fast = gbm_fast.predict(X_test)

plt.figure(figsize=(10, 5))
plt.scatter(X, y, color=&#x27;black&#x27;, s=10, label=&quot;Data&quot;)
plt.plot(X_test, y_slow, &#x27;r-&#x27;, label=&quot;LR=0.05 (Smoother)&quot;)
plt.plot(X_test, y_fast, &#x27;b--&#x27;, label=&quot;LR=0.5 (Noisy/Overfit)&quot;)
plt.title(&quot;Effect of Learning Rate in Gradient Boosting&quot;)
plt.legend()
plt.show()

print(f&quot;Slow GBM MSE: {mean_squared_error(y, gbm_slow.predict(X)):.4f}&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.ensemble <span class="hl-keyword">import</span> GradientBoostingRegressor</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.metrics <span class="hl-keyword">import</span> mean_squared_error</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># Create a complex periodic signal with noise</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">10</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span>.reshape<span class="hl-bracket">(</span><span class="hl-flag">-1</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.sin<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span>.ravel<span class="hl-bracket">(</span><span class="hl-bracket">)</span> <span class="hl-operator">+</span> np.cos<span class="hl-bracket">(</span><span class="hl-number">2</span><span class="hl-operator">*</span>X<span class="hl-bracket">)</span>.ravel<span class="hl-bracket">(</span><span class="hl-bracket">)</span> <span class="hl-operator">+</span> np.random.normal<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">0</span>.<span class="hl-number">2</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-comment"># Compare GBM with different learning rates</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">gbm_slow <span class="hl-operator">=</span> GradientBoostingRegressor<span class="hl-bracket">(</span>n_estimators<span class="hl-operator">=</span><span class="hl-number">200</span>, learning_rate<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">05</span>, max_depth<span class="hl-operator">=</span><span class="hl-number">3</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">gbm_fast <span class="hl-operator">=</span> GradientBoostingRegressor<span class="hl-bracket">(</span>n_estimators<span class="hl-operator">=</span><span class="hl-number">200</span>, learning_rate<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">5</span>, max_depth<span class="hl-operator">=</span><span class="hl-number">3</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">gbm_slow.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">gbm_fast.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">X_test <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">10</span>, <span class="hl-number">500</span><span class="hl-bracket">)</span>.reshape<span class="hl-bracket">(</span><span class="hl-flag">-1</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">y_slow <span class="hl-operator">=</span> gbm_slow.predict<span class="hl-bracket">(</span>X_test<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">y_fast <span class="hl-operator">=</span> gbm_fast.predict<span class="hl-bracket">(</span>X_test<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">10</span>, <span class="hl-number">5</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">plt.scatter<span class="hl-bracket">(</span>X, y, color<span class="hl-operator">=</span><span class="hl-string">&#039;black&#039;</span>, s<span class="hl-operator">=</span><span class="hl-number">10</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;Data&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>X_test, y_slow, <span class="hl-string">&#039;r-&#039;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;LR=0.05 (Smoother)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>X_test, y_fast, <span class="hl-string">&#039;b--&#039;</span>, label<span class="hl-operator">=</span><span class="hl-string">&quot;LR=0.5 (Noisy/Overfit)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Effect of Learning Rate in Gradient Boosting&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">plt.legend<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Slow GBM MSE: {mean_squared_error(y, gbm_slow.predict(X)):.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="system-level-optimization">System-Level Optimization</h2>
<p>Beyond mathematics, XGBoost and its successors (LightGBM, CatBoost) focus on computer architecture:</p>
<ul>
<li><strong>Column Block for Parallel Learning</strong>: Features are sorted and stored in in-memory blocks, allowing split-finding to be parallelized.</li>
<li><strong>Cache-Aware Access</strong>: Uses internal buffers to store gradients and hessians, minimizing CPU cache misses.</li>
<li><strong>Sparsity Awareness</strong>: Automatically learns the best “default” direction for missing values by trying both paths during training and choosing the one that minimizes loss.</li>
</ul>
<h2 id="the-modern-ecosystem-lightgbm-and-catboost">The Modern Ecosystem: LightGBM and CatBoost</h2>
<h3 id="lightgbm-light-gradient-boosting-machine">LightGBM (Light Gradient Boosting Machine)</h3>
<p>Developed by Microsoft, LightGBM introduces:</p>
<ul>
<li><strong>GOSS (Gradient-based One-Side Sampling)</strong>: Keeps all instances with large gradients and performs random sampling on instances with small gradients. Since small gradients imply the model is already well-trained on those points, this reduces data size without losing significant information.</li>
<li><strong>EFB (Exclusive Feature Bundling)</strong>: Bundles many sparse, mutually exclusive features (like one-hot encoded variables) into a single feature, reducing the number of dimensions.</li>
</ul>
<h3 id="catboost-categorical-boosting">CatBoost (Categorical Boosting)</h3>
<p>Developed by Yandex, CatBoost excels at:</p>
<ul>
<li><strong>Ordered Boosting</strong>: A modification of the boosting algorithm to prevent a type of target leakage called “prediction shift” that occurs in standard GBMs.</li>
<li><strong>Native Categorical Support</strong>: Uses “Symmetric Trees” and advanced encoding techniques to handle categorical data directly without preprocessing like one-hot encoding.</li>
</ul>
<astro-island uid="su92k" prefix="r26" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why does XGBoost use the Hessian (second-order derivative) in its optimization step?&quot;],&quot;options&quot;:[1,[[0,&quot;To handle categorical variables more effectively.&quot;],[0,&quot;To provide a more accurate adjustment to the leaf weights by accounting for the loss function&#39;s curvature.&quot;],[0,&quot;To ensure the model only uses linear decision boundaries.&quot;],[0,&quot;To calculate the out-of-bag error automatically.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;By incorporating the second-order derivative (Hessian), XGBoost essentially implements a Newton-Raphson optimization step rather than simple gradient descent. This allows it to take larger, more accurate steps toward the minimum and improves numerical stability.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why does XGBoost use the Hessian (second-order derivative) in its optimization step?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To handle categorical variables more effectively.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To provide a more accurate adjustment to the leaf weights by accounting for the loss function&#x27;s curvature.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To ensure the model only uses linear decision boundaries.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To calculate the out-of-bag error automatically.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="practical-tips-for-tuning-gbms">Practical Tips for Tuning GBMs</h2>
<ol>
<li><strong>Number of Trees vs. Learning Rate</strong>: These are inversely related. Always use a small learning rate (e.g., 0.01) and use <strong>Early Stopping</strong> to determine the optimal number of trees based on a validation set.</li>
<li><strong>Subsampling</strong>: Using a fraction of the data (e.g., <code>subsample=0.8</code>) and a fraction of the features (<code>colsample_bytree</code>) adds stochasticity and reduces overfitting, similar to Random Forests.</li>
<li><strong>Tree Depth</strong>: Boosting trees are usually shallow (depth 3–8). Since they build upon each other, they don’t need the individual complexity that Random Forest trees require.</li>
</ol>
<h2 id="comparison-table">Comparison Table</h2>



































<table><thead><tr><th style="text-align:left">Feature</th><th style="text-align:left">XGBoost</th><th style="text-align:left">LightGBM</th><th style="text-align:left">CatBoost</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Tree Growth</strong></td><td style="text-align:left">Level-wise</td><td style="text-align:left">Leaf-wise</td><td style="text-align:left">Symmetric</td></tr><tr><td style="text-align:left"><strong>Categorical</strong></td><td style="text-align:left">Manual (needs encoding)</td><td style="text-align:left">Built-in (optimized)</td><td style="text-align:left">Built-in (best-in-class)</td></tr><tr><td style="text-align:left"><strong>Speed</strong></td><td style="text-align:left">Fast</td><td style="text-align:left">Very Fast</td><td style="text-align:left">Fast</td></tr><tr><td style="text-align:left"><strong>Small Data</strong></td><td style="text-align:left">Strong</td><td style="text-align:left">Risky (overfits)</td><td style="text-align:left">Very Strong</td></tr></tbody></table>
<h2 id="summary">Summary</h2>
<p>Gradient Boosting Systems represent the pinnacle of machine learning for structured/tabular data. While Neural Networks dominate unstructured data like images and text, the architectural optimizations and mathematical rigor of XGBoost, LightGBM, and CatBoost make them the preferred choice for most enterprise and competitive data science tasks.</p> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Unsupervised</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Principal Component Analysis: Dimensionality Reduction</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="dimensionality-and-latent-structure">Dimensionality and Latent Structure</h1>
<p>In many real-world datasets, features are not truly independent. For example, in house price prediction, “Square Footage” and “Number of Rooms” are highly correlated. Principal Component Analysis (PCA) is a mathematical technique that transforms a coordinate system of correlated features into a new system of uncorrelated variables called <strong>Principal Components</strong>.</p>
<p>The goal of PCA is twofold:</p>
<ol>
<li><strong>Compress Data</strong>: Reduce the number of features (dimensionality) while preserving as much Information (variance) as possible.</li>
<li><strong>Visualize Data</strong>: Project high-dimensional data onto 2 or 3 dimensions to identify patterns or clusters.</li>
</ol>
<h2 id="the-geometric-intuition-variance-as-information">The Geometric Intuition: Variance as Information</h2>
<p>Imagine a 2D cloud of data shaped like an elongated oval.</p>
<ul>
<li>The direction along the length of the oval captures the most variation. This is the <strong>First Principal Component (PC1)</strong>.</li>
<li>The direction along the width (perpendicular to PC1) captures the next most variation. This is the <strong>Second Principal Component (PC2)</strong>.</li>
</ul>
<p>By projecting all data points onto PC1, we reduce 2D data to 1D. If the oval is very thin, we lose very little information; if the oval is nearly a circle, we lose half the information.</p>
<h2 id="the-algorithmic-flow">The Algorithmic Flow</h2>
<p>The mathematical engine of PCA relies on Linear Algebra—specifically, Eigen-decomposition or Singular Value Decomposition (SVD).</p>
<h3 id="1-standardization-leveling-the-playing-field">1. Standardization: Leveling the Playing Field</h3>
<p>PCA is extremely sensitive to the scale of the data. If one feature (e.g., Salary) ranges from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span></span></span></span> and another (e.g., Age) ranges from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span></span></span></span>, the variance of Salary will be millions of times larger than Age. PCA will “think” Salary is the only thing that matters.</p>
<p>We must transform every feature to have a <strong>mean of 0 and a standard deviation of 1</strong>.</p>
<h3 id="2-covariance-matrix-calculation">2. Covariance Matrix Calculation</h3>
<p>We calculate the covariance matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span></span></span></span>, which captures how every pair of features varies together:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></p>
<h3 id="3-finding-the-principal-directions">3. Finding the Principal Directions</h3>
<p>We find the <strong>Eigenvectors</strong> and <strong>Eigenvalues</strong> of the covariance matrix:</p>
<ul>
<li><strong>Eigenvectors</strong>: The directions (axes) of the new feature space.</li>
<li><strong>Eigenvalues</strong>: The “amount of variance” captured by each eigenvector.</li>
</ul>
<h3 id="4-projection">4. Projection</h3>
<p>To reduce the data from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> dimensions to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> dimensions, we select the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> eigenvectors with the largest eigenvalues. We multiply our original data by these vectors to get our “Compressed” data.</p>
<astro-island uid="2vqBHO" prefix="r27" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.decomposition import PCA\nfrom sklearn.preprocessing import StandardScaler\n\n# Generate correlated data\nnp.random.seed(42)\nX = np.dot(np.random.rand(100, 2), np.array([[1, 2], [2, 1]]))\n\n# 1. Standardize\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\n\n# 2. Apply PCA\npca = PCA(n_components=2)\nX_pca = pca.fit_transform(X_scaled)\n\nprint(f\&quot;Explained Variance Ratio: {pca.explained_variance_ratio_}\&quot;)\nprint(f\&quot;Sum of variance (First component): {pca.explained_variance_ratio_[0]*100:.2f}%\&quot;)&quot;],&quot;output&quot;:[0,&quot;Explained Variance Ratio: [0.96... 0.03...]\nSum of variance (First component): 96.50%&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.decomposition import PCA
from sklearn.preprocessing import StandardScaler

# Generate correlated data
np.random.seed(42)
X = np.dot(np.random.rand(100, 2), np.array([[1, 2], [2, 1]]))

# 1. Standardize
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# 2. Apply PCA
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X_scaled)

print(f&quot;Explained Variance Ratio: {pca.explained_variance_ratio_}&quot;)
print(f&quot;Sum of variance (First component): {pca.explained_variance_ratio_[0]*100:.2f}%&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.decomposition <span class="hl-keyword">import</span> PCA</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.preprocessing <span class="hl-keyword">import</span> StandardScaler</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Generate correlated data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>np.random.rand<span class="hl-bracket">(</span><span class="hl-number">100</span>, <span class="hl-number">2</span><span class="hl-bracket">)</span>, np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">2</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">2</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># 1. Standardize</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">scaler <span class="hl-operator">=</span> StandardScaler<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">X_scaled <span class="hl-operator">=</span> scaler.fit_transform<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-comment"># 2. Apply PCA</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">pca <span class="hl-operator">=</span> PCA<span class="hl-bracket">(</span>n_components<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">X_pca <span class="hl-operator">=</span> pca.fit_transform<span class="hl-bracket">(</span>X_scaled<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Explained Variance Ratio: {pca.explained_variance_ratio_}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Sum of variance (First component): {pca.explained_variance_ratio_[0]*100:.2f}%&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="how-much-information-is-enough">How much information is enough?</h2>
<p>One doesn’t just “guess” the number of components. We look at the <strong>Cumulative Explained Variance</strong>. We plot the number of components on the x-axis and the total variance explained on the y-axis.</p>
<p>Common cut-offs:</p>
<ul>
<li><strong>95% Variance</strong>: Often used for noise reduction and speeding up algorithms.</li>
<li><strong>2 or 3 Components</strong>: Used strictly for visualization.</li>
</ul>
<astro-island uid="Z1KCL5o" prefix="r28" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.decomposition import PCA\nfrom sklearn.datasets import load_digits\nimport matplotlib.pyplot as plt\n\ndigits = load_digits()\nX = digits.data # 64 features (8x8 pixels)\n\npca = PCA().fit(X)\ncumulative_variance = np.cumsum(pca.explained_variance_ratio_)\n\n# At what component do we hit 90%?\nn_90 = np.argmax(cumulative_variance &gt;= 0.90) + 1\nprint(f\&quot;Dimensions required for 90% variance: {n_90} (out of 64)\&quot;)&quot;],&quot;output&quot;:[0,&quot;Dimensions required for 90% variance: 21 (out of 64)&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.decomposition import PCA
from sklearn.datasets import load_digits
import matplotlib.pyplot as plt

digits = load_digits()
X = digits.data # 64 features (8x8 pixels)

pca = PCA().fit(X)
cumulative_variance = np.cumsum(pca.explained_variance_ratio_)

# At what component do we hit 90%?
n_90 = np.argmax(cumulative_variance &gt;= 0.90) + 1
print(f&quot;Dimensions required for 90% variance: {n_90} (out of 64)&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.decomposition <span class="hl-keyword">import</span> PCA</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> load_digits</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">digits <span class="hl-operator">=</span> load_digits<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X <span class="hl-operator">=</span> digits.data <span class="hl-comment"># 64 features (8x8 pixels)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">pca <span class="hl-operator">=</span> PCA<span class="hl-bracket">(</span><span class="hl-bracket">)</span>.fit<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">cumulative_variance <span class="hl-operator">=</span> np.cumsum<span class="hl-bracket">(</span>pca.explained_variance_ratio_<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-comment"># At what component do we hit 90%?</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">n_90 <span class="hl-operator">=</span> np.argmax<span class="hl-bracket">(</span>cumulative_variance <span class="hl-operator">&gt;=</span> <span class="hl-number">0</span>.<span class="hl-number">90</span><span class="hl-bracket">)</span> <span class="hl-operator">+</span> <span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Dimensions required for 90% variance: {n_90} (out of 64)&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="use-case-noise-filtering">Use Case: Noise Filtering</h2>
<p>Because PCA captures the “signal” (the directions along which the data varies the most) and discards the “noise” (directions with tiny variations), it is a powerful pre-processing tool.</p>
<p>By projecting data to a lower subspace and then projecting it <em>back</em> to original space (Inverse Transform), you reconstruct a “cleaned” version of the original data.</p>
<astro-island uid="1v8mx0" prefix="r29" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.decomposition import PCA\nfrom sklearn.datasets import load_digits\n\ndigits = load_digits()\nX = digits.data\n\n# Conceptual Noise Filtering\nX_noisy = X + np.random.normal(0, 2.0, X.shape)\npca = PCA(0.50) # Keep 50% of components\nX_transformed = pca.fit_transform(X_noisy)\nX_denoised = pca.inverse_transform(X_transformed)\n\nprint(f\&quot;Original shape: {X.shape}\&quot;)\nprint(f\&quot;Reduced shape: {X_transformed.shape}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Original shape: (1797, 64)\nReduced shape: (1797, 5)&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.decomposition import PCA
from sklearn.datasets import load_digits

digits = load_digits()
X = digits.data

# Conceptual Noise Filtering
X_noisy = X + np.random.normal(0, 2.0, X.shape)
pca = PCA(0.50) # Keep 50% of components
X_transformed = pca.fit_transform(X_noisy)
X_denoised = pca.inverse_transform(X_transformed)

print(f&quot;Original shape: {X.shape}&quot;)
print(f&quot;Reduced shape: {X_transformed.shape}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.decomposition <span class="hl-keyword">import</span> PCA</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> load_digits</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">digits <span class="hl-operator">=</span> load_digits<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">X <span class="hl-operator">=</span> digits.data</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre"><span class="hl-comment"># Conceptual Noise Filtering</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">X_noisy <span class="hl-operator">=</span> X <span class="hl-operator">+</span> np.random.normal<span class="hl-bracket">(</span><span class="hl-number">0</span>, <span class="hl-number">2</span>.<span class="hl-number">0</span>, X.shape<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">pca <span class="hl-operator">=</span> PCA<span class="hl-bracket">(</span><span class="hl-number">0</span>.<span class="hl-number">50</span><span class="hl-bracket">)</span> <span class="hl-comment"># Keep 50% of components</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">X_transformed <span class="hl-operator">=</span> pca.fit_transform<span class="hl-bracket">(</span>X_noisy<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">X_denoised <span class="hl-operator">=</span> pca.inverse_transform<span class="hl-bracket">(</span>X_transformed<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Original shape: {X.shape}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Reduced shape: {X_transformed.shape}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="pca-for-visualization">PCA for Visualization</h2>
<p>When dealing with thousands of features (like gene sequences or pixel data), PCA allows us to see the “big picture”. Clusters that are invisible in 1,000-dimensional space often emerge clearly when projected onto the first two principal components.</p>
<astro-island uid="Z2ei0Xu" prefix="r30" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;If the first Principal Component explains 99% of the variance in a 100-feature dataset, what does this tell you about the data?&quot;],&quot;options&quot;:[1,[[0,&quot;The data is essentially 1-dimensional and the 100 features are highly correlated.&quot;],[0,&quot;The data is very noisy and PCA failed.&quot;],[0,&quot;You need more data to find other patterns.&quot;],[0,&quot;The 100 features are all independent.&quot;]]],&quot;answerIndex&quot;:[0,0],&quot;explanation&quot;:[0,&quot;When one component captures almost all variance, it means most of the features vary in synchronization. They are mathematically redundant, and the intrinsic dimensionality of the data is much lower than its representation.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">If the first Principal Component explains 99% of the variance in a 100-feature dataset, what does this tell you about the data?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The data is essentially 1-dimensional and the 100 features are highly correlated.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The data is very noisy and PCA failed.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">You need more data to find other patterns.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The 100 features are all independent.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="limitations-of-pca">Limitations of PCA</h2>
<h3 id="1-orthogonality-constraint">1. Orthogonality Constraint</h3>
<p>PCA forces components to be perpendicular (orthogonal) to each other. In some datasets, the true latent features might not be orthogonal.</p>
<h3 id="2-linearity">2. Linearity</h3>
<p>PCA is a <strong>linear</strong> projection. It cannot unroll a dataset that has a non-linear topology (like a “Swiss Roll” or the Moon dataset). For these cases, <strong>Kernel PCA</strong> or <strong>t-SNE</strong> (t-Distributed Stochastic Neighbor Embedding) is required.</p>
<h3 id="3-interpretability">3. Interpretability</h3>
<p>The resulting components are linear combinations of the original features. Identifying exactly what “Principal Component 1” represents in real-world terms (e.g., “Is it age? Is it income?”) can be very difficult.</p>
<h2 id="conclusion">Conclusion</h2>
<p>PCA is the master of data compression. By discarding redundancy and focusing on the axes of maximum variation, it simplifies complex datasets, accelerates training times, and reveals the hidden geometric skeletons within high-dimensional clouds. It is the essential first step in any unsupervised exploratory analysis.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Clustering: Discovering Latent Groups</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="finding-structure-in-unlabeled-data">Finding Structure in Unlabeled Data</h1>
<p>Clustering is an unsupervised learning task where the objective is to partition a dataset into groups (clusters) such that data points within a group are more similar to each other than to those in other groups. This is a journey of discovery: we don’t have target labels to guide the model; instead, the model must uncover the underlying geometry of the feature space.</p>
<h2 id="the-taxonomy-of-clustering-algorithms">The Taxonomy of Clustering Algorithms</h2>
<p>Clustering approaches are generally divided by their logic:</p>
<ol>
<li><strong>Centroid-based</strong>: Groups points around a central mean or medoid (e.g., K-Means).</li>
<li><strong>Density-based</strong>: Connects points in regions of high point density (e.g., DBSCAN).</li>
<li><strong>Distribution-based</strong>: Assumes data is generated from a mixture of statistical distributions (e.g., Gaussian Mixture Models).</li>
<li><strong>Connectivity-based</strong>: Builds a hierarchy of nested clusters (e.g., Hierarchical Clustering).</li>
</ol>
<h2 id="k-means-the-centroid-archetype">K-Means: The Centroid Archetype</h2>
<p>K-Means is the most ubiquitous clustering algorithm due to its efficiency and simplicity. It is an iterative algorithm that seeks to minimize the distance between points and their respective cluster centers.</p>
<h3 id="the-algorithm-lloyds-method">The Algorithm: Lloyd’s Method</h3>
<ol>
<li><strong>Initialize</strong>: Randomly choose <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> points to be the initial centroids.</li>
<li><strong>Assignment Step</strong>: Assign each data point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> to the nearest centroid <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> based on Euclidean distance:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1741em;vertical-align:-0.2861em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li>
<li><strong>Update Step</strong>: Calculate the new centroids by taking the mean of all points assigned to that cluster:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4303em;vertical-align:-0.5423em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li><strong>Convergence</strong>: Repeat until centroids stop shifting or a maximum number of iterations is reached.</li>
</ol>
<h3 id="objective-function-inertia">Objective Function: Inertia</h3>
<p>K-Means minimizes the <strong>Within-Cluster Sum of Squares (WCSS)</strong>, also known as Inertia:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4783em;vertical-align:-0.497em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="challenges-and-solutions">Challenges and Solutions</h3>
<ul>
<li><strong>Standardization</strong>: Since K-Means relies on Euclidean distance, features with larger scales will dominate. <strong>Always scale your data.</strong></li>
<li><strong>Local Minima</strong>: K-Means is sensitive to the initial placement of centroids. The <strong>K-Means++</strong> initialization algorithm improves this by spreading initial centroids far apart.</li>
<li><strong>Specifying K</strong>: How do we know how many clusters exist?
<ul>
<li><strong>The Elbow Method</strong>: Plot WCSS vs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> and look for the “elbow” where the rate of improvement drops.</li>
<li><strong>Silhouette Analysis</strong>: Measures how close each point in one cluster is to points in the neighboring clusters.</li>
</ul>
</li>
</ul>
<astro-island uid="6ljTM" prefix="r31" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\nfrom sklearn.datasets import make_blobs\n\n# Create synthetic data\nX, _ = make_blobs(n_samples=300, centers=4, cluster_std=0.60, random_state=0)\n\n# Implementation\nkmeans = KMeans(n_clusters=4, init=&#39;k-means++&#39;, max_iter=300)\nkmeans.fit(X)\n\nprint(\&quot;Final Centroids:\&quot;)\nprint(kmeans.cluster_centers_)\nprint(f\&quot;Total Inertia (WCSS): {kmeans.inertia_:.2f}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Final Centroids:\n[[...]]\nTotal Inertia (WCSS): ...&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.datasets import make_blobs

# Create synthetic data
X, _ = make_blobs(n_samples=300, centers=4, cluster_std=0.60, random_state=0)

# Implementation
kmeans = KMeans(n_clusters=4, init=&#x27;k-means++&#x27;, max_iter=300)
kmeans.fit(X)

print(&quot;Final Centroids:&quot;)
print(kmeans.cluster_centers_)
print(f&quot;Total Inertia (WCSS): {kmeans.inertia_:.2f}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.cluster <span class="hl-keyword">import</span> KMeans</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> make_blobs</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># Create synthetic data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">X, _ <span class="hl-operator">=</span> make_blobs<span class="hl-bracket">(</span>n_samples<span class="hl-operator">=</span><span class="hl-number">300</span>, centers<span class="hl-operator">=</span><span class="hl-number">4</span>, cluster_std<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">60</span>, random_state<span class="hl-operator">=</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># Implementation</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">kmeans <span class="hl-operator">=</span> KMeans<span class="hl-bracket">(</span>n_clusters<span class="hl-operator">=</span><span class="hl-number">4</span>, <span class="hl-function">init</span><span class="hl-operator">=</span><span class="hl-string">&#039;k-means++&#039;</span>, max_iter<span class="hl-operator">=</span><span class="hl-number">300</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">kmeans.fit<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Final Centroids:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>kmeans.cluster_centers_<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Total Inertia (WCSS): {kmeans.inertia_:.2f}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="dbscan-clustering-by-density">DBSCAN: Clustering by Density</h2>
<p>K-Means fails miserably when clusters have non-spherical shapes (like crescents or rings) or when the data contains many outliers. <strong>DBSCAN</strong> (Density-Based Spatial Clustering of Applications with Noise) solves this by focusing on point density.</p>
<h3 id="logic">Logic</h3>
<ol>
<li>A point is a <strong>Core Point</strong> if it has at least <code>MinPts</code> neighbors within a radius of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span> (Epsilon).</li>
<li>A point is a <strong>Border Point</strong> if it is not a Core point but is reachable from a Core point.</li>
<li>Everything else is <strong>Noise</strong>.</li>
</ol>
<h3 id="why-use-dbscan">Why use DBSCAN?</h3>
<ul>
<li><strong>Arbitrary Shapes</strong>: It can find clusters that snake through the feature space.</li>
<li><strong>Outlier Detection</strong>: It explicitly identifies points that don’t belong to any cluster as -1 (Noise).</li>
<li><strong>Number of Clusters</strong>: It discovers the number of clusters automatically.</li>
</ul>
<astro-island uid="Z1dDfmV" prefix="r32" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.cluster import DBSCAN\nfrom sklearn.datasets import make_moons\n\nX, _ = make_moons(n_samples=200, noise=0.05, random_state=0)\n\n# K-Means would fail here\n# DBSCAN captures the moon shapes\ndbscan = DBSCAN(eps=0.3, min_samples=5)\nclusters = dbscan.fit_predict(X)\n\nprint(f\&quot;Number of clusters found: {len(set(clusters)) - (1 if -1 in clusters else 0)}\&quot;)\nprint(f\&quot;Number of noise points: {list(clusters).count(-1)}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Number of clusters found: 2\nNumber of noise points: 0&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.cluster import DBSCAN
from sklearn.datasets import make_moons

X, _ = make_moons(n_samples=200, noise=0.05, random_state=0)

# K-Means would fail here
# DBSCAN captures the moon shapes
dbscan = DBSCAN(eps=0.3, min_samples=5)
clusters = dbscan.fit_predict(X)

print(f&quot;Number of clusters found: {len(set(clusters)) - (1 if -1 in clusters else 0)}&quot;)
print(f&quot;Number of noise points: {list(clusters).count(-1)}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.cluster <span class="hl-keyword">import</span> DBSCAN</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> make_moons</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">X, _ <span class="hl-operator">=</span> make_moons<span class="hl-bracket">(</span>n_samples<span class="hl-operator">=</span><span class="hl-number">200</span>, noise<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">05</span>, random_state<span class="hl-operator">=</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># K-Means would fail here</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-comment"># DBSCAN captures the moon shapes</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">dbscan <span class="hl-operator">=</span> DBSCAN<span class="hl-bracket">(</span>eps<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">3</span>, min_samples<span class="hl-operator">=</span><span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">clusters <span class="hl-operator">=</span> dbscan.fit_predict<span class="hl-bracket">(</span>X<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Number of clusters found: {len(set(clusters)) - (1 if -1 in clusters else 0)}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Number of noise points: {list(clusters).count(-1)}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="hierarchical-clustering-the-tree-of-life">Hierarchical Clustering: The Tree of Life</h2>
<p>Instead of choosing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> upfront, Hierarchical Clustering builds a hierarchy of relationships.</p>
<ul>
<li><strong>Agglomerative (Bottom-Up)</strong>: Every point starts as a cluster. The two closest clusters are merged iteratively until only one cluster remains.</li>
<li><strong>Divisive (Top-Down)</strong>: All points start in one cluster. The cluster is split iteratively until every point is its own cluster.</li>
</ul>
<h3 id="linkage-criteria">Linkage Criteria</h3>
<p>How do we define the “distance” between two <em>clusters</em>?</p>
<ul>
<li><strong>Single Linkage</strong>: Distance between the two closest points in the clusters.</li>
<li><strong>Complete Linkage</strong>: Distance between the two farthest points.</li>
<li><strong>Ward’s Linkage</strong>: Minimizes the variance of the clusters being merged (most common).</li>
</ul>
<h2 id="evaluating-performance-without-labels">Evaluating Performance without Labels</h2>
<p>Since there is no “ground truth”, we use internal validation metrics:</p>
<h3 id="1-silhouette-coefficient">1. Silhouette Coefficient</h3>
<p>Ranges from -1 to 1.</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>: Point is very far from neighboring clusters.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: Point is on the boundary between two clusters.</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>: Point is likely in the wrong cluster.</li>
</ul>
<h3 id="2-calinski-harabasz-index">2. Calinski-Harabasz Index</h3>
<p>The ratio of the sum of between-clusters dispersion and of within-cluster dispersion. A higher score signifies better separation.</p>
<astro-island uid="Z1huis" prefix="r33" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is scaling (normalization) critical for K-Means but less critical for decision-based algorithms?&quot;],&quot;options&quot;:[1,[[0,&quot;Scaling makes the data smaller and faster to process.&quot;],[0,&quot;K-Means uses Euclidean distance; if one feature (e.g., Salary) has a range of 100,000 and another (e.g., Age) has a range of 80, the Salary feature will dominate the distance calculation completely.&quot;],[0,&quot;Scaling is required by the Python language.&quot;],[0,&quot;Scaling only matters for supervised learning.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;K-Means treats every dimension in the feature space as equal. If features have different units and scales, the algorithm cannot &#39;know&#39; that 1 year of age might be just as important as 1,000 dollars of salary.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is scaling (normalization) critical for K-Means but less critical for decision-based algorithms?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Scaling makes the data smaller and faster to process.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">K-Means uses Euclidean distance; if one feature (e.g., Salary) has a range of 100,000 and another (e.g., Age) has a range of 80, the Salary feature will dominate the distance calculation completely.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Scaling is required by the Python language.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Scaling only matters for supervised learning.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="gaussian-mixture-models-gmm-soft-clustering">Gaussian Mixture Models (GMM): Soft Clustering</h2>
<p>Standard K-Means is a “hard clustering” algorithm—every point belongs to exactly one cluster. <strong>Gaussian Mixture Models</strong> provide “soft clustering”. They assume that the data is generated from a mixture of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> Gaussian distributions.</p>
<p>For every point, GMM provides a probability distribution across all clusters (e.g., 80% Cluster A, 20% Cluster B). This is valuable for handling overlapping groups and provides information about the uncertainty of the cluster assignments.</p>
<h2 id="practical-use-cases">Practical Use Cases</h2>
<p>Clustering is the engine behind many real-world systems:</p>
<ul>
<li><strong>Customer Segmentation</strong>: Identifying groups of customers with similar buying behaviors for targeted marketing.</li>
<li><strong>Image Compression</strong>: Using K-Means to reduce the number of colors in an image (Color Quantization).</li>
<li><strong>Anomaly Detection</strong>: Identifying fraudulent transactions by finding points that are far from any existing dense cluster.</li>
<li><strong>Biological Taxonomy</strong>: Grouping genes with similar expression patterns to understand biological functions.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Clustering allows us to make sense of data where labels are expensive or impossible to obtain. By choosing between centroid, density, or distribution-based methods, and carefully validating results using silhouette scores, we can transform a chaotic cloud of points into actionable insights about the latent structure of our world.</p> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Deep Learning</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Neural Networks: The Perceptron and Beyond</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-foundation-of-deep-learning">The Foundation of Deep Learning</h1>
<p>Artificial Neural Networks (ANNs) represent a shift from explicit algorithmic logic to a model of “connectionism.” Inspired by the architecture of the human brain, these networks consist of interconnected processing units that learn to recognize complex patterns through iteratively adjusting their internal parameters.</p>
<h2 id="the-atomic-unit-the-perceptron">The Atomic Unit: The Perceptron</h2>
<p>The <strong>Perceptron</strong>, developed by Frank Rosenblatt, is the simplest form of a neural network. It mimics the behavior of a biological neuron: it receives electrical signals (inputs), weights them by importance, and “fires” if the total signal exceeds a certain threshold.</p>
<h3 id="mathematical-definition">Mathematical Definition</h3>
<p>For a vector of inputs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>, the neuron calculates a weighted sum <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span>
where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> represents the <strong>Weights</strong> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span> is the <strong>Bias</strong>.</p>
<p>The result <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span> is then passed through an <strong>Activation Function</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span></span></span></span> to produce the output <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span>.</p>
<h2 id="the-role-of-activation-functions">The Role of Activation Functions</h2>
<p>Without activation functions, a neural network is just a series of linear transformations. Because the composition of linear functions is itself linear (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span>), a 100-layer “linear” network would be no more powerful than a single-layer linear regression.</p>
<p>Activation functions introduce <strong>Non-Linearity</strong>, allowing the network to approximate complex, curvy decision boundaries.</p>
<h3 id="core-activation-functions">Core Activation Functions</h3>
<ol>
<li><strong>Sigmoid</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Maps output to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. Historically popular but rarely used in hidden layers today due to the “vanishing gradient” problem.</li>
<li><strong>tanh</strong>: Maps to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. Zero-centered, which often makes optimization faster than sigmoid.</li>
<li><strong>ReLU (Rectified Linear Unit)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span></span></span></span>. The gold standard for deep learning. It’s computationally cheap and its derivative doesn’t vanish for positive inputs.</li>
<li><strong>Softmax</strong>: Used in the final layer for multi-class classification. It turns raw scores into a probability distribution that sums to 1.</li>
</ol>
<astro-island uid="28EwKV" prefix="r34" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\ndef relu(z): return np.max([0, z])\ndef sigmoid(z): return 1 / (1 + np.exp(-z))\n\nz_values = [-5, 0, 5]\nprint(\&quot;ReLU:\&quot;, [relu(z) for z in z_values])\nprint(\&quot;Sigmoid:\&quot;, [round(sigmoid(z), 4) for z in z_values])&quot;],&quot;output&quot;:[0,&quot;ReLU: [0, 0, 5]\nSigmoid: [0.0067, 0.5, 0.9933]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

def relu(z): return np.max([0, z])
def sigmoid(z): return 1 / (1 + np.exp(-z))

z_values = [-5, 0, 5]
print(&quot;ReLU:&quot;, [relu(z) for z in z_values])
print(&quot;Sigmoid:&quot;, [round(sigmoid(z), 4) for z in z_values])</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">def</span> relu<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span>: <span class="hl-keyword">return</span> np.<span class="hl-function">max</span><span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">0</span>, z<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">def</span> sigmoid<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span>: <span class="hl-keyword">return</span> <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-z</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">z_values <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-flag">-5</span>, <span class="hl-number">0</span>, <span class="hl-number">5</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;ReLU:&quot;</span>, <span class="hl-bracket">[</span>relu<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span> <span class="hl-keyword">for</span> z <span class="hl-keyword">in</span> z_values<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Sigmoid:&quot;</span>, <span class="hl-bracket">[</span>round<span class="hl-bracket">(</span>sigmoid<span class="hl-bracket">(</span>z<span class="hl-bracket">)</span>, <span class="hl-number">4</span><span class="hl-bracket">)</span> <span class="hl-keyword">for</span> z <span class="hl-keyword">in</span> z_values<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="architecture-the-multi-layer-perceptron-mlp">Architecture: The Multi-Layer Perceptron (MLP)</h2>
<p>A single perceptron cannot solve the <strong>XOR Problem</strong> (it can only draw straight lines). To solve complex problems, we arrange neurons into three types of layers:</p>
<ol>
<li><strong>Input Layer</strong>: One node per feature in your dataset.</li>
<li><strong>Hidden Layers</strong>: Layers between input and output where the “learning” happens. The <strong>Universal Approximation Theorem</strong> states that a network with just one hidden layer can approximate any continuous function, provided it has enough neurons.</li>
<li><strong>Output Layer</strong>: Produces the final result (e.g., a single value for regression, or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> probabilities for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span>-class classification).</li>
</ol>
<div class="my-12 flex flex-col items-center bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-[2.5rem] overflow-hidden shadow-xl p-8 transition-colors"> <div class="w-full flex justify-center overflow-x-auto dark:invert dark:hue-rotate-180 dark:brightness-110"> 
        <div class="w-full text-center py-10 bg-rose-50/50 dark:bg-rose-900/10 rounded-3xl border border-rose-200 dark:border-rose-900/30">
            <div class="inline-flex p-3 bg-rose-100 dark:bg-rose-900/40 text-rose-600 dark:text-rose-400 rounded-2xl mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            </div>
            <h4 class="font-black text-rose-900 dark:text-rose-100 uppercase tracking-tighter text-sm mb-1">Diagram Rendering Suspended</h4>
            <p class="text-[10px] font-bold text-rose-400/80 uppercase tracking-widest leading-relaxed px-4">The public PlantUML servers are currently unreachable or over-capacity.</p>
            
            <div class="mt-8 mx-auto max-w-[90%] text-left">
                <div class="flex items-center justify-between mb-2 px-4">
                    <div class="text-[9px] font-black text-light-muted dark:text-dark-muted uppercase tracking-[0.2em] opacity-50">Local Source Definition</div>
                    <a href="https://www.plantuml.com/plantuml/uml/TP51QyCm38Nl-HMYfmrMQ0A3dKP7jvB2kfNjiCikQgoafeaS99ks-_LpaaApGM-stlVqP7ck7iM7fauIqBtb5WKRs6AnhyG5DWjNEm4lo1ebOZ_6T8V67InNK6AjD9QUgSHG-wLZ_uODmMJ5dcHo1nCzgQTc6coyQ6mxLH9RNl5-sX-2D1kh6pIcYtmO5p-6MOL9_k5hFAv95IiQUjtFnkf1iFsonkyWc_qHs1bIQk4l7jUmFrUJIxLnx8gTkFXCBu4I8tY0mafHaq8PrySKnB4cGeL7hkf-7Mtmy8edac--MHBw8AIt4q255O_9t1f3FA2GNc1uESPlARnrFDZozAejYxQdhVOyB1mNrFfpM9wDNU_1Z-VQ21dRHvpfg2V9Yc7wsCNbQN_8aZph3fqu9pQXgNy1" target="_blank" class="text-[9px] font-black text-primary uppercase tracking-[0.2em] hover:underline">Open in Editor ↗</a>
                </div>
                <pre class="bg-white/50 dark:bg-black/20 p-6 rounded-2xl border border-rose-100 dark:border-rose-900/20 font-mono text-xs overflow-x-auto text-light-text dark:text-dark-text opacity-70">@startuml
skinparam monochrome true
draw circles for neurons
rectangle "Input Layer\n(Features)" as In
rectangle "Hidden Layer 1\n(Feature Extraction)" as H1
rectangle "Hidden Layer 2\n(Abstract Concepts)" as H2
rectangle "Output Layer\n(Predictions)" as Out

In -> H1
H1 -> H2
H2 -> Out
@enduml</pre>
            </div>
        </div>
       </div> </div>
<h2 id="how-neural-networks-learn">How Neural Networks Learn</h2>
<p>Learning is the process of finding the values for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span> that minimize a <strong>Loss Function</strong> (like Mean Squared Error or Cross-Entropy).</p>
<h3 id="1-the-forward-pass">1. The Forward Pass</h3>
<p>Data enters the input layer and ripples through the network. Each neuron calculates its activation and passes it forward. At the end, we get a prediction <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span></span></span></span>.</p>
<h3 id="2-the-loss-calculation">2. The Loss Calculation</h3>
<p>We compare <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span></span></span></span> to the real answer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> using a loss function. This tells us “how wrong” the network currently is.</p>
<h3 id="3-backpropagation-the-engine">3. Backpropagation (The Engine)</h3>
<p>Backpropagation is the application of the <strong>Chain Rule</strong> from calculus. We calculate how much each individual weight contributed to the final error.</p>
<ul>
<li>We start at the end and work backward.</li>
<li>We find the gradient: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3612em;vertical-align:-0.4811em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord text mtight"><span class="mord mtight">Weight</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord text mtight"><span class="mord mtight">Loss</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</li>
</ul>
<h3 id="4-weights-update-optimization">4. Weights Update (Optimization)</h3>
<p>We use an optimizer like <strong>Stochastic Gradient Descent (SGD)</strong> or <strong>Adam</strong> to nudge the weights in the direction that reduces the error:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em"></span><span class="mord text"><span class="mord">learning_rate</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">gradient</span></span></span></span></span></p>
<h2 id="implementation-from-scratch-a-single-neuron">Implementation from Scratch: A Single Neuron</h2>
<p>Let’s see the inner workings of a single neuron’s training loop.</p>
<astro-island uid="Z1BwOze" prefix="r35" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\n# Training data (OR Gate)\nX = np.array([[0,0], [0,1], [1,0], [1,1]])\ny = np.array([[0], [1], [1], [1]])\n\n# Initialization\nweights = np.random.randn(2, 1)\nbias = 0\nlr = 0.1\n\nfor epoch in range(100):\n  # Forward Pass\n  z = np.dot(X, weights) + bias\n  a = 1 / (1 + np.exp(-z)) # Sigmoid\n  \n  # Loss (MSE)\n  error = a - y\n  \n  # Backprop (Gradients)\n  # Derivative of Sigmoid is a * (1 - a)\n  dz = error * (a * (1 - a))\n  dw = np.dot(X.T, dz)\n  db = np.sum(dz)\n  \n  # Update\n  weights -= lr * dw\n  bias -= lr * db\n\nprint(\&quot;Prediction for [1,1]:\&quot;, 1 / (1 + np.exp(-(np.dot([1,1], weights) + bias))))&quot;],&quot;output&quot;:[0,&quot;Prediction for [1,1]: [0.9...]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

# Training data (OR Gate)
X = np.array([[0,0], [0,1], [1,0], [1,1]])
y = np.array([[0], [1], [1], [1]])

# Initialization
weights = np.random.randn(2, 1)
bias = 0
lr = 0.1

for epoch in range(100):
  # Forward Pass
  z = np.dot(X, weights) + bias
  a = 1 / (1 + np.exp(-z)) # Sigmoid
  
  # Loss (MSE)
  error = a - y
  
  # Backprop (Gradients)
  # Derivative of Sigmoid is a * (1 - a)
  dz = error * (a * (1 - a))
  dw = np.dot(X.T, dz)
  db = np.sum(dz)
  
  # Update
  weights -= lr * dw
  bias -= lr * db

print(&quot;Prediction for [1,1]:&quot;, 1 / (1 + np.exp(-(np.dot([1,1], weights) + bias))))</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-comment"># Training data (OR Gate)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">0</span>,<span class="hl-number">0</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">0</span>,<span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">1</span>,<span class="hl-number">0</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">1</span>,<span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-comment"># Initialization</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">weights <span class="hl-operator">=</span> np.random.randn<span class="hl-bracket">(</span><span class="hl-number">2</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">bias <span class="hl-operator">=</span> <span class="hl-number">0</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">lr <span class="hl-operator">=</span> <span class="hl-number">0</span>.<span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-keyword">for</span> epoch <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span><span class="hl-number">100</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">  <span class="hl-comment"># Forward Pass</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">  z <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>X, weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> bias</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">  a <span class="hl-operator">=</span> <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-z</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span> <span class="hl-comment"># Sigmoid</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">  <span class="hl-comment"># Loss (MSE)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">  <span class="hl-function">error</span> <span class="hl-operator">=</span> a <span class="hl-flag">-</span> y</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">  <span class="hl-comment"># Backprop (Gradients)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">  <span class="hl-comment"># Derivative of Sigmoid is a * (1 - a)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">  dz <span class="hl-operator">=</span> <span class="hl-function">error</span> <span class="hl-operator">*</span> <span class="hl-bracket">(</span>a <span class="hl-operator">*</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-flag">-</span> a<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">  dw <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>X.T, dz<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">  db <span class="hl-operator">=</span> np.<span class="hl-function">sum</span><span class="hl-bracket">(</span>dz<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">  <span class="hl-comment"># Update</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">  weights <span class="hl-flag">-</span><span class="hl-operator">=</span> lr <span class="hl-operator">*</span> dw</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">  bias <span class="hl-flag">-</span><span class="hl-operator">=</span> lr <span class="hl-operator">*</span> db</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Prediction for [1,1]:&quot;</span>, <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-</span><span class="hl-bracket">(</span>np.dot<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">1</span>,<span class="hl-number">1</span><span class="hl-bracket">]</span>, weights<span class="hl-bracket">)</span> <span class="hl-operator">+</span> bias<span class="hl-bracket">)</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="common-challenges-in-deep-learning">Common Challenges in Deep Learning</h2>
<h3 id="1-the-vanishing-gradient">1. The Vanishing Gradient</h3>
<p>In very deep networks using Sigmoid/Tanh, as we propagate the error backward, the gradients are multiplied by values between 0 and 1. By the time the error reaches the first layers, the gradient is so small (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.00001</span></span></span></span>) that the weights barely change. This is why <strong>ReLU</strong> and <strong>Batch Normalization</strong> are essential in modern architectures.</p>
<h3 id="2-overfitting-high-variance">2. Overfitting (High Variance)</h3>
<p>Deep networks have millions of parameters. They are prone to memorizing the training set. We combat this with:</p>
<ul>
<li><strong>Dropout</strong>: Randomly “turning off” neurons during training to force the network to become redundant and robust.</li>
<li><strong>L2 Regularization</strong>: Penalizing large weights.</li>
<li><strong>Early Stopping</strong>: Stopping training once the validation error starts increasing.</li>
</ul>
<astro-island uid="Zco014" prefix="r36" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;If we have a network with 2 hidden layers, each with 10 neurons, and we remove the activation functions, what happens?&quot;],&quot;options&quot;:[1,[[0,&quot;The network becomes more accurate.&quot;],[0,&quot;The network becomes equivalent to a simple linear model (a single perceptron).&quot;],[0,&quot;Training becomes impossible because of division by zero.&quot;],[0,&quot;The number of parameters increases.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;Stacking linear layers results in a linear combination. The final output would just be a linear function of the inputs, no matter how many layers you add. Non-linear activation functions are what allow the &#39;Deep&#39; in Deep Learning to actually mean something.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">If we have a network with 2 hidden layers, each with 10 neurons, and we remove the activation functions, what happens?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The network becomes more accurate.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The network becomes equivalent to a simple linear model (a single perceptron).</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Training becomes impossible because of division by zero.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The number of parameters increases.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="modern-variations">Modern Variations</h2>
<p>While MLPs are the foundation, different data types require specialized architectures:</p>
<ul>
<li><strong>Convolutional Neural Networks (CNNs)</strong>: For grid-like data (Images). They use “Filters” to capture spatial features.</li>
<li><strong>Recurrent Neural Networks (RNNs)</strong>: For sequential data (Text, Time-series). They have “Memory” of previous inputs.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Neural networks are the mathematical realization of learning through experience. By stacking many simple units and applying the chain rule of calculus, we can build machines that learn to recognize faces, translate languages, and drive cars. Understanding the flow of information—from linear sum to non-linear activation, and from global error to individual weight adjustment—is the key to mastering the modern AI landscape.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Convolutional Neural Networks: Vision and Pattern Recognition</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-geometry-of-computer-vision">The Geometry of Computer Vision</h1>
<p>If you show a standard Multi-Layer Perceptron (MLP) a photo of a cat and shift that cat by just one pixel, the MLP sees a completely different set of inputs. It has no concept of “spatial locality” or “shapes.” Convolutional Neural Networks (CNNs) were designed specifically to handle grid-like data (images) by mimicking the human visual cortex’s hierarchy of feature detection.</p>
<h2 id="why-mlps-fail-on-images">Why MLPs Fail on Images</h2>
<p>Consider a color image of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">100</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span></span></span></span> pixels. This image has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">30</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span></span></span></span> inputs (RGB channels). A single hidden layer with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span></span></span></span> neurons would require <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">30</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">000</span></span></span></span> weights. This lead to two problems:</p>
<ol>
<li><strong>Computational Explosion</strong>: Training billions of weights is slow and memory-intensive.</li>
<li><strong>Loss of Topology</strong>: Flattening an image into a 1D vector destroys the information about which pixels are next to each other.</li>
</ol>
<p>CNNs solve this through <strong>Local Connectivity</strong> and <strong>Weight Sharing</strong>.</p>
<h2 id="the-convolution-operation">The Convolution Operation</h2>
<p>At the heart of the CNN is the <strong>Kernel</strong> (or filter)—a small matrix of weights (e.g., <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">3</span></span></span></span>). This kernel slides across the image, performing an element-wise multiplication and summing the result. This operation produces a <strong>Feature Map</strong>.</p>
<h3 id="key-concepts">Key Concepts</h3>
<ul>
<li><strong>Stride</strong>: The “hop” distance of the filter. A stride of 2 skips every other pixel, effectively downsampling the image.</li>
<li><strong>Padding</strong>: Adding a border of zeros around the image. This allows the filter to reach the edges and keeps the output dimensions consistent with the input.</li>
<li><strong>Channels</strong>: Color images have 3 channels (R, G, B). A convolutional layer often produces many channels (e.g., 64 or 128), each representing a different learned feature.</li>
</ul>
<astro-island uid="1EbAek" prefix="r37" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom scipy import signal\n\n# A simple 5x5 image\nimage = np.array([\n  [1, 1, 1, 0, 0],\n  [0, 1, 1, 1, 0],\n  [0, 0, 1, 1, 1],\n  [0, 0, 1, 1, 0],\n  [0, 1, 1, 0, 0]\n])\n\n# An edge detection filter (Vertical lines)\nkernel = np.array([\n  [1, 0, -1],\n  [1, 0, -1],\n  [1, 0, -1]\n])\n\n# Perform 2D convolution\nfeature_map = signal.convolve2d(image, kernel, mode=&#39;valid&#39;)\n\nprint(\&quot;Resulting Feature Map:\&quot;)\nprint(feature_map)&quot;],&quot;output&quot;:[0,&quot;Resulting Feature Map:\n[[ 1.  0. -1.]\n[ 0.  0. -1.]\n[ 0.  1.  0.]]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from scipy import signal

# A simple 5x5 image
image = np.array([
  [1, 1, 1, 0, 0],
  [0, 1, 1, 1, 0],
  [0, 0, 1, 1, 1],
  [0, 0, 1, 1, 0],
  [0, 1, 1, 0, 0]
])

# An edge detection filter (Vertical lines)
kernel = np.array([
  [1, 0, -1],
  [1, 0, -1],
  [1, 0, -1]
])

# Perform 2D convolution
feature_map = signal.convolve2d(image, kernel, mode=&#x27;valid&#x27;)

print(&quot;Resulting Feature Map:&quot;)
print(feature_map)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> scipy <span class="hl-keyword">import</span> signal</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># A simple 5x5 image</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">image <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-comment"># An edge detection filter (Vertical lines)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">kernel <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-flag">-1</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-flag">-1</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-flag">-1</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre"><span class="hl-comment"># Perform 2D convolution</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">feature_map <span class="hl-operator">=</span> signal.convolve2d<span class="hl-bracket">(</span>image, kernel, mode<span class="hl-operator">=</span><span class="hl-string">&#039;valid&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Resulting Feature Map:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>feature_map<span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="building-the-spatial-hierarchy">Building the Spatial Hierarchy</h2>
<p>A CNN doesn’t just use one layer. It stacks them to build abstraction:</p>
<ul>
<li><strong>Early Layers</strong>: Detect simple patterns like horizontal lines, vertical edges, and color gradients.</li>
<li><strong>Middle Layers</strong>: Combine lines into shapes like circles, squares, or textures.</li>
<li><strong>Deep Layers</strong>: Combine shapes into complex parts like eyes, wheels, or noses.</li>
<li><strong>Final Layers</strong>: Combine parts to recognize high-level objects like “Cat” or “Car.”</li>
</ul>
<h2 id="downsampling-the-pooling-layer">Downsampling: The Pooling Layer</h2>
<p>To make the network more robust and computationally efficient, we use <strong>Pooling Layers</strong>. They reduce the resolution of the feature map while preserving the most important information.</p>
<ul>
<li><strong>Max Pooling</strong>: In a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span> window, only the largest value is kept.</li>
<li><strong>Effect</strong>: It provides <strong>Translation Invariance</strong>. If a feature (like an edge) shifts by 1 pixel, the max value in the window often stays the same, so the subsequent layers see the same signal.</li>
</ul>
<astro-island uid="Juamm" prefix="r38" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\ndef max_pooling(mat, ksize=2):\n  # Simplified max pooling\n  m, n = mat.shape\n  res = np.zeros((m//ksize, n//ksize))\n  for i in range(0, m, ksize):\n      for j in range(0, n, ksize):\n          res[i//ksize, j//ksize] = np.max(mat[i:i+ksize, j:j+ksize])\n  return res\n\nfm = np.array([[12, 20, 30, 0], [8, 12, 2, 0], [34, 70, 37, 4], [112, 100, 25, 12]])\nprint(\&quot;Before Pooling (4x4):\&quot;)\nprint(fm)\nprint(\&quot;\&quot;)\nprint(\&quot;After Max Pooling (2x2):\&quot;)\nprint(max_pooling(fm))&quot;],&quot;output&quot;:[0,&quot;Before Pooling (4x4):\n[[ 12  20  30   0]\n[  8  12   2   0]\n[ 34  70  37   4]\n[112 100  25  12]] After Max Pooling (2x2):\n[[ 20.  30.]\n[112.  37.]]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
def max_pooling(mat, ksize=2):
  # Simplified max pooling
  m, n = mat.shape
  res = np.zeros((m//ksize, n//ksize))
  for i in range(0, m, ksize):
      for j in range(0, n, ksize):
          res[i//ksize, j//ksize] = np.max(mat[i:i+ksize, j:j+ksize])
  return res

fm = np.array([[12, 20, 30, 0], [8, 12, 2, 0], [34, 70, 37, 4], [112, 100, 25, 12]])
print(&quot;Before Pooling (4x4):&quot;)
print(fm)
print(&quot;&quot;)
print(&quot;After Max Pooling (2x2):&quot;)
print(max_pooling(fm))</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">def</span> max_pooling<span class="hl-bracket">(</span>mat, ksize<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">  <span class="hl-comment"># Simplified max pooling</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">  m, n <span class="hl-operator">=</span> mat.shape</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  res <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span><span class="hl-bracket">(</span>m<span class="hl-comment">//ksize, n//ksize))</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">  <span class="hl-keyword">for</span> i <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span><span class="hl-number">0</span>, m, ksize<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> j <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span><span class="hl-number">0</span>, n, ksize<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">          res<span class="hl-bracket">[</span>i<span class="hl-comment">//ksize, j//ksize] = np.max(mat[i:i+ksize, j:j+ksize])</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> res</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">fm <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">12</span>, <span class="hl-number">20</span>, <span class="hl-number">30</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">8</span>, <span class="hl-number">12</span>, <span class="hl-number">2</span>, <span class="hl-number">0</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">34</span>, <span class="hl-number">70</span>, <span class="hl-number">37</span>, <span class="hl-number">4</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">112</span>, <span class="hl-number">100</span>, <span class="hl-number">25</span>, <span class="hl-number">12</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Before Pooling (4x4):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>fm<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;After Max Pooling (2x2):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>max_pooling<span class="hl-bracket">(</span>fm<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="the-full-pipeline-from-pixels-to-predictions">The Full Pipeline: From Pixels to Predictions</h2>
<p>A CNN pipeline typically looks like this:</p>
<ol>
<li><strong>Input</strong>: Raw RGB pixels.</li>
<li><strong>Feature Extraction</strong>: Successive blocks of <code>[Convolution -&gt; ReLU -&gt; Max Pooling]</code>.</li>
<li><strong>Flattening</strong>: The final 3D feature map is unrolled into a 1D vector.</li>
<li><strong>Classification</strong>: The vector is passed into one or more Fully Connected (Dense) layers.</li>
<li><strong>Output</strong>: A Softmax layer providing probabilities for each class.</li>
</ol>
<div class="my-12 flex flex-col items-center bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-[2.5rem] overflow-hidden shadow-xl p-8 transition-colors"> <div class="w-full flex justify-center overflow-x-auto dark:invert dark:hue-rotate-180 dark:brightness-110"> <?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="113px" preserveAspectRatio="none" style="width:990px;height:113px;" version="1.1" viewBox="0 0 990 113" width="990px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFCC" height="26.6406" rx="2.5" ry="2.5" style="stroke:#FFDD88;stroke-width:3;" width="979.3945" x="5" y="5"/><text fill="#000000" font-family="monospace" font-size="10" lengthAdjust="spacing" textLength="355.21" x="10" y="20">Please&#160;use&#160;'!option&#160;handwritten&#160;true'&#160;to&#160;enable&#160;handwritten</text><!--entity In--><g class="entity" data-qualified-name="In" data-source-line="13" id="ent0002"><rect fill="#F1F1F1" height="49.9688" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="147.8965" x="7" y="50.6306"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="31.0723" x="25" y="79.7693">Input</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="56.0723" y="79.7693">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="77.0098" x="59.8867" y="79.7693">(128x128x3)</text></g><!--entity C1--><g class="entity" data-qualified-name="C1" data-source-line="14" id="ent0003"><rect fill="#F1F1F1" height="63.9375" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="114.1465" x="204.87" y="43.6406"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="30.4277" x="222.87" y="72.7793">Conv</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="253.2977" y="72.7793">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="32.4551" x="257.1122" y="72.7793">Block</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="289.5673" y="72.7793">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="7.6348" x="293.3817" y="72.7793">1</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="61.8809" x="222.87" y="86.748">(Features)</text></g><!--entity C2--><g class="entity" data-qualified-name="C2" data-source-line="15" id="ent0004"><rect fill="#F1F1F1" height="63.9375" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="114.1465" x="368.88" y="43.6406"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="30.4277" x="386.88" y="72.7793">Conv</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="417.3077" y="72.7793">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="32.4551" x="421.1222" y="72.7793">Block</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="453.5773" y="72.7793">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="7.6348" x="457.3917" y="72.7793">2</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="59.5371" x="386.88" y="86.748">(Patterns)</text></g><!--entity F--><g class="entity" data-qualified-name="F" data-source-line="16" id="ent0005"><rect fill="#F1F1F1" height="49.9688" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="77.9883" x="532.95" y="50.6306"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="41.9883" x="550.95" y="79.7693">Flatten</text></g><!--entity D--><g class="entity" data-qualified-name="D" data-source-line="17" id="ent0006"><rect fill="#F1F1F1" height="49.9688" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="117.5801" x="661.16" y="50.6306"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.8633" x="679.16" y="79.7693">Dense</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="717.0233" y="79.7693">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.9023" x="720.8377" y="79.7693">(1024)</text></g><!--entity Out--><g class="entity" data-qualified-name="Out" data-source-line="18" id="ent0007"><rect fill="#F1F1F1" height="49.9688" rx="6" ry="6" style="stroke:#181818;stroke-width:0.5;" width="140.8945" x="828.5" y="50.6306"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="41.6836" x="846.5" y="79.7693">Output</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="888.1836" y="79.7693">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="59.3965" x="891.998" y="79.7693">(Softmax)</text></g><!--link In to C1--><g class="link" data-entity-1="ent0002" data-entity-2="ent0003" data-link-type="dependency" data-source-line="20" id="lnk8"><path d="M155.19,75.6106 C171.59,75.6106 181.99,75.6106 198.4,75.6106" fill="none" id="In-to-C1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="204.4,75.6106,195.4,71.6106,199.4,75.6106,195.4,79.6106,204.4,75.6106" style="stroke:#181818;stroke-width:1;"/></g><!--link C1 to C2--><g class="link" data-entity-1="ent0003" data-entity-2="ent0004" data-link-type="dependency" data-source-line="21" id="lnk9"><path d="M319.28,75.6106 C335.67,75.6106 346.06,75.6106 362.45,75.6106" fill="none" id="C1-to-C2" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="368.45,75.6106,359.45,71.6106,363.45,75.6106,359.45,79.6106,368.45,75.6106" style="stroke:#181818;stroke-width:1;"/></g><!--link C2 to F--><g class="link" data-entity-1="ent0004" data-entity-2="ent0005" data-link-type="dependency" data-source-line="22" id="lnk10"><path d="M483.26,75.6106 C499.66,75.6106 510.06,75.6106 526.46,75.6106" fill="none" id="C2-to-F" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="532.46,75.6106,523.46,71.6106,527.46,75.6106,523.46,79.6106,532.46,75.6106" style="stroke:#181818;stroke-width:1;"/></g><!--link F to D--><g class="link" data-entity-1="ent0005" data-entity-2="ent0006" data-link-type="dependency" data-source-line="23" id="lnk11"><path d="M611.26,75.6106 C627.82,75.6106 638.38,75.6106 654.93,75.6106" fill="none" id="F-to-D" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="660.93,75.6106,651.93,71.6106,655.93,75.6106,651.93,79.6106,660.93,75.6106" style="stroke:#181818;stroke-width:1;"/></g><!--link D to Out--><g class="link" data-entity-1="ent0006" data-entity-2="ent0007" data-link-type="dependency" data-source-line="24" id="lnk12"><path d="M779.03,75.6106 C795.43,75.6106 805.82,75.6106 822.22,75.6106" fill="none" id="D-to-Out" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="828.22,75.6106,819.22,71.6106,823.22,75.6106,819.22,79.6106,828.22,75.6106" style="stroke:#181818;stroke-width:1;"/></g><?plantuml-src TP31JiCm343l_Gghfo4nQGqWxSI1LfLs64pim8MBMTokQkjKSSe6Nq_Q3iWcxH35yNkEdKXTSOSMM_Z0NLrQqxDEJMCiE8ii7X6x2EHFaprgSwYuX08ReH1bL63VkDomUyQM85wn8nlVGYnVugYTzvK_YBzsBcIhuahjjlecI5H8DwZrq78P9b-dMIsJlT3NU5oJ29OqtVMm2Ed1OlTMQRS7jJW3R3G9TN2k-s-eJzdeFxj7rWTREKTy-WXBEuTSDkExkzx1B57Bux3kRc90WHM7Jchu4vuQiwiXUUTPJkXwIpAfQN95LLxTeEzg-LTLePet0-IHv278Y8NyI0jrFzLb8NtftJZnrXIknUDa-6GKhHZcZyCyQJ86AahL4EHHFcnPb0sRLty0?></g></svg> </div> </div>
<h2 id="critical-concepts-in-cnn-training">Critical Concepts in CNN Training</h2>
<h3 id="1-data-augmentation">1. Data Augmentation</h3>
<p>CNNs need a lot of data. We can artificially increase our dataset by taking existing images and applying random:</p>
<ul>
<li>Rotations</li>
<li>Horizontal/Vertical flips</li>
<li>Zooming and Cropping</li>
<li>Color/Brightness adjustments
This forces the network to learn that a cat is still a cat even if it’s upside down or in a different lighting.</li>
</ul>
<h3 id="2-transfer-learning">2. Transfer Learning</h3>
<p>Training a CNN from scratch takes weeks on expensive GPUs. Instead, we use <strong>Transfer Learning</strong>. We take a model trained on millions of images (like ImageNet) and “freeze” its feature extraction layers. We only train the final classification layers for our specific task (e.g., distinguishing different types of medical scans).</p>
<astro-island uid="ZKznfj" prefix="r39" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why does weight sharing in a convolutional layer help prevent overfitting?&quot;],&quot;options&quot;:[1,[[0,&quot;It makes the network faster to train.&quot;],[0,&quot;It forces the network to use the same feature detector everywhere, which drastically reduces the total number of parameters compared to a fully connected layer.&quot;],[0,&quot;It automatically cleans the noise from the input images.&quot;],[0,&quot;It allows the network to use larger filters.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;In an MLP, every connection has a unique weight. In a CNN, all neurons in a feature map share the same weights (the filter). This reduction in parameters makes the model much harder to &#39;memorize&#39; the training data, leading to better generalization.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why does weight sharing in a convolutional layer help prevent overfitting?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It makes the network faster to train.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It forces the network to use the same feature detector everywhere, which drastically reduces the total number of parameters compared to a fully connected layer.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It automatically cleans the noise from the input images.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It allows the network to use larger filters.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="classic-architectures">Classic Architectures</h2>
<ul>
<li><strong>LeNet-5 (1998)</strong>: One of the first successful CNNs, used by banks to recognize handwritten checks.</li>
<li><strong>AlexNet (2012)</strong>: The breakthrough that started the current AI boom by winning the ImageNet competition by a massive margin.</li>
<li><strong>ResNet (2015)</strong>: Introduced “Skip Connections” (Residuals) which allowed networks to be hundreds of layers deep without the gradients vanishing.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Convolutional Neural Networks transformed artificial intelligence by enabling machines to “see.” By replacing global connectivity with local filters and downsampling with pooling, CNNs extract a hierarchy of spatial features that are robust to translation and variation. Whether it’s in a self-driving car identifying a stop sign or a smartphone unlocking via face detection, the CNN is the undisputed engine of modern computer vision.</p> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Applications</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Numerical Optimization: Navigating the Loss Landscape</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-challenge-of-optimization">The Challenge of Optimization</h1>
<p>In machine learning, training a model is an optimization problem: we seek to find the parameter vector <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> that minimizes a loss function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span>. In deep learning, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> is a highly non-convex surface in a space with millions of dimensions, filled with local minima, saddle points, and plateaus.</p>
<p>A <strong>Saddle Point</strong> is a region where the gradient is zero, but it is a minimum in some dimensions and a maximum in others. In high-dimensional spaces, saddle points are far more common than local minima and are the primary bottleneck for first-order optimizers.</p>
<h2 id="1-gradient-descent-paradigms">1. Gradient Descent Paradigms</h2>
<ol>
<li><strong>Batch Gradient Descent</strong>: Computes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> using the entire dataset. It provides a stable trajectory but is computationally impossible for large datasets.</li>
<li><strong>Stochastic Gradient Descent (SGD)</strong>: Computes the gradient for a single random sample. It introduces “noise” into the update, which helps escape local minima but makes convergence erratic.</li>
<li><strong>Mini-Batch Gradient Descent</strong>: The gold standard. It uses a small subset (e.g., 32–512 samples). It reduces the variance of SGD while maintaining significant computational efficiency via vectorization.</li>
</ol>
<h2 id="2-momentum-the-physics-of-optimization">2. Momentum: The Physics of Optimization</h2>
<p>Momentum addresses the “oscillation” problem in SGD. If the loss surface is like a narrow valley, SGD will bounce between the walls instead of moving along the floor. Momentum mimics a ball rolling down a hill, accumulating velocity in directions of consistent descent.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span>
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></p>
<p>Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> is the friction/momentum coefficient.</p>
<h3 id="nesterov-accelerated-gradient-nag">Nesterov Accelerated Gradient (NAG)</h3>
<p>Standard momentum calculates the gradient at the <em>current</em> position and then jumps. NAG is more “cautious”: it calculates the gradient at the <em>predicted</em> next position (based on current momentum). This allows the optimizer to “slow down” before the slope turns upward again.</p>
<astro-island uid="Z2hk7An" prefix="r40" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\n\ndef loss_func(x, y):\n  return x**2 + 10*y**2  # A narrow valley\n\ndef grad(x, y):\n  return np.array([2*x, 20*y])\n\ndef optimize(method=&#39;sgd&#39;, iterations=20, lr=0.1, gamma=0.9):\n  theta = np.array([-4.0, 1.0])\n  path = [theta.copy()]\n  v = np.zeros(2)\n  \n  for _ in range(iterations):\n      g = grad(theta[0], theta[1])\n      if method == &#39;sgd&#39;:\n          theta -= lr * g\n      elif method == &#39;momentum&#39;:\n          v = gamma * v + lr * g\n          theta -= v\n      path.append(theta.copy())\n  return np.array(path)\n\n# Visualization\npath_sgd = optimize(&#39;sgd&#39;)\npath_mom = optimize(&#39;momentum&#39;)\n\nplt.figure(figsize=(10, 5))\nx = np.linspace(-5, 5, 100)\ny = np.linspace(-2, 2, 100)\nX, Y = np.meshgrid(x, y)\nZ = loss_func(X, Y)\nplt.contour(X, Y, Z, levels=20)\nplt.plot(path_sgd[:,0], path_sgd[:,1], &#39;r-o&#39;, label=&#39;SGD (Oscillates)&#39;)\nplt.plot(path_mom[:,0], path_mom[:,1], &#39;b-o&#39;, label=&#39;Momentum (Faster)&#39;)\nplt.legend()\nplt.title(\&quot;SGD vs Momentum in a Narrow Valley\&quot;)\nplt.show()\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt

def loss_func(x, y):
  return x**2 + 10*y**2  # A narrow valley

def grad(x, y):
  return np.array([2*x, 20*y])

def optimize(method=&#x27;sgd&#x27;, iterations=20, lr=0.1, gamma=0.9):
  theta = np.array([-4.0, 1.0])
  path = [theta.copy()]
  v = np.zeros(2)
  
  for _ in range(iterations):
      g = grad(theta[0], theta[1])
      if method == &#x27;sgd&#x27;:
          theta -= lr * g
      elif method == &#x27;momentum&#x27;:
          v = gamma * v + lr * g
          theta -= v
      path.append(theta.copy())
  return np.array(path)

# Visualization
path_sgd = optimize(&#x27;sgd&#x27;)
path_mom = optimize(&#x27;momentum&#x27;)

plt.figure(figsize=(10, 5))
x = np.linspace(-5, 5, 100)
y = np.linspace(-2, 2, 100)
X, Y = np.meshgrid(x, y)
Z = loss_func(X, Y)
plt.contour(X, Y, Z, levels=20)
plt.plot(path_sgd[:,0], path_sgd[:,1], &#x27;r-o&#x27;, label=&#x27;SGD (Oscillates)&#x27;)
plt.plot(path_mom[:,0], path_mom[:,1], &#x27;b-o&#x27;, label=&#x27;Momentum (Faster)&#x27;)
plt.legend()
plt.title(&quot;SGD vs Momentum in a Narrow Valley&quot;)
plt.show()
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">def</span> loss_func<span class="hl-bracket">(</span>x, y<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> x<span class="hl-operator">*</span><span class="hl-operator">*</span><span class="hl-number">2</span> <span class="hl-operator">+</span> <span class="hl-number">10</span><span class="hl-operator">*</span>y<span class="hl-operator">*</span><span class="hl-operator">*</span><span class="hl-number">2</span>  <span class="hl-comment"># A narrow valley</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-keyword">def</span> grad<span class="hl-bracket">(</span>x, y<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">2</span><span class="hl-operator">*</span>x, <span class="hl-number">20</span><span class="hl-operator">*</span>y<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-keyword">def</span> optimize<span class="hl-bracket">(</span>method<span class="hl-operator">=</span><span class="hl-string">&#039;sgd&#039;</span>, iterations<span class="hl-operator">=</span><span class="hl-number">20</span>, lr<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">1</span>, gamma<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">9</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">  theta <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-flag">-4</span>.<span class="hl-number">0</span>, <span class="hl-number">1</span>.<span class="hl-number">0</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">  path <span class="hl-operator">=</span> <span class="hl-bracket">[</span>theta.copy<span class="hl-bracket">(</span><span class="hl-bracket">)</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">  v <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">  <span class="hl-keyword">for</span> _ <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>iterations<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">      g <span class="hl-operator">=</span> grad<span class="hl-bracket">(</span>theta<span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span>, theta<span class="hl-bracket">[</span><span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">      <span class="hl-keyword">if</span> method <span class="hl-operator">==</span> <span class="hl-string">&#039;sgd&#039;</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">          theta <span class="hl-flag">-</span><span class="hl-operator">=</span> lr <span class="hl-operator">*</span> g</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">      <span class="hl-keyword">elif</span> method <span class="hl-operator">==</span> <span class="hl-string">&#039;momentum&#039;</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">          v <span class="hl-operator">=</span> gamma <span class="hl-operator">*</span> v <span class="hl-operator">+</span> lr <span class="hl-operator">*</span> g</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">          theta <span class="hl-flag">-</span><span class="hl-operator">=</span> v</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">      path.append<span class="hl-bracket">(</span>theta.copy<span class="hl-bracket">(</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> np.array<span class="hl-bracket">(</span>path<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre"><span class="hl-comment"># Visualization</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">path_sgd <span class="hl-operator">=</span> optimize<span class="hl-bracket">(</span><span class="hl-string">&#039;sgd&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">path_mom <span class="hl-operator">=</span> optimize<span class="hl-bracket">(</span><span class="hl-string">&#039;momentum&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">10</span>, <span class="hl-number">5</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">x <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-flag">-5</span>, <span class="hl-number">5</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.linspace<span class="hl-bracket">(</span><span class="hl-flag">-2</span>, <span class="hl-number">2</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">X, Y <span class="hl-operator">=</span> np.meshgrid<span class="hl-bracket">(</span>x, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre">Z <span class="hl-operator">=</span> loss_func<span class="hl-bracket">(</span>X, Y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre">plt.contour<span class="hl-bracket">(</span>X, Y, Z, levels<span class="hl-operator">=</span><span class="hl-number">20</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>path_sgd<span class="hl-bracket">[</span>:,<span class="hl-number">0</span><span class="hl-bracket">]</span>, path_sgd<span class="hl-bracket">[</span>:,<span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-string">&#039;r-o&#039;</span>, label<span class="hl-operator">=</span><span class="hl-string">&#039;SGD (Oscillates)&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">36</span><span class="whitespace-pre">plt.plot<span class="hl-bracket">(</span>path_mom<span class="hl-bracket">[</span>:,<span class="hl-number">0</span><span class="hl-bracket">]</span>, path_mom<span class="hl-bracket">[</span>:,<span class="hl-number">1</span><span class="hl-bracket">]</span>, <span class="hl-string">&#039;b-o&#039;</span>, label<span class="hl-operator">=</span><span class="hl-string">&#039;Momentum (Faster)&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">37</span><span class="whitespace-pre">plt.legend<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">38</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;SGD vs Momentum in a Narrow Valley&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">39</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">40</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="3-adaptive-learning-rates">3. Adaptive Learning Rates</h2>
<p>A fixed learning rate <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span> is a compromise. Ideally, we want a large learning rate for parameters that are far from their optimum and a small one for those that are fine-tuning.</p>
<h3 id="adagrad-adaptive-gradient">Adagrad (Adaptive Gradient)</h3>
<p>Adagrad scales the learning rate by the sum of squares of previous gradients.
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.5771em;vertical-align:-0.8296em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em"><span style="top:-2.4987em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9876em"><span class="svg-align" style="top:-3.4286em"><span class="pstrut" style="height:3.4286em"></span><span class="mord mtight" style="padding-left:1.19em"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span></span></span><span style="top:-2.9596em"><span class="pstrut" style="height:3.4286em"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5429em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.5429em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4689em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8296em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>
Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is the sum of squared gradients for parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>.
<em>Problem</em>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">G</span></span></span></span> grows indefinitely, eventually stopping all learning.</p>
<h3 id="rmsprop">RMSprop</h3>
<p>To fix Adagrad, RMSprop uses an <strong>exponentially decaying average</strong> of squared gradients:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">βE</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span>
This prevents the learning rate from vanishing.</p>
<h3 id="adam-adaptive-moment-estimation">Adam (Adaptive Moment Estimation)</h3>
<p>Adam is the “Swiss Army Knife” of optimizers. It tracks both the first moment <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> (mean) and second moment <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> (variance) of the gradients.</p>
<ol>
<li><strong>Update Moments</strong>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>Bias Correction</strong>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2885em;vertical-align:-0.577em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em"><span style="top:-2.6411em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7841em"><span style="top:-2.1885em;margin-left:-0.0528em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.8448em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.577em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2222em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2885em;vertical-align:-0.577em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em"><span style="top:-2.6411em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7841em"><span style="top:-2.1885em;margin-left:-0.0528em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.8448em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.577em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>Update Weights</strong>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2855em;vertical-align:-0.538em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em"><span style="top:-2.5836em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8663em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight" style="padding-left:0.833em"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-0.2222em"><span class="mord mtight">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span><span style="top:-2.8263em"><span class="pstrut" style="height:3em"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1737em"><span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></li>
</ol>
<h2 id="4-second-order-methods-newtons-method">4. Second-Order Methods (Newton’s Method)</h2>
<p>First-order methods (like Adam) only look at the slope. Second-order methods look at the <strong>Hessian</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span> (the matrix of second derivatives) to understand the curvature.</p>
<p>The Newton update is:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span></p>
<p><em>Advantage</em>: It can reach the minimum in a single step for quadratic functions.
<em>Disadvantage</em>: Computing the inverse Hessian <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span> parameters is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span>, this is impossible.
<em>Approximations</em>: <strong>L-BFGS</strong> (Limited-memory Broyden–Fletcher–Goldfarb–Shanno) stores only a few recent gradients to approximate the Hessian and is widely used for smaller, non-stochastic optimization tasks.</p>
<h2 id="5-weight-initialization-the-starting-point">5. Weight Initialization: The Starting Point</h2>
<p>Optimization is sensitive to the starting point.</p>
<ul>
<li><strong>Problem of Symmetry</strong>: If all weights are zero, neurons in a layer will learn the exact same feature.</li>
<li><strong>Problem of Exploding/Vanishing Gradients</strong>: High variance leads to saturation; low variance leads to inactivity.</li>
</ul>
<h3 id="xavier-glorot-initialization">Xavier (Glorot) Initialization</h3>
<p>Designed for linear/tanh activations. It samples weights from a distribution with variance:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2902em;vertical-align:-0.4451em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h3 id="he-kaiming-initialization">He (Kaiming) Initialization</h3>
<p>Designed for ReLU activations. Since half of ReLU inputs are zeroed out, we need a larger variance:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2902em;vertical-align:-0.4451em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<astro-island uid="1FEsRA" prefix="r41" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is Adam&#39;s &#39;Bias Correction&#39; step necessary during the initial stages of training?&quot;],&quot;options&quot;:[1,[[0,&quot;To prevent weights from becoming negative.&quot;],[0,&quot;Because the moment vectors are initialized at zero, leading to a bias towards zero in the early updates.&quot;],[0,&quot;To ensure the learning rate is always increasing.&quot;],[0,&quot;To handle categorical features automatically.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;Since $m_0$ and $v_0$ are initialized to 0, their decaying averages are biased toward zero, especially during the first few time steps. The terms $1-\\beta^t$ correct this by boosting the values when $t$ is small.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is Adam&#x27;s &#x27;Bias Correction&#x27; step necessary during the initial stages of training?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To prevent weights from becoming negative.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because the moment vectors are initialized at zero, leading to a bias towards zero in the early updates.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To ensure the learning rate is always increasing.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To handle categorical features automatically.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="summary-selecting-an-optimizer">Summary: Selecting an Optimizer</h2>
<ul>
<li><strong>Adam / AdamW</strong>: Use as the default. AdamW fixes a weight decay bug in the original Adam and is standard for Transformers.</li>
<li><strong>SGD with Nesterov Momentum</strong>: Preferred for deep CNNs where generalized performance is more critical than training speed.</li>
<li><strong>L-BFGS</strong>: Use for small datasets where the full batch can fit in memory and you want extreme precision.</li>
<li><strong>Learning Rate Schedulers</strong>: Regardless of the optimizer, decreasing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span> over time (e.g., Cosine Annealing) is crucial for converging to the absolute minimum.</li>
</ul> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Model Evaluation: Statistical Reliability</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="why-accuracy-is-not-enough">Why Accuracy is Not Enough</h1>
<p>In machine learning, “accuracy” can be a deceptive metric, especially in unbalanced datasets. Imagine a dataset where 99% of people are healthy. A model that always predicts “Healthy” will have 99% accuracy but fails the 1% of sick individuals—the exact goal of the system. To build reliable systems, we must use metrics that reflect the cost of different types of errors.</p>
<h2 id="1-classification-metrics-the-confusion-matrix">1. Classification Metrics: The Confusion Matrix</h2>
<p>The Confusion Matrix is a table that describes the performance of a classification model.</p>




















<table><thead><tr><th style="text-align:left"></th><th style="text-align:left">Predicted Positive</th><th style="text-align:left">Predicted Negative</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Actual Positive</strong></td><td style="text-align:left">True Positive (TP)</td><td style="text-align:left">False Negative (FN)</td></tr><tr><td style="text-align:left"><strong>Actual Negative</strong></td><td style="text-align:left">False Positive (FP)</td><td style="text-align:left">True Negative (TN)</td></tr></tbody></table>
<ul>
<li><strong>Type I Error (False Positive)</strong>: Rejection of a true null hypothesis (“False Alarm”).</li>
<li><strong>Type II Error (False Negative)</strong>: Failure to reject a false null hypothesis (“Miss”).</li>
</ul>
<h3 id="precision-and-recall">Precision and Recall</h3>
<ul>
<li><strong>Precision</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">FP</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">TP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
<em>Goal</em>: Minimize false positives. (e.g., in Spam detection, we don’t want to mark a real email as spam).</li>
<li><strong>Recall (Sensitivity)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em">FN</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">TP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
<em>Goal</em>: Minimize false negatives. (e.g., in Cancer detection, we don’t want to miss a sick patient).</li>
</ul>
<h3 id="f1-score-the-harmonic-mean">F1-Score: The Harmonic Mean</h3>
<p>The F1-score balances the trade-off between Precision and Recall. Unlike the arithmetic mean, the <strong>harmonic mean</strong> penalizes extreme values; if either precision or recall is near zero, the F1-score will be low.
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2834em;vertical-align:-0.4033em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Precision</span></span><span class="mbin mtight">+</span><span class="mord text mtight"><span class="mord mtight">Recall</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Precision</span></span><span class="mbin mtight">⋅</span><span class="mord text mtight"><span class="mord mtight">Recall</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<astro-island uid="NuvAR" prefix="r42" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.metrics import confusion_matrix, classification_report\nimport pandas as pd\n\n# 1 = Disease, 0 = Healthy\ny_true = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]\ny_pred = [0, 0, 0, 0, 1, 1, 0, 1, 1, 1]\n\ncm = confusion_matrix(y_true, y_pred)\nprint(\&quot;Confusion Matrix:\&quot;)\nprint(pd.DataFrame(cm, columns=[&#39;Pred 0&#39;, &#39;Pred 1&#39;], index=[&#39;Actual 0&#39;, &#39;Actual 1&#39;]))\n\nprint(\&quot;\&quot;)\nprint(\&quot;Classification Report:\&quot;)\nprint(classification_report(y_true, y_pred))\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.metrics import confusion_matrix, classification_report
import pandas as pd

# 1 = Disease, 0 = Healthy
y_true = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]
y_pred = [0, 0, 0, 0, 1, 1, 0, 1, 1, 1]

cm = confusion_matrix(y_true, y_pred)
print(&quot;Confusion Matrix:&quot;)
print(pd.DataFrame(cm, columns=[&#x27;Pred 0&#x27;, &#x27;Pred 1&#x27;], index=[&#x27;Actual 0&#x27;, &#x27;Actual 1&#x27;]))

print(&quot;&quot;)
print(&quot;Classification Report:&quot;)
print(classification_report(y_true, y_pred))
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.metrics <span class="hl-keyword">import</span> confusion_matrix, classification_report</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> pandas <span class="hl-keyword">as</span> pd</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># 1 = Disease, 0 = Healthy</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">y_true <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">y_pred <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">cm <span class="hl-operator">=</span> confusion_matrix<span class="hl-bracket">(</span>y_true, y_pred<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Confusion Matrix:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>pd.DataFrame<span class="hl-bracket">(</span>cm, columns<span class="hl-operator">=</span><span class="hl-bracket">[</span><span class="hl-string">&#039;Pred 0&#039;</span>, <span class="hl-string">&#039;Pred 1&#039;</span><span class="hl-bracket">]</span>, index<span class="hl-operator">=</span><span class="hl-bracket">[</span><span class="hl-string">&#039;Actual 0&#039;</span>, <span class="hl-string">&#039;Actual 1&#039;</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Classification Report:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>classification_report<span class="hl-bracket">(</span>y_true, y_pred<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="2-discrimination-and-calibration-rocauc">2. Discrimination and Calibration (ROC/AUC)</h2>
<p>Models often output a probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>. A <strong>threshold</strong> (default 0.5) is applied to categorize it.</p>
<ul>
<li><strong>ROC Curve</strong>: Plots the True Positive Rate vs. False Positive Rate for all possible thresholds.</li>
<li><strong>AUC (Area Under the Curve)</strong>: Represents the probability that a random positive example is ranked higher than a random negative example. An AUC of 0.5 is random; 1.0 is perfect.</li>
</ul>
<h2 id="3-regression-metrics">3. Regression Metrics</h2>
<p>Measuring the distance between prediction <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span></span></span></span> and reality <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span>.</p>
<ol>
<li><strong>MAE (Mean Absolute Error)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mord">∣</span></span></span></span>. Robust to outliers.</li>
<li><strong>MSE (Mean Squared Error)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. Penalizes large errors heavily; differentiable.</li>
<li><strong>RMSE</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1133em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:0.833em"><span class="mord mathnormal" style="margin-right:0.05764em">MSE</span></span></span><span style="top:-2.8867em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em"><span></span></span></span></span></span></span></span></span>. Same unit as the target variable.</li>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> (Coefficient of Determination)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">TSS</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">RSS</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. The percentage of variance explained by the model. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> is perfect; <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> is equivalent to predicting the mean.</li>
</ol>
<h2 id="4-robust-validation-strategies">4. Robust Validation Strategies</h2>
<p>Evaluation on the training set is a “survival bias.” We need strategies to estimate generalization.</p>
<h3 id="the-hold-out-method">The Hold-out Method</h3>
<p>Splitting data into <strong>Train</strong>, <strong>Validation</strong>, and <strong>Test</strong> sets.</p>
<ul>
<li><strong>Train</strong>: Adjust weights <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span>.</li>
<li><strong>Validation</strong>: Tune hyperparameters (like <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span> in regularization).</li>
<li><strong>Test</strong>: Final estimation of performance. <strong>NEVER</strong> tune the model based on test results.</li>
</ul>
<h3 id="k-fold-cross-validation">K-Fold Cross-Validation</h3>
<p>To reduce the variance of the estimate, we split data into <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> folds.</p>
<ol>
<li>Hold out fold <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>.</li>
<li>Train on the remaining <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> folds.</li>
<li>Evaluate on fold <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>.</li>
<li>Repeat for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> and average.</li>
</ol>
<h3 id="stratified-k-fold">Stratified K-Fold</h3>
<p>Essential for imbalanced data. It ensures each fold has the same percentage of samples of each class as the original dataset.</p>
<astro-island uid="13qntm" prefix="r43" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import load_iris\n\ndata = load_iris()\nclf = RandomForestClassifier(n_estimators=10)\n\n# Perform 5-fold cross-validation\nscores = cross_val_score(clf, data.data, data.target, cv=5)\n\nprint(f\&quot;Accuracy per fold: {scores}\&quot;)\nprint(f\&quot;Mean Accuracy: {scores.mean():.4f} (+/- {scores.std() * 2:.4f})\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.model_selection import cross_val_score
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_iris

data = load_iris()
clf = RandomForestClassifier(n_estimators=10)

# Perform 5-fold cross-validation
scores = cross_val_score(clf, data.data, data.target, cv=5)

print(f&quot;Accuracy per fold: {scores}&quot;)
print(f&quot;Mean Accuracy: {scores.mean():.4f} (+/- {scores.std() * 2:.4f})&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.model_selection <span class="hl-keyword">import</span> cross_val_score</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.ensemble <span class="hl-keyword">import</span> RandomForestClassifier</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.datasets <span class="hl-keyword">import</span> load_iris</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">data <span class="hl-operator">=</span> load_iris<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">clf <span class="hl-operator">=</span> RandomForestClassifier<span class="hl-bracket">(</span>n_estimators<span class="hl-operator">=</span><span class="hl-number">10</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre"><span class="hl-comment"># Perform 5-fold cross-validation</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">scores <span class="hl-operator">=</span> cross_val_score<span class="hl-bracket">(</span>clf, data.data, data.target, cv<span class="hl-operator">=</span><span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Accuracy per fold: {scores}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Mean Accuracy: {scores.mean():.4f} (+/- {scores.std() * 2:.4f})&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="5-pitfalls-data-leakage">5. Pitfalls: Data Leakage</h2>
<p>Data leakage makes a model seem much better than it is by inadvertently using “future” or “test” information during training.</p>
<ul>
<li><strong>Scaling Leakage</strong>: Calculating the Mean/Std on the <em>entire</em> dataset before splitting. Correct way: Calculate on Train, apply to Test.</li>
<li><strong>Temporal Leakage</strong>: In time-series data, using data from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> to predict state at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>.</li>
<li><strong>Proxy Leakage</strong>: Including a feature that contains the answer (e.g., using “Patient ID” if IDs are assigned alphabetically by diagnosis).</li>
</ul>
<astro-island uid="1rEuDu" prefix="r44" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why might a model with an AUC of 0.95 still be poorly &#39;calibrated&#39;?&quot;],&quot;options&quot;:[1,[[0,&quot;AUC only measures the model&#39;s ability to rank examples, not whether the predicted probabilities correspond to real frequencies.&quot;],[0,&quot;AUC is only for regression models.&quot;],[0,&quot;The data might be scaled incorrectly.&quot;],[0,&quot;Calibration is the same thing as AUC.&quot;]]],&quot;answerIndex&quot;:[0,0],&quot;explanation&quot;:[0,&quot;AUC represents discrimination: how well the model separates classes. However, it doesn&#39;t care if the probability &#39;0.9&#39; actually means 90% of those cases are positive. A model could be perfectly discriminative (AUC=1.0) but say everyone has a probability of 0.51 vs 0.49. Calibration ensures probabilities reflect real-world risk.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why might a model with an AUC of 0.95 still be poorly &#x27;calibrated&#x27;?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">AUC only measures the model&#x27;s ability to rank examples, not whether the predicted probabilities correspond to real frequencies.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">AUC is only for regression models.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The data might be scaled incorrectly.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Calibration is the same thing as AUC.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="summary-checklist">Summary Checklist</h2>
<ul>
<li>Use <strong>Precision/Recall/F1</strong> for imbalanced classification.</li>
<li>Use <strong>MAE</strong> if your data has many outliers; use <strong>MSE</strong> if you need to penalize large errors heavily.</li>
<li>Use <strong>Stratified Cross-Validation</strong> to ensure your results are statistically sound.</li>
<li>Monitor the gap between <strong>Training Loss</strong> and <strong>Validation Loss</strong> to detect overfitting.</li>
<li>Check <strong>Correlation Matrices</strong> to identify potential data leakage before training.</li>
</ul> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Feature Engineering: The Art of Representation</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="data-is-the-raw-material">Data is the Raw Material</h1>
<p>In machine learning, “Garbage In, Garbage Out” is a fundamental law. Even the most advanced algorithms, like Deep Transformers or Gradient Boosting Systems, will fail if the underlying data representation is poor. <strong>Feature Engineering</strong> is the process of using domain knowledge and statistical techniques to transform raw data into features that maximize the predictive power of learning algorithms.</p>
<h2 id="1-feature-scaling-and-transformation">1. Feature Scaling and Transformation</h2>
<p>Many algorithms (SVM, K-Nearest Neighbors, Neural Networks) rely on distance metrics (e.g., Euclidean distance). If one feature has a range of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> and another has a range of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1000</span><span class="mclose">]</span></span></span></span>, the latter will dominate the model’s objective function.</p>
<h3 id="scaling-strategies">Scaling Strategies</h3>
<ul>
<li><strong>Min-Max Scaling (Normalization)</strong>: Rescales to a fixed range, typically <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>.
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
<em>Best for</em>: Neural networks and algorithms that don’t assume a specific distribution.</li>
<li><strong>Standardization (Z-score)</strong>: Rescales to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>.
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1994em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8544em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">σ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4461em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
<em>Best for</em>: Linear Regression, SVM, and PCA. It is significantly more robust to outliers than Min-Max.</li>
</ul>
<h3 id="non-linear-transformations">Non-linear Transformations</h3>
<ul>
<li><strong>Log Transform</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>. Used for highly skewed data (e.g., income, house prices) to compress the range and make the distribution more Gaussian.</li>
<li><strong>Box-Cox / Yeo-Johnson</strong>: Generalized power transforms used to stabilize variance and normalize data.</li>
</ul>
<astro-island uid="1COpp3" prefix="r45" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler\n\n# Data with an outlier\nnp.random.seed(0)\ndata = np.random.normal(10, 2, 100)\ndata = np.append(data, [100]) # Outlier\ndata = data.reshape(-1, 1)\n\nscaler_std = StandardScaler()\nscaler_minmax = MinMaxScaler()\n\nstd_scaled = scaler_std.fit_transform(data)\nminmax_scaled = scaler_minmax.fit_transform(data)\n\nplt.figure(figsize=(12, 4))\nplt.subplot(1, 3, 1)\nplt.hist(data, bins=20)\nplt.title(\&quot;Original (with Outlier)\&quot;)\n\nplt.subplot(1, 3, 2)\nplt.hist(std_scaled, bins=20, color=&#39;r&#39;)\nplt.title(\&quot;Standardized\&quot;)\n\nplt.subplot(1, 3, 3)\nplt.hist(minmax_scaled, bins=20, color=&#39;g&#39;)\nplt.title(\&quot;Min-Max (Crushed)\&quot;)\nplt.show()\n\nprint(f\&quot;Standardized Mean: {std_scaled.mean():.2f}, Std: {std_scaled.std():.2f}\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler, MinMaxScaler

# Data with an outlier
np.random.seed(0)
data = np.random.normal(10, 2, 100)
data = np.append(data, [100]) # Outlier
data = data.reshape(-1, 1)

scaler_std = StandardScaler()
scaler_minmax = MinMaxScaler()

std_scaled = scaler_std.fit_transform(data)
minmax_scaled = scaler_minmax.fit_transform(data)

plt.figure(figsize=(12, 4))
plt.subplot(1, 3, 1)
plt.hist(data, bins=20)
plt.title(&quot;Original (with Outlier)&quot;)

plt.subplot(1, 3, 2)
plt.hist(std_scaled, bins=20, color=&#x27;r&#x27;)
plt.title(&quot;Standardized&quot;)

plt.subplot(1, 3, 3)
plt.hist(minmax_scaled, bins=20, color=&#x27;g&#x27;)
plt.title(&quot;Min-Max (Crushed)&quot;)
plt.show()

print(f&quot;Standardized Mean: {std_scaled.mean():.2f}, Std: {std_scaled.std():.2f}&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> matplotlib.pyplot <span class="hl-keyword">as</span> plt</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.preprocessing <span class="hl-keyword">import</span> StandardScaler, MinMaxScaler</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Data with an outlier</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">0</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">data <span class="hl-operator">=</span> np.random.normal<span class="hl-bracket">(</span><span class="hl-number">10</span>, <span class="hl-number">2</span>, <span class="hl-number">100</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">data <span class="hl-operator">=</span> np.append<span class="hl-bracket">(</span>data, <span class="hl-bracket">[</span><span class="hl-number">100</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span> <span class="hl-comment"># Outlier</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">data <span class="hl-operator">=</span> data.reshape<span class="hl-bracket">(</span><span class="hl-flag">-1</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">scaler_std <span class="hl-operator">=</span> StandardScaler<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">scaler_minmax <span class="hl-operator">=</span> MinMaxScaler<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">std_scaled <span class="hl-operator">=</span> scaler_std.fit_transform<span class="hl-bracket">(</span>data<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">minmax_scaled <span class="hl-operator">=</span> scaler_minmax.fit_transform<span class="hl-bracket">(</span>data<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">plt.figure<span class="hl-bracket">(</span>figsize<span class="hl-operator">=</span><span class="hl-bracket">(</span><span class="hl-number">12</span>, <span class="hl-number">4</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">plt.subplot<span class="hl-bracket">(</span><span class="hl-number">1</span>, <span class="hl-number">3</span>, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">plt.hist<span class="hl-bracket">(</span>data, bins<span class="hl-operator">=</span><span class="hl-number">20</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Original (with Outlier)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">plt.subplot<span class="hl-bracket">(</span><span class="hl-number">1</span>, <span class="hl-number">3</span>, <span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">plt.hist<span class="hl-bracket">(</span>std_scaled, bins<span class="hl-operator">=</span><span class="hl-number">20</span>, color<span class="hl-operator">=</span><span class="hl-string">&#039;r&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Standardized&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">plt.subplot<span class="hl-bracket">(</span><span class="hl-number">1</span>, <span class="hl-number">3</span>, <span class="hl-number">3</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">plt.hist<span class="hl-bracket">(</span>minmax_scaled, bins<span class="hl-operator">=</span><span class="hl-number">20</span>, color<span class="hl-operator">=</span><span class="hl-string">&#039;g&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">plt.title<span class="hl-bracket">(</span><span class="hl-string">&quot;Min-Max (Crushed)&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">plt.<span class="hl-function">show</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Standardized Mean: {std_scaled.mean():.2f}, Std: {std_scaled.std():.2f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="2-categorical-variable-encoding">2. Categorical Variable Encoding</h2>
<p>Algorithms require numerical input. Categorical data (text labels) must be encoded into numbers.</p>
<ul>
<li><strong>Ordinal Encoding</strong>: Assigns an integer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">]</span></span></span></span>. Use only when there is a natural order (e.g., “Cold”, “Warm”, “Hot”).</li>
<li><strong>One-Hot Encoding</strong>: Creates <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> binary columns for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> categories.
<em>Issue</em>: It can create high-dimensional “sparse” matrices (the “curse of dimensionality”).</li>
<li><strong>Frequency / Count Encoding</strong>: Replaces the name with the percentage of times it appears in the dataset.</li>
<li><strong>Target Encoding</strong>: Replaces a category with the mean of the target variable for that category.
<em>Warning</em>: This is extremely powerful but leads to massive <strong>Target Leakage</strong> if not performed correctly inside cross-validation loops.</li>
</ul>
<h2 id="3-handling-missing-data-imputation">3. Handling Missing Data (Imputation)</h2>
<p>A missing value is an “informational gap.” How you fill it changes the bias of your model.</p>
<ol>
<li><strong>Univariate Imputation</strong>: Replace with Mean (for Gaussian data) or Median (for skewed data). For categorical data, use the “Most Frequent” value.</li>
<li><strong>Multivariate Imputation (MICE)</strong>: Uses other attributes to estimate the missing value. For example, use “Education Level” and “Job Title” to predict a missing “Salary” value.</li>
<li><strong>Indicator Variables</strong>: Create a binary column <code>is_missing_X</code>. Sometimes the fact that data is missing is itself a strong predictor.</li>
</ol>
<h2 id="4-interaction-and-polynomial-features">4. Interaction and Polynomial Features</h2>
<p>A linear model <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> cannot capture interactions. Imagine a model predicting health where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is “Sugar Intake” and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is “Exercise”. The effect of sugar is likely amplified by the lack of exercise.</p>
<p><strong>Interaction Terms</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>.
<strong>Polynomial Features</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span></span></span></span>.
These allow linear models to project data into higher-dimensional spaces where they can learn non-linear boundaries.</p>
<h2 id="5-automated-feature-selection">5. Automated Feature Selection</h2>
<p>Adding features is easy; pruning them is hard.</p>
<ul>
<li><strong>Filter Methods</strong>: Use statistical scores (ANOVA, Chi-square, Mutual Information) to select features independent of any model. They are fast but may miss interaction effects.</li>
<li><strong>Wrapper Methods</strong>: Use a model to repeatedly evaluate features (e.g., Recursive Feature Elimination). Very accurate but computationally expensive.</li>
<li><strong>Embedded Methods</strong>: Features are selected during training. Examples include <strong>Lasso (L1) Regression</strong> and <strong>Feature Importance</strong> in Random Forests.</li>
</ul>
<astro-island uid="8yBEy" prefix="r46" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;When would you use a Log Transformation on a feature?&quot;],&quot;options&quot;:[1,[[0,&quot;When the feature has a perfectly normal distribution.&quot;],[0,&quot;When the feature spans several orders of magnitude and is highly right-skewed (e.g., population sizes).&quot;],[0,&quot;To convert categorical data into numerical data.&quot;],[0,&quot;To increase the weight of outliers.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;Logarithms &#39;compress&#39; large values and &#39;expand&#39; small values. For data like income, where most people earn under $100k but some earn millions, a log transform makes the differences in the lower ranges more apparent to the model and reduces the sensitivity to the extreme outliers.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">When would you use a Log Transformation on a feature?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">When the feature has a perfectly normal distribution.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">When the feature spans several orders of magnitude and is highly right-skewed (e.g., population sizes).</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To convert categorical data into numerical data.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To increase the weight of outliers.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="summary-the-feature-engineering-workflow">Summary: The Feature Engineering Workflow</h2>
<ol>
<li><strong>Explore</strong>: Use histograms and correlation matrices to identify skewness and redundancy.</li>
<li><strong>Scale</strong>: Apply appropriate scaling (Standardization is usually safer).</li>
<li><strong>Encode</strong>: Transform categories (One-Hot for low cardinality; Target/Binary for high cardinality).</li>
<li><strong>Iterate</strong>: Create interaction terms, evaluate performance, and use feature selection to remove noise.</li>
<li><strong>Leakage Check</strong>: Ensure that statistics (like mean/std) for scaling are calculated <em>only</em> on the training set and applied to the test set to avoid data leakage.</li>
</ol> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Algorithms</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Naive Bayes: Probabilistic Inference</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-power-of-probabilistic-inference">The Power of Probabilistic Inference</h1>
<p>In the realm of machine learning, most algorithms seek to find a boundary (Discriminative models). Naive Bayes takes a different approach: it models the distribution of the data itself (Generative models). By understanding the probability of features appearing in each class, it can infer the most likely class for a new, unseen instance.</p>
<h2 id="foundation-bayes-theorem">Foundation: Bayes’ Theorem</h2>
<p>Bayes’ theorem is the cornerstone of conditional probability. It provides a way to update our beliefs (priors) based on new evidence.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>When applied to classification, we want to find the probability of a class <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> given a set of features <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">…</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">…</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<ul>
<li><strong>Posterior <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mclose">)</span></span></span></span></strong>: The probability of the class given the data. This is our prediction.</li>
<li><strong>Likelihood <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></strong>: The probability of observing these features if we are already in class <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span>.</li>
<li><strong>Prior <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></strong>: The baseline probability of the class before seeing any data (e.g., <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em"></span><span class="mord">1%</span></span></span></span> of emails are spam).</li>
<li><strong>Evidence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mclose">)</span></span></span></span></strong>: The probability of the data occurring under any class. Since this is constant for all classes we compare, we often ignore it during optimization.</li>
</ul>
<h2 id="the-naive-assumption-independence">The “Naive” Assumption: Independence</h2>
<p>The “Likelihood” term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span> is mathematically complex because it requires knowing the joint interaction between all features. If we have 100 features, we would need a massive dataset to estimate every possible combination.</p>
<p>Naive Bayes bypasses this by making a “Naive” assumption: <strong>All features are conditionally independent given the class.</strong></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></p>
<p>While almost certainly false in reality (e.g., in text, the word “New” is highly dependent on the word “York”), this simplification allows the algorithm to work with limited data and scale linearly with the number of features.</p>
<h2 id="classification-rule-maximum-a-posteriori-map">Classification Rule: Maximum A Posteriori (MAP)</h2>
<p>To classify a new sample, we calculate the product of the prior and all individual likelihoods for every class <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span>:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1944em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></p>
<h3 id="the-log-space-trick">The Log-Space Trick</h3>
<p>In practice, multiplying many small probabilities can lead to <strong>floating-point underflow</strong> (the result becomes 0). To solve this, we compute the sum of logarithms instead:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">))</span></span></span></span></p>
<h2 id="variations-of-naive-bayes">Variations of Naive Bayes</h2>
<p>The algorithm differs based on how the individual likelihood <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span> is calculated.</p>
<h3 id="1-gaussian-naive-bayes">1. Gaussian Naive Bayes</h3>
<p>Used when features are continuous. It assumes that features within a class follow a Normal (Gaussian) distribution:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.9796em;vertical-align:-0.8296em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.5267em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9476em"><span class="svg-align" style="top:-3.4286em"><span class="pstrut" style="height:3.4286em"></span><span class="mord mtight" style="padding-left:1.19em"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4249em"><span></span></span></span></span></span></span></span></span><span style="top:-2.9196em"><span class="pstrut" style="height:3.4286em"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5429em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.5429em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5089em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8296em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1312em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4249em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.5073em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6424em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span></span></span></span></p>
<h3 id="2-multinomial-naive-bayes">2. Multinomial Naive Bayes</h3>
<p>The standard for text classification. It uses discrete word counts. It models the data as being generated by a multinomial distribution—essentially a multi-sided die roll for each word.</p>
<h3 id="3-bernoulli-naive-bayes">3. Bernoulli Naive Bayes</h3>
<p>Used for binary features (Yes/No). In text, it ignores how many times a word appears and only considers if it appears at least once.</p>
<astro-island uid="1lry0z" prefix="r47" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nfrom sklearn.naive_bayes import GaussianNB\n\n# Features: [Height (ft), Weight (lbs), Foot Size (in)]\nX = np.array([[6, 180, 12], [5.9, 190, 11], [5.2, 120, 7], [5.5, 145, 9]])\n# Labels: 0 = Male, 1 = Female\ny = np.array([0, 0, 1, 1])\n\ngnb = GaussianNB()\ngnb.fit(X, y)\n\n# Predict for a new person: [5.8, 150, 10]\nprediction = gnb.predict([[5.8, 150, 10]])\nprob = gnb.predict_proba([[5.8, 150, 10]])\n\nprint(f\&quot;Predicted Class: {&#39;Female&#39; if prediction[0] == 1 else &#39;Male&#39;}\&quot;)\nprint(f\&quot;Probabilities (Male, Female): {prob[0]}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Predicted Class: Female\nProbabilities (Male, Female): [0.22... 0.77...]&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
from sklearn.naive_bayes import GaussianNB

# Features: [Height (ft), Weight (lbs), Foot Size (in)]
X = np.array([[6, 180, 12], [5.9, 190, 11], [5.2, 120, 7], [5.5, 145, 9]])
# Labels: 0 = Male, 1 = Female
y = np.array([0, 0, 1, 1])

gnb = GaussianNB()
gnb.fit(X, y)

# Predict for a new person: [5.8, 150, 10]
prediction = gnb.predict([[5.8, 150, 10]])
prob = gnb.predict_proba([[5.8, 150, 10]])

print(f&quot;Predicted Class: {&#x27;Female&#x27; if prediction[0] == 1 else &#x27;Male&#x27;}&quot;)
print(f&quot;Probabilities (Male, Female): {prob[0]}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.naive_bayes <span class="hl-keyword">import</span> GaussianNB</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># Features: [Height (ft), Weight (lbs), Foot Size (in)]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">X <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">6</span>, <span class="hl-number">180</span>, <span class="hl-number">12</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">5</span>.<span class="hl-number">9</span>, <span class="hl-number">190</span>, <span class="hl-number">11</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">5</span>.<span class="hl-number">2</span>, <span class="hl-number">120</span>, <span class="hl-number">7</span><span class="hl-bracket">]</span>, <span class="hl-bracket">[</span><span class="hl-number">5</span>.<span class="hl-number">5</span>, <span class="hl-number">145</span>, <span class="hl-number">9</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># Labels: 0 = Male, 1 = Female</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">y <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">gnb <span class="hl-operator">=</span> GaussianNB<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">gnb.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre"><span class="hl-comment"># Predict for a new person: [5.8, 150, 10]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">prediction <span class="hl-operator">=</span> gnb.predict<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">5</span>.<span class="hl-number">8</span>, <span class="hl-number">150</span>, <span class="hl-number">10</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">prob <span class="hl-operator">=</span> gnb.predict_proba<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-bracket">[</span><span class="hl-number">5</span>.<span class="hl-number">8</span>, <span class="hl-number">150</span>, <span class="hl-number">10</span><span class="hl-bracket">]</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Predicted Class: {&#039;Female&#039; if prediction[0] == 1 else &#039;Male&#039;}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Probabilities (Male, Female): {prob[0]}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="laplace-smoothing-the-zero-frequency-problem">Laplace Smoothing: The “Zero Frequency” Problem</h2>
<p>If a feature (e.g., the word “Viagra”) never appeared in the training set for a particular class (e.g., “Not Spam”), then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord">&quot;</span><span class="mord mathnormal">Via</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">a</span><span class="mord">&quot;∣&quot;</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">tSp</span><span class="mord mathnormal">am</span><span class="mord">&quot;</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>. Because we multiply probabilities, this single zero makes the entire posterior <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, effectively “vetoing” the class regardless of other evidence.</p>
<p>We solve this using <strong>Laplace Smoothing</strong> (Additive Smoothing) by adding a small constant <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span> (typically 1) to all counts:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.0037em">α</span><span class="mbin mtight">⋅</span><span class="mopen mtight">(</span><span class="mord text mtight"><span class="mord mtight">number of features</span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.0037em">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h2 id="implementing-naive-bayes-from-scratch-text">Implementing Naive Bayes from Scratch (Text)</h2>
<p>Let’s look at the core logic for a simple Spam Classifier.</p>
<astro-island uid="lIAKJ" prefix="r48" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from collections import defaultdict\nimport math\n\nclass SimpleNaiveBayes:\n  def fit(self, docs, labels):\n      self.priors = {l: sum(1 for label in labels if label == l)/len(labels) for l in set(labels)}\n      self.word_counts = defaultdict(lambda: defaultdict(int))\n      self.class_totals = defaultdict(int)\n      self.vocab = set()\n\n      for doc, label in zip(docs, labels):\n          for word in doc.split():\n              self.word_counts[label][word] += 1\n              self.class_totals[label] += 1\n              self.vocab.add(word)\n\n  def predict(self, doc):\n      scores = {}\n      for label in self.priors:\n          # Start with log prior\n          log_prob = math.log(self.priors[label])\n          for word in doc.split():\n              # Likelihood with Laplace Smoothing\n              count = self.word_counts[label][word]\n              prob = (count + 1) / (self.class_totals[label] + len(self.vocab))\n              log_prob += math.log(prob)\n          scores[label] = log_prob\n      return max(scores, key=scores.get)\n\n# Training data\nX = [\&quot;get cheap prize\&quot;, \&quot;meeting at five\&quot;, \&quot;prize money win\&quot;, \&quot;hello friend\&quot;]\ny = [\&quot;spam\&quot;, \&quot;ham\&quot;, \&quot;spam\&quot;, \&quot;ham\&quot;]\n\nnb = SimpleNaiveBayes()\nnb.fit(X, y)\nprint(f\&quot;Prediction for &#39;win prize&#39;: {nb.predict(&#39;win prize&#39;)}\&quot;)&quot;],&quot;output&quot;:[0,&quot;Prediction for &#39;win prize&#39;: spam&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from collections import defaultdict
import math

class SimpleNaiveBayes:
  def fit(self, docs, labels):
      self.priors = {l: sum(1 for label in labels if label == l)/len(labels) for l in set(labels)}
      self.word_counts = defaultdict(lambda: defaultdict(int))
      self.class_totals = defaultdict(int)
      self.vocab = set()

      for doc, label in zip(docs, labels):
          for word in doc.split():
              self.word_counts[label][word] += 1
              self.class_totals[label] += 1
              self.vocab.add(word)

  def predict(self, doc):
      scores = {}
      for label in self.priors:
          # Start with log prior
          log_prob = math.log(self.priors[label])
          for word in doc.split():
              # Likelihood with Laplace Smoothing
              count = self.word_counts[label][word]
              prob = (count + 1) / (self.class_totals[label] + len(self.vocab))
              log_prob += math.log(prob)
          scores[label] = log_prob
      return max(scores, key=scores.get)

# Training data
X = [&quot;get cheap prize&quot;, &quot;meeting at five&quot;, &quot;prize money win&quot;, &quot;hello friend&quot;]
y = [&quot;spam&quot;, &quot;ham&quot;, &quot;spam&quot;, &quot;ham&quot;]

nb = SimpleNaiveBayes()
nb.fit(X, y)
print(f&quot;Prediction for &#x27;win prize&#x27;: {nb.predict(&#x27;win prize&#x27;)}&quot;)</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> collections <span class="hl-keyword">import</span> defaultdict</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> math</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-keyword">class</span> SimpleNaiveBayes:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> fit<span class="hl-bracket">(</span>self, docs, labels<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">      self.priors <span class="hl-operator">=</span> <span class="hl-bracket">{</span>l: <span class="hl-function">sum</span><span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-keyword">for</span> label <span class="hl-keyword">in</span> labels <span class="hl-keyword">if</span> label <span class="hl-operator">==</span> l<span class="hl-bracket">)</span><span class="hl-operator">/</span><span class="hl-function">len</span><span class="hl-bracket">(</span>labels<span class="hl-bracket">)</span> <span class="hl-keyword">for</span> l <span class="hl-keyword">in</span> <span class="hl-keyword">set</span><span class="hl-bracket">(</span>labels<span class="hl-bracket">)</span><span class="hl-bracket">}</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">      self.word_counts <span class="hl-operator">=</span> defaultdict<span class="hl-bracket">(</span><span class="hl-keyword">lambda</span>: defaultdict<span class="hl-bracket">(</span><span class="hl-type">int</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">      self.class_totals <span class="hl-operator">=</span> defaultdict<span class="hl-bracket">(</span><span class="hl-type">int</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">      self.vocab <span class="hl-operator">=</span> <span class="hl-keyword">set</span><span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> doc, label <span class="hl-keyword">in</span> <span class="hl-function">zip</span><span class="hl-bracket">(</span>docs, labels<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">          <span class="hl-keyword">for</span> word <span class="hl-keyword">in</span> doc.split<span class="hl-bracket">(</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">              self.word_counts<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span><span class="hl-bracket">[</span>word<span class="hl-bracket">]</span> <span class="hl-operator">+</span><span class="hl-operator">=</span> <span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">              self.class_totals<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span> <span class="hl-operator">+</span><span class="hl-operator">=</span> <span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">              self.vocab.<span class="hl-function">add</span><span class="hl-bracket">(</span>word<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">  <span class="hl-keyword">def</span> predict<span class="hl-bracket">(</span>self, doc<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">      scores <span class="hl-operator">=</span> <span class="hl-bracket">{</span><span class="hl-bracket">}</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> label <span class="hl-keyword">in</span> self.priors:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">          <span class="hl-comment"># Start with log prior</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">          log_prob <span class="hl-operator">=</span> math.<span class="hl-function">log</span><span class="hl-bracket">(</span>self.priors<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">          <span class="hl-keyword">for</span> word <span class="hl-keyword">in</span> doc.split<span class="hl-bracket">(</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">              <span class="hl-comment"># Likelihood with Laplace Smoothing</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">              count <span class="hl-operator">=</span> self.word_counts<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span><span class="hl-bracket">[</span>word<span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">              prob <span class="hl-operator">=</span> <span class="hl-bracket">(</span>count <span class="hl-operator">+</span> <span class="hl-number">1</span><span class="hl-bracket">)</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span>self.class_totals<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span> <span class="hl-operator">+</span> <span class="hl-function">len</span><span class="hl-bracket">(</span>self.vocab<span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">              log_prob <span class="hl-operator">+</span><span class="hl-operator">=</span> math.<span class="hl-function">log</span><span class="hl-bracket">(</span>prob<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">          scores<span class="hl-bracket">[</span>label<span class="hl-bracket">]</span> <span class="hl-operator">=</span> log_prob</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">      <span class="hl-keyword">return</span> <span class="hl-function">max</span><span class="hl-bracket">(</span>scores, key<span class="hl-operator">=</span>scores.get<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre"><span class="hl-comment"># Training data</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre">X <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-string">&quot;get cheap prize&quot;</span>, <span class="hl-string">&quot;meeting at five&quot;</span>, <span class="hl-string">&quot;prize money win&quot;</span>, <span class="hl-string">&quot;hello friend&quot;</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre">y <span class="hl-operator">=</span> <span class="hl-bracket">[</span><span class="hl-string">&quot;spam&quot;</span>, <span class="hl-string">&quot;ham&quot;</span>, <span class="hl-string">&quot;spam&quot;</span>, <span class="hl-string">&quot;ham&quot;</span><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre">nb <span class="hl-operator">=</span> SimpleNaiveBayes<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre">nb.fit<span class="hl-bracket">(</span>X, y<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">36</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Prediction for &#039;win prize&#039;: {nb.predict(&#039;win prize&#039;)}&quot;</span><span class="hl-bracket">)</span></span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="strengths-and-weaknesses">Strengths and Weaknesses</h2>
<h3 id="advantages">Advantages</h3>
<ol>
<li><strong>Incredible Speed</strong>: Training involves a single pass over the data to count occurrences.</li>
<li><strong>Low Data Requirement</strong>: Works well even with small training datasets if the independence assumption holds reasonably well.</li>
<li><strong>Decoupled Parameters</strong>: Each feature probability can be estimated independently, avoiding the “curse of dimensionality” better than many other models.</li>
</ol>
<h3 id="disadvantages">Disadvantages</h3>
<ol>
<li><strong>Naive Assumption</strong>: In reality, features are almost always correlated, which can lead to overconfident or biased predictions.</li>
<li><strong>Zero Frequency</strong>: Requires smoothing to handle unseen features.</li>
<li><strong>Generative Limits</strong>: While great at ranking classes, the actual probability scores (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.999</span></span></span></span>) are often inaccurate because of the correlation bias.</li>
</ol>
<astro-island uid="ZhPY5y" prefix="r49" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is Naive Bayes often the &#39;baseline&#39; model for text classification?&quot;],&quot;options&quot;:[1,[[0,&quot;It is more accurate than Deep Learning.&quot;],[0,&quot;It is computationally cheap, handles high-dimensional sparse data like word counts perfectly, and is hard to beat for simple tasks.&quot;],[0,&quot;It requires no data cleaning.&quot;],[0,&quot;It automatically learns the relationship between words.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;Text data involves thousands of features (vocabulary size). While complex models might overfit, the linear complexity and independence assumption of Naive Bayes make it extremely robust and fast for categorizing text.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is Naive Bayes often the &#x27;baseline&#x27; model for text classification?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It is more accurate than Deep Learning.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It is computationally cheap, handles high-dimensional sparse data like word counts perfectly, and is hard to beat for simple tasks.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It requires no data cleaning.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">It automatically learns the relationship between words.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="conclusion">Conclusion</h2>
<p>Naive Bayes proves that sometimes, simpler is better. By ignoring complexity and focusing on the pure probabilistic likelihood of features, it creates a robust classifier that remains a production standard for spam detection and real-time sentiment analysis. It serves as a vital reminder that understanding your data’s distribution is often as powerful as finding a complex decision boundary.</p> </div> </div> </div><div class="module-group"> <div class="page-break-before h-64 flex items-end pb-12 border-b-[12px] border-slate-900 mb-20"> <h2 class="text-6xl font-black uppercase tracking-tighter text-slate-900 leading-none">Applications</h2> </div> <div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Recommender Systems: Latent Factor Models</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-matching-problem">The Matching Problem</h1>
<p>Recommender systems are algorithms designed to bridge the gap between a massive catalog of items and a specific user’s intent. They transform a retrieval problem into a ranking problem. These systems are typically classified by whether they leverage item characteristics (<strong>Content-Based</strong>) or user behavior (<strong>Collaborative Filtering</strong>).</p>
<h2 id="1-content-based-filtering">1. Content-Based Filtering</h2>
<p>Content-based systems suggest items similar to those a user has liked in the past. It treats the problem as a high-dimensional similarity search.</p>
<ol>
<li><strong>Item Profiling</strong>: Items are represented as feature vectors (e.g., TF-IDF of movie descriptions, genre flags, or metadata).</li>
<li><strong>User Profiling</strong>: A user vector is generated by averaging the vectors of items they have highly rated.</li>
<li><strong>Similarity Casting</strong>: The system calculates the <strong>Cosine Similarity</strong> between the User Profile <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">U</span></span></span></span> and candidate Item Profiles <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span></span></span></span>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">sim</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3923em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="mord mtight">∥∥</span><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span><span class="mord mtight">∥</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.8677em;vertical-align:-0.8296em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0381em"><span style="top:-2.5275em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9464em"><span class="svg-align" style="top:-3.4286em"><span class="pstrut" style="height:3.4286em"></span><span class="mord mtight" style="padding-left:1.19em"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em">∑</span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em"><span style="top:-2.1528em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-2.8448em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4861em"><span></span></span></span></span></span></span></span></span><span style="top:-2.9184em"><span class="pstrut" style="height:3.4286em"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5429em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.5429em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5102em"><span></span></span></span></span></span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9464em"><span class="svg-align" style="top:-3.4286em"><span class="pstrut" style="height:3.4286em"></span><span class="mord mtight" style="padding-left:1.19em"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em">∑</span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em"><span style="top:-2.1528em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-2.8448em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4861em"><span></span></span></span></span></span></span></span></span><span style="top:-2.9184em"><span class="pstrut" style="height:3.4286em"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5429em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.5429em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5102em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.5131em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em">∑</span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8296em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ol>
<ul>
<li><strong>Pros</strong>: Independent of other users; can recommend extremely niche items.</li>
<li><strong>Cons</strong>: “Overspecialization”—the system cannot recommend items outside the user’s explicit past interests.</li>
</ul>
<h2 id="2-collaborative-filtering-cf">2. Collaborative Filtering (CF)</h2>
<p>Collaborative filtering operates on the “wisdom of the crowd.” It ignores item metadata and focuses entirely on the <strong>User-Item Interaction Matrix</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span>.</p>
<h3 id="neighborhood-based-methods">Neighborhood-Based Methods</h3>
<ul>
<li><strong>User-User CF</strong>: “Users who are similar to you also liked…” It calculates similarity between rows of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span>.</li>
<li><strong>Item-Item CF</strong>: “Users who liked this item also liked…” It calculates similarity between columns of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span>. Item-item is generally more stable and computationally efficient because the set of items changes more slowly than the set of users.</li>
</ul>
<h3 id="the-problem-of-sparsity">The Problem of Sparsity</h3>
<p>In a real-world system (e.g., Amazon), the interaction matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span> is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em"></span><span class="mord">99.9%</span></span></span></span> sparse. Most users only rate a handful of items. Traditional neighborhood methods struggle when there isn’t enough overlap between users to calculate meaningful similarity.</p>
<h2 id="3-matrix-factorization-latent-factor-models">3. Matrix Factorization (Latent Factor Models)</h2>
<p>Matrix Factorization (MF) solves the sparsity problem by assuming that user-item interactions can be explained by a small number of <strong>Latent Factors</strong>.</p>
<p>We decompose the sparse matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span> (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>) into two lower-rank matrices: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> (User Factors, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>) and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> (Item Factors, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>).
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>Each of the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> dimensions represents a hidden concept. For movies, a latent factor might automatically represent “Level of Action” or “Art-house aesthetic,” even if those labels are never explicitly provided.</p>
<h3 id="optimization-object">Optimization Object</h3>
<p>We learn <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> by minimizing the squared error on <strong>known</strong> ratings, with L2 regularization to prevent overfitting to the sparse data:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.4747em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">Q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">κ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<astro-island uid="ZGQY7W" prefix="r50" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\n# User-Item Matrix (5 users, 4 items)\n# 0 represents an unknown rating\nR = np.array([\n  [5, 3, 0, 1],\n  [4, 0, 0, 1],\n  [1, 1, 0, 5],\n  [1, 0, 0, 4],\n  [0, 1, 5, 4],\n])\n\ndef matrix_factorization(R, K, steps=2000, alpha=0.002, beta=0.02):\n  N, M = R.shape\n  P = np.random.rand(N, K)\n  Q = np.random.rand(M, K)\n  \n  for step in range(steps):\n      for i in range(N):\n          for j in range(M):\n              if R[i, j] &gt; 0: # Only optimize for known ratings\n                  eij = R[i, j] - np.dot(P[i,:], Q[j,:].T)\n                  for k in range(K):\n                      P[i,k] += alpha * (2 * eij * Q[j,k] - beta * P[i,k])\n                      Q[j,k] += alpha * (2 * eij * P[i,k] - beta * Q[j,k])\n  return P, Q\n\nP, Q = matrix_factorization(R, K=2)\nR_hat = np.dot(P, Q.T)\n\nprint(\&quot;Original Matrix (with zeros):\&quot;)\nprint(R)\nprint(\&quot;\&quot;)\nprint(\&quot;Predicted Matrix (Reconstructed):\&quot;)\nprint(np.round(R_hat, 2))\n# Notice how the 0 at R[0,2] is now predicted.\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

# User-Item Matrix (5 users, 4 items)
# 0 represents an unknown rating
R = np.array([
  [5, 3, 0, 1],
  [4, 0, 0, 1],
  [1, 1, 0, 5],
  [1, 0, 0, 4],
  [0, 1, 5, 4],
])

def matrix_factorization(R, K, steps=2000, alpha=0.002, beta=0.02):
  N, M = R.shape
  P = np.random.rand(N, K)
  Q = np.random.rand(M, K)
  
  for step in range(steps):
      for i in range(N):
          for j in range(M):
              if R[i, j] &gt; 0: # Only optimize for known ratings
                  eij = R[i, j] - np.dot(P[i,:], Q[j,:].T)
                  for k in range(K):
                      P[i,k] += alpha * (2 * eij * Q[j,k] - beta * P[i,k])
                      Q[j,k] += alpha * (2 * eij * P[i,k] - beta * Q[j,k])
  return P, Q

P, Q = matrix_factorization(R, K=2)
R_hat = np.dot(P, Q.T)

print(&quot;Original Matrix (with zeros):&quot;)
print(R)
print(&quot;&quot;)
print(&quot;Predicted Matrix (Reconstructed):&quot;)
print(np.round(R_hat, 2))
# Notice how the 0 at R[0,2] is now predicted.
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-comment"># User-Item Matrix (5 users, 4 items)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># 0 represents an unknown rating</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">R <span class="hl-operator">=</span> np.array<span class="hl-bracket">(</span><span class="hl-bracket">[</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">5</span>, <span class="hl-number">3</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">4</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">5</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-number">4</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">  <span class="hl-bracket">[</span><span class="hl-number">0</span>, <span class="hl-number">1</span>, <span class="hl-number">5</span>, <span class="hl-number">4</span><span class="hl-bracket">]</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre"><span class="hl-keyword">def</span> matrix_factorization<span class="hl-bracket">(</span>R, K, steps<span class="hl-operator">=</span><span class="hl-number">2000</span>, alpha<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">002</span>, beta<span class="hl-operator">=</span><span class="hl-number">0</span>.<span class="hl-number">02</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">  N, M <span class="hl-operator">=</span> R.shape</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">  P <span class="hl-operator">=</span> np.random.rand<span class="hl-bracket">(</span>N, K<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">  Q <span class="hl-operator">=</span> np.random.rand<span class="hl-bracket">(</span>M, K<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">  <span class="hl-keyword">for</span> step <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>steps<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">      <span class="hl-keyword">for</span> i <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>N<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">          <span class="hl-keyword">for</span> j <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>M<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">              <span class="hl-keyword">if</span> R<span class="hl-bracket">[</span>i, j<span class="hl-bracket">]</span> <span class="hl-operator">&gt;</span> <span class="hl-number">0</span>: <span class="hl-comment"># Only optimize for known ratings</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">                  eij <span class="hl-operator">=</span> R<span class="hl-bracket">[</span>i, j<span class="hl-bracket">]</span> <span class="hl-flag">-</span> np.dot<span class="hl-bracket">(</span>P<span class="hl-bracket">[</span>i,:<span class="hl-bracket">]</span>, Q<span class="hl-bracket">[</span>j,:<span class="hl-bracket">]</span>.T<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">                  <span class="hl-keyword">for</span> k <span class="hl-keyword">in</span> <span class="hl-function">range</span><span class="hl-bracket">(</span>K<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">                      P<span class="hl-bracket">[</span>i,k<span class="hl-bracket">]</span> <span class="hl-operator">+</span><span class="hl-operator">=</span> alpha <span class="hl-operator">*</span> <span class="hl-bracket">(</span><span class="hl-number">2</span> <span class="hl-operator">*</span> eij <span class="hl-operator">*</span> Q<span class="hl-bracket">[</span>j,k<span class="hl-bracket">]</span> <span class="hl-flag">-</span> beta <span class="hl-operator">*</span> P<span class="hl-bracket">[</span>i,k<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">                      Q<span class="hl-bracket">[</span>j,k<span class="hl-bracket">]</span> <span class="hl-operator">+</span><span class="hl-operator">=</span> alpha <span class="hl-operator">*</span> <span class="hl-bracket">(</span><span class="hl-number">2</span> <span class="hl-operator">*</span> eij <span class="hl-operator">*</span> P<span class="hl-bracket">[</span>i,k<span class="hl-bracket">]</span> <span class="hl-flag">-</span> beta <span class="hl-operator">*</span> Q<span class="hl-bracket">[</span>j,k<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> P, Q</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">P, Q <span class="hl-operator">=</span> matrix_factorization<span class="hl-bracket">(</span>R, K<span class="hl-operator">=</span><span class="hl-number">2</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">R_hat <span class="hl-operator">=</span> np.dot<span class="hl-bracket">(</span>P, Q.T<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">30</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">31</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Original Matrix (with zeros):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">32</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>R<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">33</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">34</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Predicted Matrix (Reconstructed):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">35</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>np.round<span class="hl-bracket">(</span>R_hat, <span class="hl-number">2</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">36</span><span class="whitespace-pre"><span class="hl-comment"># Notice how the 0 at R[0,2] is now predicted.</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">37</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="4-the-cold-start-challenge">4. The Cold Start Challenge</h2>
<p>Matrix Factorization and Collaborative Filtering fail for:</p>
<ul>
<li><strong>New Users</strong>: No history to calculate similarity or latent factors.</li>
<li><strong>New Items</strong>: No interactions from users to map it into the latent space.</li>
</ul>
<p><strong>Solutions</strong>:</p>
<ul>
<li><strong>Exploration</strong>: Show popular items or a diverse set of items to gather initial signal.</li>
<li><strong>Metadata Hybridization</strong>: Use Content-Based methods for new items (mapping them to the latent space based on descriptions).</li>
<li><strong>Demographic Information</strong>: Use age/location to group new users until behavior-based data is available.</li>
</ul>
<h2 id="5-evaluation-metrics">5. Evaluation Metrics</h2>
<p>How do we measure if a recommendation is good?</p>
<ul>
<li><strong>RMSE/MAE</strong>: Measures accuracy of rating predictions.</li>
<li><strong>Precision@K / Recall@K</strong>: Out of the top <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> items suggested, how many did the user actually interact with?</li>
<li><strong>NDCG (Normalized Discounted Cumulative Gain)</strong>: Rewards the model more for putting the “correct” items at the very top of the list rather than further down.</li>
<li><strong>Diversity and Serendipity</strong>: Measuring how much the system helps users discover items they wouldn’t have found on their own.</li>
</ul>
<astro-island uid="Z1YrX0C" prefix="r51" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;In Matrix Factorization, what happens if we increase the number of latent factors (K) too much?&quot;],&quot;options&quot;:[1,[[0,&quot;The model will run faster.&quot;],[0,&quot;The model will become a Content-Based system.&quot;],[0,&quot;The model will likely overfit, capturing noise instead of general patterns in user behavior.&quot;],[0,&quot;The model will lose the ability to handle missing values.&quot;]]],&quot;answerIndex&quot;:[0,2],&quot;explanation&quot;:[0,&quot;Latent factors represent high-level &#39;concepts&#39;. If $K$ is too large (e.g., $K$ is close to the number of users), the model can trivially &#39;memorize&#39; the exact ratings in the training set without learning generalizable associations between items, leading to poor performance on unseen data.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">In Matrix Factorization, what happens if we increase the number of latent factors (K) too much?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model will run faster.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model will become a Content-Based system.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model will likely overfit, capturing noise instead of general patterns in user behavior.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">The model will lose the ability to handle missing values.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="6-deep-learning-in-recommenders">6. Deep Learning in Recommenders</h2>
<p>Modern production systems (like YouTube/TikTok) use deep learning:</p>
<ul>
<li><strong>Neural Collaborative Filtering (NCF)</strong>: Replacing the dot product in Matrix Factorization with a multi-layer perceptron (MLP) to capture complex, non-linear interactions between user and item embeddings.</li>
<li><strong>Sequence Models (RNNs/Transformers)</strong>: Treating recommendation as a sequence problem—“Given the last 10 videos watched, what is the next most likely interaction?”</li>
</ul>
<h2 id="summary">Summary</h2>
<p>Building a recommender system is an iterative process. Start with simple <strong>Item-Item similarity</strong> using Jaccard or Cosine metrics. As data grows, move to <strong>Matrix Factorization</strong> to solve sparsity. For state-of-the-art performance, integrate <strong>Neural Embeddings</strong> and hybridize with content metadata to solve the cold-start problem.</p> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Reinforcement Learning: Optimal Decision Making</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-agent-environment-loop">The Agent-Environment Loop</h1>
<p>Reinforcement Learning (RL) is a paradigm of machine learning focused on <strong>sequential decision making</strong>. Unlike supervised learning, where the model receives explicit “labels”, an RL <strong>Agent</strong> learns by interacting with an <strong>Environment</strong>. It performs <strong>Actions</strong>, transitions between <strong>States</strong>, and receives scalar <strong>Rewards</strong>.</p>
<div class="my-12 flex flex-col items-center bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-[2.5rem] overflow-hidden shadow-xl p-8 transition-colors"> <div class="w-full flex justify-center overflow-x-auto dark:invert dark:hue-rotate-180 dark:brightness-110"> <?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="254px" preserveAspectRatio="none" style="width:440px;height:254px;" version="1.1" viewBox="0 0 440 254" width="440px" zoomAndPan="magnify"><defs/><g><!--entity A--><g class="entity" data-qualified-name="A" data-source-line="13" id="ent0002"><ellipse cx="189.84" cy="22" fill="#F1F1F1" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;"/><path d="M189.84,42 C193.84,42 196.84,42 200.84,38 C208.84,38 216.84,46 216.84,54 L216.84,58 C216.84,62 212.84,66 208.84,66 L170.84,66 C166.84,66 162.84,62 162.84,58 L162.84,54 C162.84,46 170.84,38 178.84,38 C182.84,42 185.84,42 189.84,42" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="35.5195" x="172.0802" y="85.6387">Agent</text></g><!--entity E--><g class="entity" data-qualified-name="E" data-source-line="14" id="ent0003"><polygon fill="#F1F1F1" points="123.4,187.47,133.4,177.47,256.2867,177.47,256.2867,227.4388,246.2867,237.4388,123.4,237.4388,123.4,187.47" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="246.2867" x2="256.2867" y1="187.47" y2="177.47"/><line style="stroke:#181818;stroke-width:0.5;" x1="123.4" x2="246.2867" y1="187.47" y2="187.47"/><line style="stroke:#181818;stroke-width:0.5;" x1="246.2867" x2="246.2867" y1="187.47" y2="237.4388"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="76.8867" x="146.4" y="216.6087">Environment</text></g><g class="entity" data-qualified-name="GMN9" data-source-line="21" id="ent0010"><path d="M267.47,23.03 L267.47,46.99 L217.69,50.99 L267.47,54.99 L267.47,78.9363 A6,6 0 0 0 273.47,84.9363 L416.2141,84.9363 A6,6 0 0 0 422.2141,78.9363 L422.2141,27.03 L412.2141,17.03 L273.47,17.03 A6,6 0 0 0 267.47,23.03" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M412.2141,17.03 L412.2141,24.03 A3,3 0 0 0 415.2141,27.03 L422.2141,27.03 L412.2141,17.03" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="40.2129" x="281.47" y="41.1687">Learns</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="321.6829" y="41.1687">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="34.9453" x="325.4973" y="41.1687">Policy</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="360.4427" y="41.1687">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="7.2246" x="364.2571" y="41.1687">&#960;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="12.0469" x="281.47" y="55.1374">to</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="293.5169" y="55.1374">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="58.1836" x="297.3313" y="55.1374">maximize</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="68.4902" x="281.47" y="69.1062">Cumulative</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="349.9602" y="69.1062">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="45.4395" x="353.7747" y="69.1062">Reward</text></g><!--link A to E--><g class="link" data-entity-1="ent0002" data-entity-2="ent0003" data-link-type="dependency" data-source-line="16" id="lnk4"><path d="M162.14,58 C110.11,70.6 6,102.79 40.84,152.47 C59.56,179.16 87.0273,191.3888 117.4173,198.2488" fill="none" id="A-to-E" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="123.27,199.57,115.3717,193.6864,118.3927,198.469,113.6101,201.4901,123.27,199.57" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.793" x="49.84" y="141.6087">Action</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="87.633" y="141.6087">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="27.4219" x="91.4474" y="141.6087">(a_t)</text></g><!--reverse link A to E--><g class="link" data-entity-1="ent0002" data-entity-2="ent0003" data-link-type="dependency" data-source-line="17" id="lnk6"><path d="M183.6391,102.4765 C182.0891,119.9265 181.66,134.15 182.84,152.47 C183.36,160.49 184.31,169.13 185.34,177.1" fill="none" id="A-backto-E" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="184.17,96.5,179.3894,105.1108,183.7276,101.4804,187.358,105.8186,184.17,96.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="31.7637" x="191.84" y="141.6087">State</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="223.6037" y="141.6087">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="59.2793" x="227.4181" y="141.6087">(s_{t+1})</text></g><!--reverse link A to E--><g class="link" data-entity-1="ent0002" data-entity-2="ent0003" data-link-type="dependency" data-source-line="18" id="lnk8"><path d="M222.3925,81.9893 C230.1525,88.4793 234.22,91.23 242.84,96.47 C267.52,111.49 286.82,97.43 302.84,121.47 C310.48,132.94 310.19,140.82 302.84,152.47 C292.23,169.3 274.77,180.99 256.71,189.08" fill="none" id="A-backto-E-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="217.79,78.14,222.1276,86.9822,221.6254,81.3477,227.2599,80.8456,217.79,78.14" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="45.4395" x="316.84" y="141.6087">Reward</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.8145" x="362.2795" y="141.6087">&#160;</text><text fill="#000000" font-family="'Inter', 'system-ui', sans-serif" font-size="12" lengthAdjust="spacing" textLength="57.9609" x="366.0939" y="141.6087">(r_{t+1})</text></g><?plantuml-src TP11IyD048Nl-ok6d2eQQ0k2U112ZI1OAUt1OncpqtHfTZViJ9fM4Vo7_YKtrcegUDptlNrlUBmnhiQ05fwns9J1DqvFVEK3I4374P4J1VnZupLgtnfNmWehfZwwfHKsbTnv9uze2P9x9nII2qXupq8sRKnyS8nDcO9P_VDtOLu8HkC-dQ7MNULLNvmVRWsEmX_x57TJOiQI3bcNmpvj0zPFHiiQniCJuBmcfXfExN66pRUgVbKin8U5x2i2R8cz9VKbGPALSR44a25JNI8akTkQu9qzwhbI6QHnHPVUG0xNa1LYl8C1BkLCvP0sTGHP10j18HZmybNEHs-dR4uj1Ws3S8InBPg3ATS2VXNR7mY3OvZvoXHx-7XNui7YpjXk53LfR5EXc2rzHobo6hgCJm00?></g></svg> </div> </div>
<p>The goal is to learn a mapping from states to actions—a <strong>Policy</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>—that maximizes the total expected future reward.</p>
<h2 id="1-markov-decision-processes-mdp">1. Markov Decision Processes (MDP)</h2>
<p>The mathematical framework for RL is the MDP, defined by the tuple <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mclose">)</span></span></span></span>:</p>
<ul>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span> (State Space)</strong>: The set of all possible configurations.</li>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span> (Action Space)</strong>: The set of all possible moves.</li>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> (Transition Dynamics)</strong>: The probability that action <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span> in state <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">s</span></span></span></span> leads to state <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>.</li>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> (Reward Function)</strong>: The immediate feedback signal.</li>
<li><strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span></span></span></span> (Discount Factor)</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. It determines the “horizon” of the agent.</li>
</ul>
<p>The <strong>Markov Property</strong> states that the future depends only on the current state, not the historical sequence:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<h2 id="2-value-functions-and-bellman-equations">2. Value Functions and Bellman Equations</h2>
<p>To optimize a policy, we must evaluate how “good” a state or an action is.</p>
<ul>
<li><strong>State-Value Function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></strong>: The expected total reward starting from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">s</span></span></span></span> following policy <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span></span></span></span>.</li>
<li><strong>Action-Value Function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></strong>: The expected total reward starting from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">s</span></span></span></span>, taking action <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span>, and then following <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span></span></span></span>.</li>
</ul>
<h3 id="the-bellman-optimality-equation">The Bellman Optimality Equation</h3>
<p>The fundamental recursive relationship in RL:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">a</span><span class="mclose">]</span></span></span></span>
This says the value of the current action is the immediate reward plus the value of the best possible action in the next state.</p>
<h2 id="3-q-learning-model-free-control">3. Q-Learning: Model-Free Control</h2>
<p>Q-Learning is an <strong>Off-Policy</strong> algorithm, meaning it can learn the optimal policy even if the agent is behaving randomly. It updates its <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span>-table using temporal difference error:</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mclose">)]</span></span></span></span></p>
<astro-island uid="6RCix" prefix="r52" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\n# Simple GridWorld: 0 - Start, 1 - Path, 2 - Goal\n# State: 0 | 1 | 2\nq_table = np.zeros((3, 2)) # 3 states, 2 actions (Left/Right)\nlr = 0.1\ngamma = 0.9\n\n# Simulate one update step\n# Current State: 1 (Middle), Action: 1 (Right), Next State: 2 (Goal), Reward: 10\ns = 1\na = 1 \nr = 10\ns_next = 2\n\n# Bellman Update\nbest_next_q = np.max(q_table[s_next])\ntd_target = r + gamma * best_next_q\nq_table[s, a] += lr * (td_target - q_table[s, a])\n\nprint(\&quot;Updated Q-Table for State 1, Action Right:\&quot;)\nprint(q_table[1, 1])\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

# Simple GridWorld: 0 - Start, 1 - Path, 2 - Goal
# State: 0 | 1 | 2
q_table = np.zeros((3, 2)) # 3 states, 2 actions (Left/Right)
lr = 0.1
gamma = 0.9

# Simulate one update step
# Current State: 1 (Middle), Action: 1 (Right), Next State: 2 (Goal), Reward: 10
s = 1
a = 1 
r = 10
s_next = 2

# Bellman Update
best_next_q = np.max(q_table[s_next])
td_target = r + gamma * best_next_q
q_table[s, a] += lr * (td_target - q_table[s, a])

print(&quot;Updated Q-Table for State 1, Action Right:&quot;)
print(q_table[1, 1])
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-comment"># Simple GridWorld: 0 - Start, 1 - Path, 2 - Goal</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># State: 0 | 1 | 2</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">q_table <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span><span class="hl-bracket">(</span><span class="hl-number">3</span>, <span class="hl-number">2</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span> <span class="hl-comment"># 3 states, 2 actions (Left/Right)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">lr <span class="hl-operator">=</span> <span class="hl-number">0</span>.<span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">gamma <span class="hl-operator">=</span> <span class="hl-number">0</span>.<span class="hl-number">9</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-comment"># Simulate one update step</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre"><span class="hl-comment"># Current State: 1 (Middle), Action: 1 (Right), Next State: 2 (Goal), Reward: 10</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">s <span class="hl-operator">=</span> <span class="hl-number">1</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">a <span class="hl-operator">=</span> <span class="hl-number">1</span> </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">r <span class="hl-operator">=</span> <span class="hl-number">10</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">s_next <span class="hl-operator">=</span> <span class="hl-number">2</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre"><span class="hl-comment"># Bellman Update</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">best_next_q <span class="hl-operator">=</span> np.<span class="hl-function">max</span><span class="hl-bracket">(</span>q_table<span class="hl-bracket">[</span>s_next<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">td_target <span class="hl-operator">=</span> r <span class="hl-operator">+</span> gamma <span class="hl-operator">*</span> best_next_q</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">q_table<span class="hl-bracket">[</span>s, a<span class="hl-bracket">]</span> <span class="hl-operator">+</span><span class="hl-operator">=</span> lr <span class="hl-operator">*</span> <span class="hl-bracket">(</span>td_target <span class="hl-flag">-</span> q_table<span class="hl-bracket">[</span>s, a<span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Updated Q-Table for State 1, Action Right:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>q_table<span class="hl-bracket">[</span><span class="hl-number">1</span>, <span class="hl-number">1</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="4-exploration-vs-exploitation">4. Exploration vs. Exploitation</h2>
<p>If an agent only executes actions it knows are good (<strong>Exploitation</strong>), it might never find a superior hidden path. If it only tries new things (<strong>Exploration</strong>), it will never accumulate high rewards.</p>
<p><strong>Simple Solution: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span>-greedy Policy</strong></p>
<ul>
<li>With probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span>: Take a random action.</li>
<li>With probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span>: Take the action with the highest <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span>-value.
Common practice is to start with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span> and decay it toward <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.05</span></span></span></span> as the agent learns.</li>
</ul>
<h2 id="5-from-tabular-rl-to-deep-rl">5. From Tabular RL to Deep RL</h2>
<p>When the state space is continuous (e.g., coordinates in physics) or high-dimensional (e.g., raw pixels), a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span>-Table is impossible.</p>
<h3 id="deep-q-networks-dqn">Deep Q-Networks (DQN)</h3>
<p>Instead of a table, we use a Neural Network <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span> to approximate the values.</p>
<ul>
<li><strong>Experience Replay</strong>: Storing past transitions <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> in a buffer and sampling them randomly to break the correlation between consecutive steps.</li>
<li><strong>Fixed Q-Targets</strong>: Using a separate, slowly-updating network to calculate the targets, improving training stability.</li>
</ul>
<h3 id="policy-gradient-methods">Policy Gradient Methods</h3>
<p>Instead of estimating values, these models directly learn the probability distribution <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>.</p>
<ul>
<li><strong>Advantage</strong>: They can handle continuous action spaces (e.g., “apply 12.5 Newtons of force”).</li>
<li><strong>Popular Algorithms</strong>: PPO (Proximal Policy Optimization), used for training ChatGPT (RLHF).</li>
</ul>
<astro-island uid="1Fkh5D" prefix="r53" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is &#39;Experience Replay&#39; used in Deep Q-Learning?&quot;],&quot;options&quot;:[1,[[0,&quot;To make the model remember every single game it ever played.&quot;],[0,&quot;To break the temporal correlation of training data and make the training process more like independent identically distributed (i.i.d.) learning.&quot;],[0,&quot;To increase the speed of the GPU calculations.&quot;],[0,&quot;To ensure the agent always explores new states.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;In RL, consecutive samples are highly correlated (state $t+1$ is very similar to state $t$). Standard neural networks assume data is i.i.d. Experience Replay stores these transitions and samples them randomly, ensuring the network doesn&#39;t overfit to the local trajectory of the current episode.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is &#x27;Experience Replay&#x27; used in Deep Q-Learning?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To make the model remember every single game it ever played.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To break the temporal correlation of training data and make the training process more like independent identically distributed (i.i.d.) learning.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To increase the speed of the GPU calculations.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">To ensure the agent always explores new states.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="6-real-world-applications">6. Real-World Applications</h2>
<ul>
<li><strong>Game AI</strong>: AlphaGo (Chess/Go) and AlphaStar (StarCraft II).</li>
<li><strong>Robotics</strong>: Learning walking gaits or grasping complex objects.</li>
<li><strong>Finance</strong>: Portfolio optimization and high-frequency trading.</li>
<li><strong>Recommender Systems</strong>: Long-term user engagement optimization.</li>
</ul>
<h2 id="summary-when-to-use-rl">Summary: When to Use RL?</h2>
<p>Reinforcement Learning is suitable when:</p>
<ol>
<li>You have an <strong>Environment</strong> (simulation or real world).</li>
<li>You can define a clear <strong>Reward</strong> signal.</li>
<li>The problem involves a <strong>Sequence</strong> of decisions where early actions affect future possibilities.</li>
<li>Optimal “labels” for specific states are unknown or too expensive to generate.</li>
</ol> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">NLP: Foundations and Vector Representations</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="language-as-data">Language as Data</h1>
<p>Natural Language Processing (NLP) is the computational study of human language. The primary challenge is that language is discrete, symbolic, and ambiguous, while machine learning models operate on continuous numerical vectors. The goal of NLP pipelines is to transform raw text into high-dimensional representations that capture semantic meaning.</p>
<h2 id="1-text-preprocessing-and-tokenization">1. Text Preprocessing and Tokenization</h2>
<p>Before a model can “read” text, the raw string must be cleaned and broken into units called <strong>tokens</strong>.</p>
<ul>
<li><strong>Tokenization</strong>: Splitting text into words, characters, or sub-words (e.g., Byte-Pair Encoding).</li>
<li><strong>Stop-word Removal</strong>: Removing frequent but low-information words like “the”, “is”, “at”.</li>
<li><strong>Stemming/Lemmatization</strong>: Reducing words to their base form (e.g., “running” <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em"></span><span class="mrel">→</span></span></span></span> “run”).</li>
<li><strong>Normalization</strong>: Converting to lowercase, removing punctuation, and handling special characters/emojis.</li>
</ul>
<h2 id="2-statistical-vectorization-sparse-embeddings">2. Statistical Vectorization (Sparse Embeddings)</h2>
<h3 id="bag-of-words-bow">Bag-of-Words (BoW)</h3>
<p>In BoW, we represent a document as a vector of word counts. If our vocabulary has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span> unique words, each document becomes a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span>-dimensional vector.
<em>Problem</em>: BoW loses all information about word order and gives too much weight to frequent words.</p>
<h3 id="tf-idf-term-frequency-inverse-document-frequency">TF-IDF (Term Frequency-Inverse Document Frequency)</h3>
<p>TF-IDF re-weights word counts to emphasize words that are important to a specific document but rare across the entire corpus.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">TF-IDF</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">TF</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">TF</span></span></span></span> is the frequency of term <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span> in document <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span> is the total number of documents, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord mathnormal" style="margin-right:0.13889em">F</span></span></span></span> is the number of documents containing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>.</p>
<astro-island uid="1A5cy1" prefix="r54" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;from sklearn.feature_extraction.text import TfidfVectorizer\nimport pandas as pd\n\ncorpus = [\n  \&quot;Machine learning is the study of computer algorithms.\&quot;,\n  \&quot;Learning algorithms are the core of machine learning.\&quot;,\n  \&quot;The study of algorithms requires mathematical foundations.\&quot;,\n  \&quot;Apples and oranges are fruits.\&quot;\n]\n\nvectorizer = TfidfVectorizer(stop_words=&#39;english&#39;)\ntfidf_matrix = vectorizer.fit_transform(corpus)\n\n# Convert to DataFrame for visualization\nfeature_names = vectorizer.get_feature_names_out()\ndf = pd.DataFrame(tfidf_matrix.toarray(), columns=feature_names)\n\nprint(\&quot;Top TF-IDF weights for Document 0:\&quot;)\nprint(df.iloc[0].sort_values(ascending=False).head(5))\n\nprint(\&quot;\&quot;)\nprint(\&quot;Cosine Similarity between Doc 0 and Doc 1:\&quot;)\nfrom sklearn.metrics.pairwise import cosine_similarity\nsim = cosine_similarity(tfidf_matrix[0:1], tfidf_matrix[1:2])\nprint(f\&quot;{sim[0][0]:.4f}\&quot;)\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">from sklearn.feature_extraction.text import TfidfVectorizer
import pandas as pd

corpus = [
  &quot;Machine learning is the study of computer algorithms.&quot;,
  &quot;Learning algorithms are the core of machine learning.&quot;,
  &quot;The study of algorithms requires mathematical foundations.&quot;,
  &quot;Apples and oranges are fruits.&quot;
]

vectorizer = TfidfVectorizer(stop_words=&#x27;english&#x27;)
tfidf_matrix = vectorizer.fit_transform(corpus)

# Convert to DataFrame for visualization
feature_names = vectorizer.get_feature_names_out()
df = pd.DataFrame(tfidf_matrix.toarray(), columns=feature_names)

print(&quot;Top TF-IDF weights for Document 0:&quot;)
print(df.iloc[0].sort_values(ascending=False).head(5))

print(&quot;&quot;)
print(&quot;Cosine Similarity between Doc 0 and Doc 1:&quot;)
from sklearn.metrics.pairwise import cosine_similarity
sim = cosine_similarity(tfidf_matrix[0:1], tfidf_matrix[1:2])
print(f&quot;{sim[0][0]:.4f}&quot;)
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.feature_extraction.text <span class="hl-keyword">import</span> TfidfVectorizer</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> pandas <span class="hl-keyword">as</span> pd</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">corpus <span class="hl-operator">=</span> <span class="hl-bracket">[</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">  <span class="hl-string">&quot;Machine learning is the study of computer algorithms.&quot;</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre">  <span class="hl-string">&quot;Learning algorithms are the core of machine learning.&quot;</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">  <span class="hl-string">&quot;The study of algorithms requires mathematical foundations.&quot;</span>,</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">  <span class="hl-string">&quot;Apples and oranges are fruits.&quot;</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">vectorizer <span class="hl-operator">=</span> TfidfVectorizer<span class="hl-bracket">(</span>stop_words<span class="hl-operator">=</span><span class="hl-string">&#039;english&#039;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">tfidf_matrix <span class="hl-operator">=</span> vectorizer.fit_transform<span class="hl-bracket">(</span>corpus<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre"><span class="hl-comment"># Convert to DataFrame for visualization</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">feature_names <span class="hl-operator">=</span> vectorizer.get_feature_names_out<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">df <span class="hl-operator">=</span> pd.DataFrame<span class="hl-bracket">(</span>tfidf_matrix.toarray<span class="hl-bracket">(</span><span class="hl-bracket">)</span>, columns<span class="hl-operator">=</span>feature_names<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Top TF-IDF weights for Document 0:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>df.iloc<span class="hl-bracket">[</span><span class="hl-number">0</span><span class="hl-bracket">]</span>.sort_values<span class="hl-bracket">(</span>ascending<span class="hl-operator">=</span>False<span class="hl-bracket">)</span>.head<span class="hl-bracket">(</span><span class="hl-number">5</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;Cosine Similarity between Doc 0 and Doc 1:&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre"><span class="hl-keyword">from</span> sklearn.metrics.pairwise <span class="hl-keyword">import</span> cosine_similarity</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">sim <span class="hl-operator">=</span> cosine_similarity<span class="hl-bracket">(</span>tfidf_matrix<span class="hl-bracket">[</span><span class="hl-number">0</span>:<span class="hl-number">1</span><span class="hl-bracket">]</span>, tfidf_matrix<span class="hl-bracket">[</span><span class="hl-number">1</span>:<span class="hl-number">2</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;{sim[0][0]:.4f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="3-distributed-representations-word-embeddings">3. Distributed Representations (Word Embeddings)</h2>
<p>Traditional vectorization (BoW/TF-IDF) results in “sparse” vectors where the distance between “King” and “Royal” is the same as between “King” and “Apple”. <strong>Word Embeddings</strong> solve this by mapping words to dense, low-dimensional vectors in a continuous space.</p>
<h3 id="word2vec-the-distributional-hypothesis">Word2Vec: The Distributional Hypothesis</h3>
<p>Word2Vec is based on the idea that “a word is characterized by the company it keeps” (Firth, 1957).</p>
<ul>
<li><strong>Skip-gram</strong>: Given a target word, predict the context words.</li>
<li><strong>CBOW (Continuous Bag of Words)</strong>: Given context words, predict the target word.</li>
</ul>
<p>The model uses a shallow neural network to learn weights. Once trained, the internal weights represent the word embeddings.</p>
<h3 id="algebraic-properties">Algebraic Properties</h3>
<p>Word embeddings capture semantic analogies through vector arithmetic:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mopen">(</span><span class="mord text"><span class="mord">&quot;King&quot;</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mopen">(</span><span class="mord text"><span class="mord">&quot;Man&quot;</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mopen">(</span><span class="mord text"><span class="mord">&quot;Woman&quot;</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mopen">(</span><span class="mord text"><span class="mord">&quot;Queen&quot;</span></span><span class="mclose">)</span></span></span></span></p>
<h2 id="4-sequence-modeling-rnns-and-lstms">4. Sequence Modeling: RNNs and LSTMs</h2>
<p>Language is inherently sequential; the meaning of a word depends on what came before it.</p>
<h3 id="recurrent-neural-networks-rnns">Recurrent Neural Networks (RNNs)</h3>
<p>RNNs process sequences word-by-word, maintaining a “hidden state” <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> that acts as a memory:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">hh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>
<em>The Vanishing Gradient Problem</em>: As sequences get longer, the gradients used to update the beginning of the sequence during backpropagation shrink to zero, causing the model to “forget” long-term dependencies.</p>
<h3 id="lstms-and-grus">LSTMs and GRUs</h3>
<p>Gated units like <strong>Long Short-Term Memory (LSTM)</strong> introduced “gates” (input, forget, and output) to control the flow of information. The “Cell State” acts as a highway, allowing gradients to flow back through long sequences without vanishing.</p>
<astro-island uid="Zd8WAM" prefix="r55" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\n\ndef sigmoid(x):\n  return 1 / (1 + np.exp(-x))\n\n# Minimal RNN forward pass (one step)\ndef rnn_step(x_t, h_prev, W_xh, W_hh, b_h):\n  h_t = np.tanh(np.dot(W_xh, x_t) + np.dot(W_hh, h_prev) + b_h)\n  return h_t\n\n# Dimensions\ndim_input = 10\ndim_hidden = 16\n\nW_xh = np.random.randn(dim_hidden, dim_input) * 0.01\nW_hh = np.random.randn(dim_hidden, dim_hidden) * 0.01\nb_h = np.zeros((dim_hidden, 1))\n\nh_prev = np.zeros((dim_hidden, 1))\nx_t = np.random.randn(dim_input, 1)\n\nh_next = rnn_step(x_t, h_prev, W_xh, W_hh, b_h)\nprint(\&quot;RNN Hidden State (first 5 elements):\&quot;)\nprint(h_next[:5])\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np

def sigmoid(x):
  return 1 / (1 + np.exp(-x))

# Minimal RNN forward pass (one step)
def rnn_step(x_t, h_prev, W_xh, W_hh, b_h):
  h_t = np.tanh(np.dot(W_xh, x_t) + np.dot(W_hh, h_prev) + b_h)
  return h_t

# Dimensions
dim_input = 10
dim_hidden = 16

W_xh = np.random.randn(dim_hidden, dim_input) * 0.01
W_hh = np.random.randn(dim_hidden, dim_hidden) * 0.01
b_h = np.zeros((dim_hidden, 1))

h_prev = np.zeros((dim_hidden, 1))
x_t = np.random.randn(dim_input, 1)

h_next = rnn_step(x_t, h_prev, W_xh, W_hh, b_h)
print(&quot;RNN Hidden State (first 5 elements):&quot;)
print(h_next[:5])
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre"><span class="hl-keyword">def</span> sigmoid<span class="hl-bracket">(</span>x<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> <span class="hl-number">1</span> <span class="hl-operator">/</span> <span class="hl-bracket">(</span><span class="hl-number">1</span> <span class="hl-operator">+</span> np.exp<span class="hl-bracket">(</span><span class="hl-flag">-x</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># Minimal RNN forward pass (one step)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre"><span class="hl-keyword">def</span> rnn_step<span class="hl-bracket">(</span>x_t, h_prev, W_xh, W_hh, b_h<span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">  h_t <span class="hl-operator">=</span> np.tanh<span class="hl-bracket">(</span>np.dot<span class="hl-bracket">(</span>W_xh, x_t<span class="hl-bracket">)</span> <span class="hl-operator">+</span> np.dot<span class="hl-bracket">(</span>W_hh, h_prev<span class="hl-bracket">)</span> <span class="hl-operator">+</span> b_h<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre">  <span class="hl-keyword">return</span> h_t</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre"><span class="hl-comment"># Dimensions</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">dim_input <span class="hl-operator">=</span> <span class="hl-number">10</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">dim_hidden <span class="hl-operator">=</span> <span class="hl-number">16</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">W_xh <span class="hl-operator">=</span> np.random.randn<span class="hl-bracket">(</span>dim_hidden, dim_input<span class="hl-bracket">)</span> <span class="hl-operator">*</span> <span class="hl-number">0</span>.<span class="hl-number">01</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">W_hh <span class="hl-operator">=</span> np.random.randn<span class="hl-bracket">(</span>dim_hidden, dim_hidden<span class="hl-bracket">)</span> <span class="hl-operator">*</span> <span class="hl-number">0</span>.<span class="hl-number">01</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">b_h <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span><span class="hl-bracket">(</span>dim_hidden, <span class="hl-number">1</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">h_prev <span class="hl-operator">=</span> np.zeros<span class="hl-bracket">(</span><span class="hl-bracket">(</span>dim_hidden, <span class="hl-number">1</span><span class="hl-bracket">)</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">x_t <span class="hl-operator">=</span> np.random.randn<span class="hl-bracket">(</span>dim_input, <span class="hl-number">1</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">h_next <span class="hl-operator">=</span> rnn_step<span class="hl-bracket">(</span>x_t, h_prev, W_xh, W_hh, b_h<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span><span class="hl-string">&quot;RNN Hidden State (first 5 elements):&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre"><span class="hl-function">print</span><span class="hl-bracket">(</span>h_next<span class="hl-bracket">[</span>:<span class="hl-number">5</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="5-the-bottleneck-of-rnns">5. The Bottleneck of RNNs</h2>
<p>Despite the success of LSTMs, they suffer from two major flaws:</p>
<ol>
<li><strong>Sequential Nature</strong>: They cannot be parallelized easily since <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> depends on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span></span></span></span>.</li>
<li><strong>Contextual Limitation</strong>: They struggle to capture relationships between distant words (e.g., the subject of a very long sentence determining the verb conjugation).</li>
</ol>
<p>These limitations led to the development of the <strong>Attention Mechanism</strong> and eventually the <strong>Transformer</strong>, which we explore in the next module.</p>
<astro-island uid="V4mNy" prefix="r56" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why is TF-IDF often preferred over simple word counts (Bag-of-Words) in document retrieval?&quot;],&quot;options&quot;:[1,[[0,&quot;TF-IDF preserves the order of words in a sentence.&quot;],[0,&quot;TF-IDF reduces the influence of common &#39;stop words&#39; while highlighting discriminative terms.&quot;],[0,&quot;TF-IDF vectors are less sparse than BoW vectors.&quot;],[0,&quot;TF-IDF can handle images as well as text.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;In a large corpus, words like &#39;the&#39; or &#39;and&#39; appear frequently but provide no information about the topic. TF-IDF penalizes these words (low IDF) while boosting words that are unique to specific contexts (high TF and high IDF).&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why is TF-IDF often preferred over simple word counts (Bag-of-Words) in document retrieval?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">TF-IDF preserves the order of words in a sentence.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">TF-IDF reduces the influence of common &#x27;stop words&#x27; while highlighting discriminative terms.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">TF-IDF vectors are less sparse than BoW vectors.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">TF-IDF can handle images as well as text.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="implementation-summary">Implementation Summary</h2>
<ul>
<li><strong>Use NLTK/SpaCy</strong> for fast preprocessing (tokenization, lemmatization).</li>
<li><strong>Use Scikit-learn</strong> for statistical models (TF-IDF, Naive Bayes).</li>
<li><strong>Use Gensim</strong> for Word2Vec or GloVe embeddings.</li>
<li><strong>Use PyTorch/TensorFlow</strong> for sequence modeling with LSTMs or Transformers.</li>
</ul> </div> </div><div class="lesson-container mb-32 last:mb-0"> <header class="mb-16"> <div class="flex items-center gap-3 mb-6"> <div class="h-px w-8 bg-primary"></div> <div class="text-[10px] font-black text-primary uppercase tracking-[0.4em]">Section Detail</div> </div> <h3 class="text-5xl font-black uppercase tracking-tighter text-slate-900 mb-8 leading-[0.95]">Ethics in Machine Learning: Bias and Fairness</h3> <div class="h-2 w-24 bg-primary rounded-full shadow-lg shadow-primary/10"></div> </header> <div class="content-article"> <h1 id="the-socio-technical-system">The Socio-Technical System</h1>
<p>Machine learning models are not neutral mathematical entities. They are socio-technical systems created by humans, using data generated by human behavior, and deployed within human institutions. Consequently, they often inherit and amplify the structural biases present in society. As these models move from research labs to critical infrastructure—affecting hiring, policing, medical diagnosis, and credit scores—understanding their ethical implications is a technical requirement, not just a philosophical one.</p>
<h2 id="1-taxonomic-classification-of-bias">1. Taxonomic Classification of Bias</h2>
<p>Bias enters the machine learning pipeline at multiple stages:</p>
<ol>
<li><strong>Historical Bias</strong>: The training data reflects past societal prejudices. For example, if a hiring algorithm is trained on past successful candidates from a period of systemic gender discrimination, the model will learn to associate “success” with male-coded traits.</li>
<li><strong>Representation Bias</strong>: The dataset lacks sufficient samples from specific subpopulations. Facial recognition systems that perform <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.0833em"></span><span class="mord">20%</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em"></span><span class="mord">30%</span></span></span></span> worse on darker skin tones are often the result of training sets dominated by Western, light-skinned individuals.</li>
<li><strong>Label/Measurement Bias</strong>: The “proxy” used for a target doesn’t accurately represent the desired outcome. Using “prior arrests” as a proxy for “criminality” ignores the fact that different neighborhoods are policed with different intensities.</li>
<li><strong>Aggregation Bias</strong>: When a single model is used for a diverse population, ignoring the fact that the relationship between features may differ across groups.</li>
</ol>
<h2 id="2-the-quest-for-algorithmic-fairness">2. The Quest for Algorithmic Fairness</h2>
<p>Fairness is not a single mathematical property. In fact, many definitions of fairness are mathematically incompatible.</p>
<ul>
<li><strong>Demographic Parity</strong>: The likelihood of a positive outcome (e.g., getting a loan) should be the same for all groups (e.g., Men vs. Women).
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></li>
<li><strong>Equalized Odds (Calibration)</strong>: The False Positive Rate and True Positive Rate should be the same across all groups.
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mord text"><span class="mord"> for </span></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></li>
</ul>
<h3 id="the-impossibility-theorem">The Impossibility Theorem</h3>
<p>Kleinberg (2016) proved that unless two groups have the same base rate of the target variable <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span></span>, you cannot simultaneously satisfy Calibration and Demographic Parity. Choosing which to optimize is a political and ethical choice.</p>
<astro-island uid="2sS3Je" prefix="r57" component-url="../../assets/CodeRunner.B_vmUrWZ.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;code&quot;:[0,&quot;import numpy as np\nimport pandas as pd\n\n# Simulating a biased loan model\n# Group A: 80% qualified, Group B: 50% qualified\n# But the model has higher &#39;noise&#39;/uncertainty for Group B\nnp.random.seed(42)\n\ndef simulate_bias():\n  n = 1000\n  group = np.random.choice([&#39;A&#39;, &#39;B&#39;], n)\n  # Ground truth (qualification)\n  y_true = np.where(group == &#39;A&#39;, np.random.rand(n) &lt; 0.8, np.random.rand(n) &lt; 0.5)\n  \n  # Model predictions (simulated with bias)\n  # Model is &#39;stricter&#39; on Group B\n  probs = np.where(group == &#39;A&#39;, np.random.rand(n) * 0.9 + 0.1, np.random.rand(n) * 0.7)\n  y_pred = probs &gt; 0.5\n  \n  df = pd.DataFrame({&#39;group&#39;: group, &#39;truth&#39;: y_true, &#39;pred&#39;: y_pred})\n  \n  for g in [&#39;A&#39;, &#39;B&#39;]:\n      subset = df[df[&#39;group&#39;] == g]\n      acc = (subset[&#39;truth&#39;] == subset[&#39;pred&#39;]).mean()\n      pos_rate = subset[&#39;pred&#39;].mean()\n      print(f\&quot;Group {g}: Selection Rate={pos_rate:.2f}, Accuracy={acc:.2f}\&quot;)\n\nsimulate_bias()\n&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;CodeRunner&quot;,&quot;value&quot;:true}" await-children=""><div class="code-runner my-12 group"><div class="bg-white dark:bg-dark-surface rounded-3xl overflow-hidden border border-light-border dark:border-dark-border shadow-xl transition-all duration-500 group-hover:border-primary/30"><div class="bg-light-bg dark:bg-dark-bg/20 px-8 py-5 border-b border-light-border dark:border-dark-border flex items-center justify-between"><div class="flex items-center gap-3"><div class="p-2 bg-primary/10 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cpu text-primary"><rect x="4" y="4" width="16" height="16" rx="2"></rect><rect x="9" y="9" width="6" height="6"></rect><path d="M15 2v2"></path><path d="M15 20v2"></path><path d="M2 15h2"></path><path d="M2 9h2"></path><path d="M20 15h2"></path><path d="M20 9h2"></path><path d="M9 2v2"></path><path d="M9 20v2"></path></svg></div><div class="flex flex-col justify-center"><div class="text-[9px] font-black text-primary uppercase tracking-[0.25em] mb-1.5 leading-tight">Runtime Environment</div><h3 class="text-lg font-black text-light-text dark:text-dark-text uppercase tracking-tighter leading-tight">Interactive Lab</h3></div></div><div class="flex gap-1.5"><button class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-xl text-xs font-black uppercase tracking-widest hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-50"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play "><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>Run</button><button title="Copy Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-primary border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button title="Reset Code" class="p-2.5 hover:bg-white dark:hover:bg-dark-bg rounded-lg transition-all text-light-muted dark:text-dark-muted hover:text-rose-500 border border-transparent hover:border-light-border dark:hover:border-dark-border"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw "><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button></div></div><div class="flex flex-col md:flex-row min-h-[400px]"><div class="relative flex-1 border-r border-light-border dark:border-dark-border group/editor bg-white dark:bg-dark-surface/50 overflow-auto"><div class="relative min-h-full" style="min-width:max-content;width:100%"><textarea class="absolute inset-0 w-full h-full pt-[30px] pb-[30px] pr-[30px] pl-[64px] font-mono text-[14.5px] leading-[24px] bg-transparent text-transparent caret-primary resize-none focus:outline-none z-10 selection:bg-primary/30 overflow-hidden whitespace-pre" spellcheck="false" style="font-variant-ligatures:none;caret-color:var(--primary)">import numpy as np
import pandas as pd

# Simulating a biased loan model
# Group A: 80% qualified, Group B: 50% qualified
# But the model has higher &#x27;noise&#x27;/uncertainty for Group B
np.random.seed(42)

def simulate_bias():
  n = 1000
  group = np.random.choice([&#x27;A&#x27;, &#x27;B&#x27;], n)
  # Ground truth (qualification)
  y_true = np.where(group == &#x27;A&#x27;, np.random.rand(n) &lt; 0.8, np.random.rand(n) &lt; 0.5)
  
  # Model predictions (simulated with bias)
  # Model is &#x27;stricter&#x27; on Group B
  probs = np.where(group == &#x27;A&#x27;, np.random.rand(n) * 0.9 + 0.1, np.random.rand(n) * 0.7)
  y_pred = probs &gt; 0.5
  
  df = pd.DataFrame({&#x27;group&#x27;: group, &#x27;truth&#x27;: y_true, &#x27;pred&#x27;: y_pred})
  
  for g in [&#x27;A&#x27;, &#x27;B&#x27;]:
      subset = df[df[&#x27;group&#x27;] == g]
      acc = (subset[&#x27;truth&#x27;] == subset[&#x27;pred&#x27;]).mean()
      pos_rate = subset[&#x27;pred&#x27;].mean()
      print(f&quot;Group {g}: Selection Rate={pos_rate:.2f}, Accuracy={acc:.2f}&quot;)

simulate_bias()
</textarea><div class="p-[30px] font-mono text-[14.5px] leading-[24px] pointer-events-none hl-default"><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">1</span><span class="whitespace-pre"><span class="hl-keyword">import</span> numpy <span class="hl-keyword">as</span> np</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">2</span><span class="whitespace-pre"><span class="hl-keyword">import</span> pandas <span class="hl-keyword">as</span> pd</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">3</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">4</span><span class="whitespace-pre"><span class="hl-comment"># Simulating a biased loan model</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">5</span><span class="whitespace-pre"><span class="hl-comment"># Group A: 80% qualified, Group B: 50% qualified</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">6</span><span class="whitespace-pre"><span class="hl-comment"># But the model has higher &#039;noise&#039;/uncertainty for Group B</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">7</span><span class="whitespace-pre">np.random.seed<span class="hl-bracket">(</span><span class="hl-number">42</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">8</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">9</span><span class="whitespace-pre"><span class="hl-keyword">def</span> simulate_bias<span class="hl-bracket">(</span><span class="hl-bracket">)</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">10</span><span class="whitespace-pre">  n <span class="hl-operator">=</span> <span class="hl-number">1000</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">11</span><span class="whitespace-pre">  group <span class="hl-operator">=</span> np.random.choice<span class="hl-bracket">(</span><span class="hl-bracket">[</span><span class="hl-string">&#039;A&#039;</span>, <span class="hl-string">&#039;B&#039;</span><span class="hl-bracket">]</span>, n<span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">12</span><span class="whitespace-pre">  <span class="hl-comment"># Ground truth (qualification)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">13</span><span class="whitespace-pre">  y_true <span class="hl-operator">=</span> np.where<span class="hl-bracket">(</span>group <span class="hl-operator">==</span> <span class="hl-string">&#039;A&#039;</span>, np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span> <span class="hl-operator">&lt;</span> <span class="hl-number">0</span>.<span class="hl-number">8</span>, np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span> <span class="hl-operator">&lt;</span> <span class="hl-number">0</span>.<span class="hl-number">5</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">14</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">15</span><span class="whitespace-pre">  <span class="hl-comment"># Model predictions (simulated with bias)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">16</span><span class="whitespace-pre">  <span class="hl-comment"># Model is &#039;stricter&#039; on Group B</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">17</span><span class="whitespace-pre">  probs <span class="hl-operator">=</span> np.where<span class="hl-bracket">(</span>group <span class="hl-operator">==</span> <span class="hl-string">&#039;A&#039;</span>, np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span> <span class="hl-operator">*</span> <span class="hl-number">0</span>.<span class="hl-number">9</span> <span class="hl-operator">+</span> <span class="hl-number">0</span>.<span class="hl-number">1</span>, np.random.rand<span class="hl-bracket">(</span>n<span class="hl-bracket">)</span> <span class="hl-operator">*</span> <span class="hl-number">0</span>.<span class="hl-number">7</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">18</span><span class="whitespace-pre">  y_pred <span class="hl-operator">=</span> probs <span class="hl-operator">&gt;</span> <span class="hl-number">0</span>.<span class="hl-number">5</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">19</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">20</span><span class="whitespace-pre">  df <span class="hl-operator">=</span> pd.DataFrame<span class="hl-bracket">(</span><span class="hl-bracket">{</span><span class="hl-string">&#039;group&#039;</span>: group, <span class="hl-string">&#039;truth&#039;</span>: y_true, <span class="hl-string">&#039;pred&#039;</span>: y_pred<span class="hl-bracket">}</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">21</span><span class="whitespace-pre">  </span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">22</span><span class="whitespace-pre">  <span class="hl-keyword">for</span> g <span class="hl-keyword">in</span> <span class="hl-bracket">[</span><span class="hl-string">&#039;A&#039;</span>, <span class="hl-string">&#039;B&#039;</span><span class="hl-bracket">]</span>:</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">23</span><span class="whitespace-pre">      subset <span class="hl-operator">=</span> df<span class="hl-bracket">[</span>df<span class="hl-bracket">[</span><span class="hl-string">&#039;group&#039;</span><span class="hl-bracket">]</span> <span class="hl-operator">==</span> g<span class="hl-bracket">]</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">24</span><span class="whitespace-pre">      acc <span class="hl-operator">=</span> <span class="hl-bracket">(</span>subset<span class="hl-bracket">[</span><span class="hl-string">&#039;truth&#039;</span><span class="hl-bracket">]</span> <span class="hl-operator">==</span> subset<span class="hl-bracket">[</span><span class="hl-string">&#039;pred&#039;</span><span class="hl-bracket">]</span><span class="hl-bracket">)</span>.mean<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">25</span><span class="whitespace-pre">      pos_rate <span class="hl-operator">=</span> subset<span class="hl-bracket">[</span><span class="hl-string">&#039;pred&#039;</span><span class="hl-bracket">]</span>.mean<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">26</span><span class="whitespace-pre">      <span class="hl-function">print</span><span class="hl-bracket">(</span>f<span class="hl-string">&quot;Group {g}: Selection Rate={pos_rate:.2f}, Accuracy={acc:.2f}&quot;</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">27</span><span class="whitespace-pre">&nbsp;</span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">28</span><span class="whitespace-pre">simulate_bias<span class="hl-bracket">(</span><span class="hl-bracket">)</span></span></div><div class="flex gap-[20px] group/line min-h-[24px]"><span class="text-light-muted dark:text-dark-muted select-none text-right w-[14px] opacity-25 inline-block font-mono text-xs">29</span><span class="whitespace-pre">&nbsp;</span></div></div></div></div><div class="flex-1 flex flex-col bg-light-surface dark:bg-[#0d0d17] p-8 border-t md:border-t-0 border-light-border dark:border-dark-border transition-all duration-300 opacity-100 md:opacity-0 pointer-events-none"><div class="flex items-center gap-3 mb-6"><div class="w-2.5 h-2.5 rounded-full bg-rose-500"></div><div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div><div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div><span class="ml-2 text-[10px] font-black text-light-text/40 dark:text-white/40 uppercase tracking-[0.2em] flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal "><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>Terminal Output</span></div><div class="flex-1 font-mono text-sm overflow-auto"></div></div></div></div></div><!--astro:end--></astro-island>
<h2 id="3-explainability-and-transparency-xai">3. Explainability and Transparency (XAI)</h2>
<p>High-performance models (Neural Networks, XGBoost) are “Black Boxes.” This is unacceptable in high-stakes environments where a person has a right to know <em>why</em> a decision was made.</p>
<h3 id="post-hoc-interpretation">Post-hoc Interpretation</h3>
<ul>
<li><strong>LIME</strong>: Fits a simple linear model locally around a specific prediction to highlight which features were most influential for that instance.</li>
<li><strong>SHAP (Shapley Values)</strong>: Based on cooperative game theory. It distributes the specific output of a model among all contributing features.</li>
<li><strong>Counterfactuals</strong>: Explaining a decision by showing what would have to change for the outcome to be different (e.g., “Your loan was denied, but if your income was <span class="katex-error" title="ParseError: KaTeX parse error: Unexpected character: '\' at position 1: \̲" style="color:#cc0000">\</span>5,000$ higher, it would have been approved”).</li>
</ul>
<h2 id="4-privacy-and-adversarial-ethics">4. Privacy and Adversarial Ethics</h2>
<ul>
<li><strong>Data Privacy (Differential Privacy)</strong>: Ensuring that the inclusion of a specific individual in a training set doesn’t significantly change the model’s output. This prevents “Member Inference Attacks.”</li>
<li><strong>Adversarial Attacks</strong>: Intentionally perturbing input data to trick a model (e.g., adding imperceptible noise to a “Stop” sign to make it look like a “Speed Limit” sign to a self-driving car).</li>
</ul>
<h2 id="5-environmental-and-social-impact">5. Environmental and Social Impact</h2>
<ul>
<li><strong>Compute Costs</strong>: Training a large Transformer can consume as much electricity as several dozen households over a year. There is a shift towards “Green AI”—prioritizing efficient architectures over pure accuracy.</li>
<li><strong>Disinformation</strong>: Generative models lower the cost of producing fake news, deepfakes, and automated phishing to zero.</li>
</ul>
<astro-island uid="Z1YfVra" prefix="r58" component-url="../../assets/Quiz.6mCOUkn7.js" component-export="default" renderer-url="../../assets/client.BkPmZNEm.js" props="{&quot;question&quot;:[0,&quot;Why can you not satisfy all definitions of mathematical fairness simultaneously?&quot;],&quot;options&quot;:[1,[[0,&quot;Because current software doesn&#39;t support more than one fairness metric.&quot;],[0,&quot;Because of &#39;The Impossibility Theorem&#39;—unless base rates are identical across groups, metrics like demographic parity and equalized odds directly contradict each other.&quot;],[0,&quot;Because fairness is only applicable to unsupervised learning.&quot;],[0,&quot;Because models always prioritize training speed over fairness.&quot;]]],&quot;answerIndex&quot;:[0,1],&quot;explanation&quot;:[0,&quot;If two groups have different base rates (e.g., one group has a 10% recidivism rate and another has 30%), a model that is equally accurate for both (calibration) will naturally result in different selection rates (failing demographic parity). There is no mathematical &#39;free lunch&#39;; we must choose which trade-offs align with our social values.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Quiz&quot;,&quot;value&quot;:true}" await-children=""><div class="quiz-container my-12 p-6 md:p-10 bg-white dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-primary/20"></div><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-3"><div class="px-3 py-1 rounded-xl bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border text-[9px] font-black uppercase tracking-[0.2em] text-light-muted dark:text-dark-muted shadow-sm">Conceptual Check</div></div></div><h3 class="text-2xl md:text-3xl font-black text-light-text dark:text-dark-text mb-10 tracking-tighter leading-[1.1]">Why can you not satisfy all definitions of mathematical fairness simultaneously?</h3><div class="flex flex-col gap-4"><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because current software doesn&#x27;t support more than one fairness metric.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because of &#x27;The Impossibility Theorem&#x27;—unless base rates are identical across groups, metrics like demographic parity and equalized odds directly contradict each other.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because fairness is only applicable to unsupervised learning.</span></button><button class="
              w-full p-5 md:p-6 rounded-2xl border-2 text-left transition-all flex items-center gap-4 group relative overflow-hidden
              border-light-border dark:border-dark-border bg-transparent hover:border-light-text dark:hover:border-dark-text hover:bg-light-bg dark:hover:bg-dark-bg
              
              
            "><div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all shrink-0 border-light-border dark:border-dark-border bg-transparent"></div><span class="text-base font-bold transition-colors text-light-muted dark:text-dark-muted">Because models always prioritize training speed over fairness.</span></button></div><div class="mt-12 flex flex-col gap-5"><button disabled="" class="
                w-full sm:w-auto px-12 py-4 rounded-xl font-black transition-all uppercase tracking-[0.2em] text-xs
                bg-light-border dark:bg-dark-border text-light-muted dark:text-dark-muted cursor-not-allowed
            ">Verify Prediction</button></div></div><!--astro:end--></astro-island>
<h2 id="implementation-summary-responsible-ml">Implementation Summary: Responsible ML</h2>
<ol>
<li><strong>Audit early and often</strong>: Check feature distributions and label base rates for different demographics before training.</li>
<li><strong>Use Model Cards</strong>: Explicitly document intended use cases, known limitations, and performance across subpopulations.</li>
<li><strong>Prioritize Interpretability</strong>: If a simple Decision Tree performs nearly as well as a Deep Neural Network in a high-stakes application, choose the Tree.</li>
<li><strong>Human-in-the-loop</strong>: Critical decisions (sentencing, medical surgery, hiring) should be augmented by AI, not automated by it without review.</li>
<li><strong>Data Minimization</strong>: Only collect and retain the data strictly necessary for the predictive task.</li>
</ol> </div> </div> </div> </div> </div> <!-- Background Decoration for Screen View --> <div class="fixed inset-0 -z-10 bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] [background-size:24px_24px] opacity-40 no-print"></div> <script>
      // Ultimate Brute Force Quiz Header Removal
      function zapQuizHeaders() {
        // 1. Target by common IDs generated by MDX
        const idsToHide = ['exercise', 'quiz', 'knowledge-check', 'practice', 'check-your-knowledge'];
        idsToHide.forEach(id => {
          document.querySelectorAll(`[id*="${id}" i]`).forEach(el => {
            el.style.setProperty('display', 'none', 'important');
          });
        });

        // 2. Target by Text Content for Headings
        const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(h => {
          const text = h.textContent.toLowerCase().trim();
          if (text === 'exercise' || text === 'quiz' || text === 'knowledge check' || text === 'practice') {
            h.style.setProperty('display', 'none', 'important');
          }
        });

        // 3. Look back from interactive elements
        const interactiveElements = document.querySelectorAll('.quiz-container, .Quiz, .code-runner, .code-exercise');
        interactiveElements.forEach(el => {
          el.style.setProperty('display', 'none', 'important');
          let prev = el.previousElementSibling;
          let count = 0;
          while (prev && count < 3) {
            const tag = prev.tagName;
            const text = prev.textContent.toLowerCase();
            if (tag.startsWith('H') || (tag === 'P' && text.length < 50)) {
               prev.style.setProperty('display', 'none', 'important');
            }
            prev = prev.previousElementSibling;
            count++;
          }
        });
      }

      // Run multiple times to handle hydration/React rendering
      zapQuizHeaders();
      window.addEventListener('DOMContentLoaded', zapQuizHeaders);
      window.addEventListener('load', zapQuizHeaders);
      setInterval(zapQuizHeaders, 500);
    </script>  </body> </html>